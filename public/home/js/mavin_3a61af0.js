define("question:widget/js/mavin-msg/mavin-msg.js",function(e,s,t){var i=e("common:widget/lib/jquery/jquery.js"),a=e("common:widget/js/util/event/event.js"),n=e("common:widget/js/ui/base/base.js");e("common:widget/js/logic/msg/msg.js");var m=n(function(){var e=this;e.msgInstance=i("#mavin-msg")}).extend({_init:function(){try{}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"question:widget/js/mavin-msg/mavin-msg.js",method:"",ln:21})}},init:function(e){try{var s=this;if("string"==i.type(e)&&0==e.replace(/[^\d]/gi,"")||0==e)return void(s.msgInstance.size()&&s.disappear());if(s.msgInstance.size())1==i.cookie.get("IK_MSG_MAVIN")&&(i("#mavin-msg").find(".dialog").size()?(s.msgInstance.removeClass("first"),s.msgInstance.html(['<div class="wrapper">','<div class="head"></div>','<div class="pop">',e,"</div>",'<div class="msg-line disappear"><a href="/ihome?type=help&fr=msg&t=',(new Date).getTime(),'" target="_blank">\u65b0\u6536\u5230<b>',e,"</b>\u6761\u6c42\u52a9 \u67e5\u770b>></a></div>","</div>"].join(""))):s.refresh(e)),s.getShowStatus()||s.show();else{if(s.msgInstance=i("<div>",{id:"mavin-msg","class":"mavin-msg"}),i.cookie.get("IK_MSG_MAVIN"))s.msgInstance.removeClass("first"),s.msgInstance.html(['<div class="wrapper">','<div class="head"></div>','<div class="pop">',e,"</div>",'<div class="msg-line disappear"><a class="jump-uhome" href="/ihome?type=help&fr=msg&t=',(new Date).getTime(),'" target="_blank">\u65b0\u6536\u5230<b>',e,"</b>\u6761\u6c42\u52a9 \u67e5\u770b>></a></div>","</div>"].join(""));else{s.msgInstance.addClass("first");var t=F.context("user").name;t.length>10&&(t=i.string(t).subByte(10,"...")),s.msgInstance.html(['<div class="wrapper">','<div class="head"></div>','<div class="dialog">','<div class="text">','<a href="/ihome?type=help&fr=msg&t=',(new Date).getTime(),'" target="_blank" class="jump-uhome">',"<p>\u4eb2\u7231\u7684",t,"\uff1a</p>","<p>\u9274\u4e8e\u60a8\u5728\u201c\u5546\u4e1a/\u7406\u8d22\u201d\u9886\u57df\u540d\u58f0\u8fdc\u64ad\uff0c\u77e5\u9053\u7f51\u53cb\u5411\u60a8\u54a8\u8be2\u4e00\u4e2a\u76f8\u5173\u95ee\u9898\u3002</p>","<p>\u6025\u76fc\u60a8\u7684\u4e13\u4e1a\u89e3\u7b54\u54e6~</p>","</a>","</div>","</div>",'<a href="#" class="close"></a>',"</div>"].join(""))}s.msgInstance.appendTo("#body"),s.show(),i.cookie.get("IK_MSG_MAVIN")||s.setDailyCookie(1)}s.eventHandler()}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message,path:"question:widget/js/mavin-msg/mavin-msg.js",method:"",ln:118})}},setDailyCookie:function(e){var s=new Date,t=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+(s.getDate()+1)+" 00:00:00",a=i.date.parse(t).getTime()-s.getTime()+288e5;i.cookie.set("IK_MSG_MAVIN",e,{path:"/",expires:a})},eventHandler:function(){var e=this;i("#mavin-msg").delegate(".close","click",function(){try{e.disappear()}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message,path:"question:widget/js/mavin-msg/mavin-msg.js",method:"",ln:135})}}).delegate(".head","mouseenter",function(){i(this).siblings(".msg-line").removeClass("disappear")}).delegate(".head","mouseleave",function(){var e=this;setTimeout(function(){i(e).siblings(".msg-line").addClass("disappear")},5e3)}).delegate(".jump-uhome","click",function(){try{a.fire("tip.del",{type:"1002"}),m.init(0)}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"question:widget/js/mavin-msg/mavin-msg.js",method:"",ln:150})}})},show:function(){var e=this;e.msgInstance.removeClass("disappear")},disappear:function(){var e=this;e.msgInstance.addClass("disappear")},getShowStatus:function(){var e=this;return e.msgInstance.hasClass("disappear")&&!1},refresh:function(e){i("#mavin-msg").find(".pop").text()!=e&&i("#mavin-msg").find(".pop").html(e)}});a.on("mavinMsg.init",function(e,s){try{var t=0;i.object.each(s.data.actList,function(e){1002==e.type&&(t=e.count)}),t>99&&(t="99+"),m.init(t)}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"question:widget/js/mavin-msg/mavin-msg.js",method:"",ln:195})}}),t.exports=i.extend(m,{init:function(e){try{return new m(e)}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message,path:"question:widget/js/mavin-msg/mavin-msg.js",method:"",ln:200})}}})});
;define("question:widget/user/mavin/mavin.js",function(e,i,n){function t(e){s(e),d.addKey({userMavin:1})}function a(e,i){return o.string.getByteLength(e)>2*i&&(e=o.string(e).subByte(2*(i-1),"..")),e}function s(){var e=[],i=0;o.each(c,function(n,t){var s="",d="";"\u673a\u6784"==t.job?(s="/business/client?businessId="+o.url.getQueryValue(t.linkHref,"id"),d="ask-to-business"):s="/new?fix="+encodeURIComponent(t.realname);var r=['<a class="img-con grid" target="_blank" data-uid="'+t.uid+'" data-index="'+i+'" href="'+t.linkHref+'">','<img src="'+t.avatarSrc+'"/>',"</a>",'<div class="grid ml-10"><p><a target="_blank" data-uid="'+t.uid+'" data-index="'+i+'" href="'+t.linkHref+'" class="mr-10" title="'+t.realname+'">'+a(t.realname,6)+'</a></p><a class="ask-to '+d+'" data-uid="'+t.uid+'" href="'+s+'" target="_blank">\u54a8\u8be2TA</a></div>','<div class="answer-num grid-r h-center"><p class="f-yahei answer-num-detail">'+t.answerNum+"</p><p>\u56de\u7b54</p></div>"].join("");e.push(r),i+=1});var n=new r({items:e,direction:"vertical",viewSize:3,duration:500});n.render("#mavin-list"),o("#mavin-list").mouseenter(function(e){e.stopPropagation(),n.pause()}).mouseleave(function(e){e.stopPropagation(),n.cycle()}),o(".mavin-list ").on("click",".item a:not(.ask-to)",function(e){try{var i=o(this),n=i.data("uid");d.send({module:"question",page:"QB",area:"wgt-user",action:"click",uid:n})}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"question:widget/user/mavin/mavin.js",method:"",ln:85})}}),o(".mavin-list").on("click",".item .ask-to",function(e){try{var i=o(this),n=i.data("uid");d.send({module:"question",page:"QB",area:"wgt-user-mavin-ask",action:"click",uid:n})}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"question:widget/user/mavin/mavin.js",method:"",ln:97})}}),o(".mavin-list ").on("click",".item .ask-to-business",function(e){try{if(e.preventDefault(),window.CLIENT_WIN,"undefined"==typeof window.CLIENT_WIN||window.CLIENT_WIN&&window.CLIENT_WIN.closed){var i=o(this).attr("href");window.CLIENT_WIN=window.open(i,"clientwin","width=1150,height=680,status=no,resizable=yes"),(null==window.CLIENT_WIN||window.CLIENT_WIN.document.location.href!=i)&&(window.CLIENT_WIN=window.open(i,"clientwin","width=1150,height=680,status=no,resizable=yes"))}else{window.CLIENT_WIN.focus();var i=o(this).attr("href");window.CLIENT_WIN.document.location.href!=i&&(window.CLIENT_WIN=window.open(i,"clientwin","width=1150,height=680,status=no,resizable=yes"))}}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"question:widget/user/mavin/mavin.js",method:"",ln:118})}})}var o=e("common:widget/js/util/tangram/tangram.js"),d=e("common:widget/js/util/log/log.js"),r=e("common:widget/js/ui/carousel/carousel.js"),c=F.context("mavinList");n.exports.init=t});