define("common:widget/js/ui/bubblePanel/bubblePanel.js",function(t,e,i){function o(t){if(!t)throw new Error("[BubblePanel Exception]: No arguments.");if(!l(t.host).length)throw new Error('[BubblePanel Exception]: Invalid argument "host".');if(this.host=l(t.host),this.extClassNames=t.classNames||"",this.zIndex=isNaN(t.zIndex)?2147483647:parseInt(t.zIndex),this.marginFromHost=isNaN(t.marginFromHost)?0:parseInt(t.marginFromHost),this.offset=l.extend({top:0,left:0},this.marginFromHost?null:t.offset),this.hideWhenBlur="boolean"==l.type(t.hideWhenBlur)?t.hideWhenBlur:!0,this.animation=/^FADE|SLIDE$/.test(t.animation)?t.animation:!1,this.hideAfterDelay=isNaN(t.hideAfterDelay)?0:parseInt(t.hideAfterDelay)+(this.animation?200:0),this.content=t.content||"",this.onShow="function"==l.type(t.onShow)?t.onShow:null,this.onHide="function"==l.type(t.onHide)?t.onHide:null,this.isVisible=!1,this.blurProtect=[this.host[0]],t.blurProtect){t.blurProtect=[].concat(t.blurProtect);var e=this;l(t.blurProtect).each(function(t,i){try{var o=l(i);o.length&&e.blurProtect.push(o[0])}catch(h){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:h.message,path:"common:widget/js/ui/bubblePanel/bubblePanel.js",method:"",ln:128})}})}var i=t.pos&&t.pos.match(/^auto|(?:(top|right|bottom|left)(?:[- |]?(top|right|bottom|left|center|auto))?)$/i);this.pos=i?(i[1]||i[0]).toLowerCase():"auto",this.align="auto"==this.pos?"auto":i&&i[2]&&i[2]!=i[1]?i[2].toLowerCase():"center"}function h(t){var e=l.extend("http://www.w3.org/2000/svg"==this.host[0].namespaceURI?this.host[0].getBBox():{width:this.host.outerWidth(),height:this.host.outerHeight()},this.host.offset()),i=l(document),o=l(window);l.extend(e,{viewTop:e.top-i.scrollTop(),viewRight:o.width()-(e.left-i.scrollLeft()+e.width),viewBottom:o.height()-(e.top-i.scrollTop()+e.height),viewLeft:e.left-i.scrollLeft()});var h={width:this.node.outerWidth(),height:this.node.outerHeight()},n=l([o.width()*e.viewTop,o.height()*e.viewRight,o.width()*e.viewBottom,o.height()*e.viewLeft]);~this.pos.indexOf("auto")&&(this.pos="auto-"+["top","right","bottom","left"][n.index(Math.max.apply(null,n))]);var s={},a="SLIDE"==this.animation;switch(this.pos.replace(/auto-/,"")){case"top":this.aniSlide={direction:"top",len:a?-20:0},s.top=e.top-h.height-this.marginFromHost+(t?0:this.aniSlide.len);break;case"right":this.aniSlide={direction:"left",len:a?20:0},s.left=e.left+e.width+this.marginFromHost+(t?0:this.aniSlide.len);break;case"left":this.aniSlide={direction:"left",len:a?-20:0},s.left=e.left-h.width-this.marginFromHost+(t?0:this.aniSlide.len);break;default:this.aniSlide={direction:"top",len:a?20:0},s.top=e.top+e.height+this.marginFromHost+(t?0:this.aniSlide.len)}switch(~this.align.indexOf("auto")&&(this.align="auto-",this.align+=/top|bottom/.test(this.pos)?((e.width-h.width)/2+e.viewLeft)*((e.width-h.width)/2+e.viewRight)>0?"center":e.viewLeft>e.viewRight?"right":"left":((e.height-h.height)/2+e.viewTop)*((e.height-h.height)/2+e.viewBottom)>0?"center":e.viewTop>e.viewBottom?"bottom":"top"),this.align.replace(/auto-/,"")){case"top":s.top=e.top;break;case"right":s.left=e.left+e.width-h.width;break;case"bottom":s.top=e.top+e.height-h.height;break;case"left":s.left=e.left;break;default:isNaN(s.left)?s.left=e.left+(e.width-h.width)/2:s.top=e.top+(e.height-h.height)/2}this.node.css({top:s.top+this.offset.top,left:s.left+this.offset.left})}function n(t,e){t&&"function"==l.type(t)&&t.call(null,e)}function s(t){o.call(this,t),this.node=l('<div class="bubblePanel"></div>').html(this.content).addClass(this.extClassNames).css({zIndex:this.zIndex}).appendTo(l("body")).hide(),this.blurProtect.push(this.node[0]);var e=this;this.hideWhenBlur&&l("body").on("click.bubblePanel",function(t){try{var i=!1;l.each(e.blurProtect,function(e,o){try{if(t.target==o||l.contains(o,t.target))return i=!0,!1}catch(h){}}),!i&&e.hide()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/ui/bubblePanel/bubblePanel.js",method:"",ln:272})}}),l(window).on("resize.bubblePanel",function(){e.resetPos()}).on("scroll.bubblePanel",function(){e.resetPos()})}var l=t("common:widget/lib/jquery/jquery.js");s.prototype={constructor:s,setHost:function(t){return l(t).length?(this.blurProtect.splice(l.inArray(this.host[0],this.blurProtect),1),this.host=l(t),this.blurProtect.push(this.host[0]),this):void 0},setContent:function(t){return this.content=t,this.node.html(this.content),this},resetPos:function(){return this.isVisible&&h.call(this,!0),this},getNode:function(){return this.node},show:function(t){if(!this.isVisible){var e=this;if(this.isVisible=!0,this.node.show(),h.call(e),e.animation){var i={opacity:1};i[e.aniSlide.direction]="-="+e.aniSlide.len,e.node.css("opacity",0).animate(i,{duration:200,queue:!1,complete:function(){e.node.show(),n(t),n(e.onShow)}})}else n(t),n(e.onShow);return clearTimeout(e.hideDelayTimer),e.hideAfterDelay&&(e.hideDelayTimer=setTimeout(function(){e.hide()},e.hideAfterDelay)),this}h.call(this,!0)},hide:function(t){if(this.isVisible){var e=this;if(this.isVisible=!1,this.animation){var i={opacity:0};i[this.aniSlide.direction]="+="+this.aniSlide.len,this.node.animate(i,{duration:200,queue:!1,complete:function(){e.node.hide(),n(t),n(e.onHide)}})}else this.node.hide(),n(t),n(this.onHide);return this}}},i.exports=s});