define("common:widget/js/logic/editor/editor.js",function(e,t,n){!function(){function t(e,t,n){var i;return t=t.toLowerCase(),(i=e.__allListeners||n&&(e.__allListeners={}))&&(i[t]||n&&(i[t]=[]))}function o(e,t,n,i,r,a){var s,l=i&&e[t];for(!l&&(l=e[n]);!l&&(s=(s||e).parentNode);){if("BODY"==s.tagName||a&&!a(s))return null;l=s[n]}return l&&r&&!r(l)?o(l,t,n,!1,r):l}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var r=window.baidu||{};window.baidu=r,window.UE=r.editor={},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE.version="1.2.6.0";var a=UE.dom={},s=e("common:widget/js/util/tangram/tangram.js"),l=(e("common:widget/js/util/store/store.js"),e("common:widget/js/logic/editor/config/config.js")),d=e("common:widget/js/logic/editor/lang/lang.js"),c=e("common:widget/js/ui/dialog/dialog.js"),u=e("common:widget/js/util/event/event.js"),f=(e("common:widget/js/ui/tip/tip.js"),e("common:widget/js/util/https/https.js")),m=e("common:widget/js/util/log/log.js"),h=e("common:widget/js/util/webuploader/webuploader.js");e("common:widget/js/logic/editor/fileUploader/fileUploader.js"),r.swf=s.swf,window.UEDITOR_CONFIG=l,UE.I18N=d;var p=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:!!window.ActiveXObject,opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.opera;var i=0;if(n.ie&&(i=parseFloat(e.match(/msie (\d+)/)[1]),n.ie9Compat=9==document.documentMode,n.ie8=!!document.documentMode,n.ie8Compat=8==document.documentMode,n.ie7Compat=7==i&&!document.documentMode||7==document.documentMode,n.ie6Compat=7>i||n.quirks),n.gecko){var o=e.match(/rv:([\d\.]+)/);o&&(o=o[1].split("."),i=1e4*o[0]+100*(o[1]||0)+1*(o[2]||0))}return/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(i=parseFloat(t.version())),n.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=!n.mobile&&(n.ie&&i>=6||n.gecko&&i>=10801||n.opera&&i>=9.5||n.air&&i>=1||n.webkit&&i>=522||!1),n}(),g=p.ie,v=(p.webkit,p.gecko,p.opera,UE.utils={each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var i=0,o=e.length;o>i;i++)if(t.call(n,e[i],i,e)===!1)return!1}else for(var r in e)if(e.hasOwnProperty(r)&&t.call(n,e[r],r,e)===!1)return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var i in t)n&&e.hasOwnProperty(i)||(e[i]=t[i]);return e},extend2:function(e){for(var t=arguments,n=1;n<t.length;n++){var i=t[n];for(var o in i)e.hasOwnProperty(o)||(e[o]=i[o])}return e},inherits:function(e,t){var n=e.prototype,i=v.makeInstance(t.prototype);return v.extend(i,n,!0),e.prototype=i,i.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var i;return function(){n&&clearTimeout(i),i=setTimeout(e,t)}},indexOf:function(e,t,n){var i=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,o){return o>=n&&e===t?(i=o,!1):void 0}),i},removeItem:function(e,t){for(var n=0,i=e.length;i>n;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=v.isArray(e)?e:e.split(",");for(var t,n=0,i={};t=e[n++];)i[t.toUpperCase()]=i[t]=1;return i},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#92|#47);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":void 0!=e.cssFloat?"cssFloat":void 0!=e.styleFloat?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function e(e,n){try{for(var i,o=0;i=t[o++];)if(i.doc===e&&i.url==(n.src||n.href))return i}catch(r){return null}}var t=[];return function(n,i,o){var r=e(n,i);if(r)return void(r.ready?o&&o():r.funs.push(o));if(t.push({doc:n,url:i.src||i.href,funs:[o]}),!n.body){var a=[];for(var s in i)"tag"!=s&&a.push(s+'="'+i[s]+'"');return void n.write("<"+i.tag+" "+a.join(" ")+" ></"+i.tag+">")}if(!i.id||!n.getElementById(i.id)){var l=n.createElement(i.tag);delete i.tag;for(var s in i)l.setAttribute(s,i[s]);l.onload=l.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(r=e(n,i),r.funs.length>0){r.ready=1;for(var t;t=r.funs.pop();)t()}l.onload=l.onreadystatechange=null}},l.onerror=function(){throw Error("The load "+(i.href||i.src)+" fails,check the url settings of file ueditor.config.js ")},n.getElementsByTagName("head")[0].appendChild(l)}}}(),isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var i,o=0;i=n[o++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=1==i.length?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(e){function t(e,t){if(!e)return"";var n=e.top,i=e.bottom,o=e.left,r=e.right,a="";if(n&&o&&i&&r)a+=";"+t+":"+(n==i&&i==o&&o==r?n:n==i&&o==r?n+" "+o:o==r?n+" "+o+" "+i:n+" "+r+" "+i+" "+o)+";";else for(var s in e)a+=";"+t+"-"+s+":"+e[s]+";";return a}var n,i;return e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,t,o,r){if(1==r.split(" ").length)switch(t){case"padding":return!n&&(n={}),n[o]=r,"";case"margin":return!i&&(i={}),i[o]=r,"";case"border":return"initial"==r?"":e}return e}),e+=t(n,"padding")+t(i,"margin"),e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var n;t=t||{};for(var i in e)e.hasOwnProperty(i)&&(n=e[i],"object"==typeof n?(t[i]=v.isArray(n)?[]:{},v.clone(e[i],t[i])):t[i]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;switch(e.replace(/([\d.]+)(\w+)/,function(n,i,o){e=i,t=o}),t){case"cm":e=25*parseFloat(e);break;case"pt":e=Math.round(96*parseFloat(e)/72)}return e+(e?"px":"")},domReady:function(){function e(e){e.isReady=!0;for(var n;n=t.pop();n());}var t=[];return function(n,i){i=i||window;var o=i.document;n&&t.push(n),"complete"===o.readyState?e(o):(o.isReady&&e(o),p.ie?(!function(){if(!o.isReady){try{o.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e(o)}}(),i.attachEvent("onload",function(){e(o)})):(o.addEventListener("DOMContentLoaded",function(){o.removeEventListener("DOMContentLoaded",arguments.callee,!1),e(o)},!1),i.addEventListener("load",function(){e(o)},!1)))}}(),cssRule:p.ie?function(e,t,n){var i,o;n=n||document,i=n.indexList?n.indexList:n.indexList={};var r;if(i[e])r=n.styleSheets[i[e]];else{if(void 0===t)return"";r=n.createStyleSheet("",o=n.styleSheets.length),i[e]=o}return void 0===t?r.cssText:void(r.cssText=t||"")}:function(e,t,n){n=n||document;var i,o=n.getElementsByTagName("head")[0];if(!(i=n.getElementById(e))){if(void 0===t)return"";i=n.createElement("style"),i.id=e,o.appendChild(i)}return void 0===t?i.innerHTML:void(""!==t?i.innerHTML=t:o.removeChild(i))},sort:function(e,t){t=t||function(e,t){return e.localeCompare(t)};for(var n=0,i=e.length;i>n;n++)for(var o=n,r=e.length;r>o;o++)if(t(e[n],e[o])>0){var a=e[n];e[n]=e[o],e[o]=a}return e}});v.each(["String","Function","Array","Number","RegExp","Object"],function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});var y=UE.EventBase=function(){};y.prototype={addListener:function(e,n){e=v.trim(e).split(" ");for(var i,o=0;i=e[o++];)t(this,i,!0).push(n)},removeListener:function(e,n){e=v.trim(e).split(" ");for(var i,o=0;i=e[o++];)v.removeItem(t(this,i)||[],n)},fireEvent:function(){var e=arguments[0];e=v.trim(e).split(" ");for(var n,i=0;n=e[i++];){var o,r,a,s=t(this,n);if(s)for(a=s.length;a--;)if(s[a]){if(r=s[a].apply(this,arguments),r===!0)return r;void 0!==r&&(o=r)}(r=this["on"+n.toLowerCase()])&&(o=r.apply(this,arguments))}return o}};var b=a.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}var t=v.extend2,n=e({isindex:1,fieldset:1}),i=e({input:1,button:1,select:1,textarea:1,label:1}),o=t(e({a:1}),i),r=t({iframe:1},o),a=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),s=e({ins:1,del:1,script:1,style:1}),l=t(e({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),s),d=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),l),c=t(e({p:1}),d),u=t(e({iframe:1}),d,i),f=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),m=t(e({a:0}),u),h=e({tr:1}),p=e({"#":1}),g=t(e({param:1}),f),y=t(e({form:1}),n,r,a,c),b=e({li:1,ol:1,ul:1}),C=e({style:1,script:1}),N=e({base:1,link:1,meta:1,title:1}),w=t(N,C),E=e({head:1,body:1}),x=e({html:1}),S=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),T=e({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return e({$nonBodyContent:t(x,E,N),$block:S,$inline:m,$inlineWithA:t(e({a:1}),m),$body:t(e({script:1,style:1}),S),$cdata:e({script:1,style:1}),$empty:T,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:E,head:w,style:p,script:p,body:y,base:{},link:{},meta:{},title:p,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:y,td:y,br:{},th:y,center:y,kbd:m,button:t(c,a),basefont:{},h5:m,h4:m,samp:m,h6:m,ol:b,h1:m,h3:m,option:p,h2:m,form:t(n,r,a,c),select:e({optgroup:1,option:1}),font:m,ins:m,menu:b,abbr:m,label:m,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:m,tfoot:h,cite:m,li:y,input:{},iframe:y,strong:m,textarea:p,noframes:y,big:m,small:m,span:e({"#":1,br:1}),hr:m,dt:m,sub:m,optgroup:e({option:1}),param:{},bdo:m,"var":m,div:y,object:g,sup:m,dd:y,strike:m,area:{},dir:b,map:t(e({area:1,form:1,p:1}),n,s,a),applet:g,dl:e({dt:1,dd:1}),del:m,isindex:{},fieldset:t(e({legend:1}),f),thead:h,ul:b,acronym:m,b:m,a:t(e({a:1}),u),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),y),caption:m,i:m,u:m,tbody:h,s:m,address:t(r,c),tt:m,legend:m,q:m,pre:t(l,o),p:t(e({a:1}),m),em:m,dfn:m})}(),C=g&&p.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},N=v.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),w=a.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:g&&"6"==p.version?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t)return 0;var n,i=[e],o=[t];for(n=e;n=n.parentNode;){if(n===t)return 10;i.push(n)}for(n=t;n=n.parentNode;){if(n===e)return 20;o.push(n)}if(i.reverse(),o.reverse(),i[0]!==o[0])return 1;for(var r=-1;r++,i[r]===o[r];);for(e=i[r],t=o[r];e=e.nextSibling;)if(e===t)return 4;return 2},getNodeIndex:function(e,t){for(var n=e,i=0;n=n.previousSibling;)t&&3==n.nodeType?n.nodeType!=n.nextSibling.nodeType&&i++:i++;return i},inDoc:function(e,t){return 10==w.getPosition(e,t)},findParent:function(e,t,n){if(e&&!w.isBody(e))for(e=n?e:e.parentNode;e;){if(!t||t(e)||w.isBody(e))return t&&!t(e)&&w.isBody(e)?null:e;e=e.parentNode}return null},findParentByTagName:function(e,t,n,i){return t=v.listToMap(v.isArray(t)?t:[t]),w.findParent(e,function(e){return t[e.tagName]&&!(i&&i(e))},n)},findParents:function(e,t,n,i){for(var o=t&&(n&&n(e)||!n)?[e]:[];e=w.findParent(e,n);)o.push(e);return i?o:o.reverse()},insertAfter:function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},remove:function(e,t){var n,i=e.parentNode;if(i){if(t&&e.hasChildNodes())for(;n=e.firstChild;)i.insertBefore(n,e);i.removeChild(e)}return e},getNextDomNode:function(e,t,n,i){return o(e,"firstChild","nextSibling",t,n,i)},isBookmarkNode:function(e){return 1==e.nodeType&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;for(var n=[e],i=[t],o=e,r=-1;o=o.parentNode;){if(o===t)return o;n.push(o)}for(o=t;o=o.parentNode;){if(o===e)return o;i.push(o)}for(n.reverse(),i.reverse();r++,n[r]===i[r];);return 0==r?null:n[r-1]},clearEmptySibling:function(e,t,n){function i(e,t){for(var n;e&&!w.isBookmarkNode(e)&&(w.isEmptyInlineElement(e)||!new RegExp("[^	\n\r"+w.fillChar+"]").test(e.nodeValue));)n=e[t],w.remove(e),e=n}!t&&i(e.nextSibling,"nextSibling"),!n&&i(e.previousSibling,"previousSibling")},split:function(e,t){var n=e.ownerDocument;if(p.ie&&t==e.nodeValue.length){var i=n.createTextNode("");return w.insertAfter(e,i)}var o=e.splitText(t);if(p.ie8){var r=n.createTextNode("");w.insertAfter(o,r),w.remove(r)}return o},isWhitespace:function(e){return!new RegExp("[^ 	\n\r"+w.fillChar+"]").test(e.nodeValue)},getXY:function(e){for(var t=0,n=0;e.offsetParent;)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},on:function(e,t,n){var i=v.isArray(t)?t:[t],o=i.length;if(o)for(;o--;)if(t=i[o],e.addEventListener)e.addEventListener(t,n,!1);else{n._d||(n._d={els:[]});var r=t+n.toString(),a=v.indexOf(n._d.els,e);n._d[r]&&-1!=a||(-1==a&&n._d.els.push(e),n._d[r]||(n._d[r]=function(e){return n.call(e.srcElement,e||window.event)}),e.attachEvent("on"+t,n._d[r]))}e=null},un:function(e,t,n){var i=v.isArray(t)?t:[t],o=i.length;if(o)for(;o--;)if(t=i[o],e.removeEventListener)e.removeEventListener(t,n,!1);else{var r=t+n.toString();try{e.detachEvent("on"+t,n._d?n._d[r]:n)}catch(a){}if(n._d&&n._d[r]){var s=v.indexOf(n._d.els,e);-1!=s&&n._d.els.splice(s,1),0==n._d.els.length&&delete n._d[r]}}},isSameElement:function(e,t){if(e.tagName!=t.tagName)return!1;var n=e.attributes,i=t.attributes;if(!g&&n.length!=i.length)return!1;for(var o,r,a=0,s=0,l=0;o=n[l++];){if("style"==o.nodeName){if(o.specified&&a++,w.isSameStyle(e,t))continue;return!1}if(g){if(!o.specified)continue;a++,r=i.getNamedItem(o.nodeName)}else r=t.attributes[o.nodeName];if(!r.specified||o.nodeValue!=r.nodeValue)return!1}if(g){for(l=0;r=i[l++];)r.specified&&s++;if(a!=s)return!1}return!0},isSameStyle:function(e,t){var n=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),i=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(p.opera){if(n=e.style,i=t.style,n.length!=i.length)return!1;for(var o in n)if(!/^(\d+|csstext)$/i.test(o)&&n[o]!=i[o])return!1;return!0}if(!n||!i)return n==i;if(n=n.split(";"),i=i.split(";"),n.length!=i.length)return!1;for(var r,a=0;r=n[a++];)if(-1==v.indexOf(i,r))return!1;return!0},isBlockElm:function(e){return 1==e.nodeType&&(b.$block[e.tagName]||N[w.getComputedStyle(e,"display")])&&!b.$nonChild[e.tagName]},isBody:function(e){return e&&1==e.nodeType&&"body"==e.tagName.toLowerCase()},breakParent:function(e,t){var n,i,o,r=e,a=e;do{for(r=r.parentNode,i?(n=r.cloneNode(!1),n.appendChild(i),i=n,n=r.cloneNode(!1),n.appendChild(o),o=n):(i=r.cloneNode(!1),o=i.cloneNode(!1));n=a.previousSibling;)i.insertBefore(n,i.firstChild);for(;n=a.nextSibling;)o.appendChild(n);a=r}while(t!==r);return n=t.parentNode,n.insertBefore(i,t),n.insertBefore(o,t),n.insertBefore(e,o),w.remove(t),e},isEmptyInlineElement:function(e){if(1!=e.nodeType||!b.$removeEmpty[e.tagName])return 0;for(e=e.firstChild;e;){if(w.isBookmarkNode(e))return 0;if(1==e.nodeType&&!w.isEmptyInlineElement(e)||3==e.nodeType&&!w.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(e){function t(t){for(var n;(n=e[t])&&3==n.nodeType&&w.isWhitespace(n);)e.removeChild(n)}t("firstChild"),t("lastChild")},mergeChild:function(e,t,n){for(var i,o=w.getElementsByTagName(e,e.tagName.toLowerCase()),r=0;i=o[r++];)if(i.parentNode&&!w.isBookmarkNode(i))if("span"!=i.tagName.toLowerCase())w.isSameElement(e,i)&&w.remove(i,!0);else{if(e===i.parentNode&&(w.trimWhiteTextNode(e),1==e.childNodes.length)){e.style.cssText=i.style.cssText+";"+e.style.cssText,w.remove(i,!0);continue}if(i.style.cssText=e.style.cssText+";"+i.style.cssText,n){var a=n.style;if(a){a=a.split(";");for(var s,l=0;s=a[l++];)i.style[v.cssStyleToDomStyle(s.split(":")[0])]=s.split(":")[1]}}w.isSameStyle(i,e)&&w.remove(i,!0)}},getElementsByTagName:function(e,t,n){if(n&&v.isString(n)){var i=n;n=function(e){return w.hasClass(e,i)}}t=v.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var o,r=[],a=0;o=t[a++];)for(var s,l=e.getElementsByTagName(o),d=0;s=l[d++];)(!n||n(s))&&r.push(s);return r},mergeToParent:function(e){for(var t=e.parentNode;t&&b.$removeEmpty[t.tagName];){if(t.tagName==e.tagName||"A"==t.tagName){if(w.trimWhiteTextNode(t),"SPAN"==t.tagName&&!w.isSameStyle(t,e)||"A"==t.tagName&&"SPAN"==e.tagName){if(t.childNodes.length>1||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText,t=t.parentNode;continue}t.style.cssText+=";"+e.style.cssText,"A"==t.tagName&&(t.style.textDecoration="underline")}if("A"!=t.tagName){t===e.parentNode&&w.remove(e,!0);break}}t=t.parentNode}},mergeSibling:function(e,t,n){function i(e,t,n){var i;if((i=n[e])&&!w.isBookmarkNode(i)&&1==i.nodeType&&w.isSameElement(n,i)){for(;i.firstChild;)"firstChild"==t?n.insertBefore(i.lastChild,n.firstChild):n.appendChild(i.firstChild);w.remove(i)}}!t&&i("previousSibling","firstChild",e),!n&&i("nextSibling","lastChild",e)},unSelectable:g||p.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){try{return!1}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:1886})}},e.unselectable="on",e.setAttribute("unselectable","on");for(var t,n=0;t=e.all[n++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=v.isArray(t)?t:v.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0;n=t[i++];){switch(n=C[n]||n){case"className":e[n]="";break;case"style":e.style.cssText="",!p.ie&&e.removeAttributeNode(e.getAttributeNode("style"))}e.removeAttribute(n)}},createElement:function(e,t,n){return w.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];switch(n){case"class":e.className=i;break;case"style":e.style.cssText=e.style.cssText+";"+i;break;case"innerHTML":e[n]=i;break;case"value":e.value=i;break;default:e.setAttribute(C[n]||n,i)}}return e},getComputedStyle:function(e,t){var n="width height top left";if(n.indexOf(t)>-1)return e["offset"+t.replace(/^\w/,function(e){return e.toUpperCase()})]+"px";if(3==e.nodeType&&(e=e.parentNode),p.ie&&p.version<9&&"font-size"==t&&!e.style.fontSize&&!b.$empty[e.tagName]&&!b.$nonChild[e.tagName]){var i=e.ownerDocument.createElement("span");i.style.cssText="padding:0;border:0;font-family:simsun;",i.innerHTML=".",e.appendChild(i);var o=i.offsetHeight;return e.removeChild(i),i=null,o+"px"}try{var r=w.getStyle(e,t)||(window.getComputedStyle?w.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[v.cssStyleToDomStyle(t)])}catch(a){return""}return v.transUnitToPx(v.fixColor(t,r))},removeClasses:function(e,t){t=v.isArray(t)?t:v.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)o=o.replace(new RegExp("\\b"+n+"\\b"),"");o=v.trim(o).replace(/[ ]{2,}/g," "),o?e.className=o:w.removeAttributes(e,["class"])},addClass:function(e,t){if(e){t=v.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)new RegExp("\\b"+n+"\\b").test(o)||(e.className+=" "+n)}},hasClass:function(e,t){if(v.isRegExp(t))return t.test(e.className);t=v.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)if(!new RegExp("\\b"+n+"\\b","i").test(o))return!1;return i-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){p.ie?e.style.cssText=e.style.cssText.replace(new RegExp(t+"[^:]*:[^;]+;?","ig"),""):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(v.cssStyleToDomStyle(t)),e.style.cssText||w.removeAttributes(e,["style"])},getStyle:function(e,t){var n=e.style[v.cssStyleToDomStyle(t)];return v.fixColor(t,n)},setStyle:function(e,t,n){e.style[v.cssStyleToDomStyle(t)]=n,v.trim(e.style.cssText)||this.removeAttributes(e,"style")},setStyles:function(e,t){for(var n in t)t.hasOwnProperty(n)&&w.setStyle(e,n,t[n])},removeDirtyAttr:function(e){for(var t,n=0,i=e.getElementsByTagName("*");t=i[n++];)t.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,i=e.firstChild;for(t=t||function(){return 1};i;)t(i)&&n++,i=i.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||0==w.getChildCount(e,function(e){return!w.isBr(e)&&!w.isBookmarkNode(e)&&!w.isWhitespace(e)})},clearSelectedArr:function(e){for(var t;t=e.pop();)w.removeAttributes(t,["class"])},scrollToView:function(e,t,n){var i=function(){var e=t.document,n="CSS1Compat"==e.compatMode;return{width:(n?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(n?e.documentElement.clientHeight:e.body.clientHeight)||0}},o=function(e){if("pageXOffset"in e)return{x:e.pageXOffset||0,y:e.pageYOffset||0};var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},r=i().height,a=-1*r+n;a+=e.offsetHeight||0;var s=w.getXY(e);a+=s.y;var l=o(t).y;(a>l||l-r>a)&&t.scrollTo(0,a+(0>a?-20:20))},isBr:function(e){return 1==e.nodeType&&"BR"==e.tagName},isFillChar:function(e,t){return 3==e.nodeType&&!e.nodeValue.replace(new RegExp((t?"^":"")+w.fillChar),"").length},isStartInblock:function(e){var t,n=e.cloneRange(),i=0,o=n.startContainer;if(1==o.nodeType&&o.childNodes[n.startOffset]){o=o.childNodes[n.startOffset];for(var r=o.previousSibling;r&&w.isFillChar(r);)o=r,r=r.previousSibling}for(this.isFillChar(o,!0)&&1==n.startOffset&&(n.setStartBefore(o),o=n.startContainer);o&&w.isFillChar(o);)t=o,o=o.previousSibling;for(t&&(n.setStartBefore(t),o=n.startContainer),1==o.nodeType&&w.isEmptyNode(o)&&1==n.startOffset&&n.setStart(o,0).collapse(!0);!n.startOffset;){if(o=n.startContainer,w.isBlockElm(o)||w.isBody(o)){i=1;break}var a,r=n.startContainer.previousSibling;if(r){for(;r&&w.isFillChar(r);)a=r,r=r.previousSibling;n.setStartBefore(a?a:n.startContainer)}else n.setStartBefore(n.startContainer)}return i&&!w.isBody(n.startContainer)?1:0},isEmptyBlock:function(e,t){if(t=t||new RegExp("[ 	\r\n"+w.fillChar+"]","g"),e[p.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var n in b.$isNotEmpty)if(e.getElementsByTagName(n).length)return 0;return 1},setViewportOffset:function(e,t){var n=0|parseInt(e.style.left),i=0|parseInt(e.style.top),o=e.getBoundingClientRect(),r=t.left-o.left,a=t.top-o.top;r&&(e.style.left=n+r+"px"),a&&(e.style.top=i+a+"px")},fillNode:function(e,t){var n=p.ie?e.createTextNode(w.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(n)},moveChild:function(e,t,n){for(;e.firstChild;)n&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return p.ie?/^<\w+\s*?>/.test(e.outerHTML):0==e.attributes.length},isCustomeNode:function(e){return 1==e.nodeType&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return 1==e.nodeType&&new RegExp(e.tagName,"i").test(t)},filterNodeList:function(e,t,n){var i=[];if(!v.isFunction(t)){var o=t;t=function(e){return-1!=v.indexOf(v.isArray(o)?o:o.split(" "),e.tagName.toLowerCase())}}return v.each(e,function(e){t(e)&&i.push(e)}),0==i.length?null:1!=i.length&&n?i:i[0]},isInNodeEndBoundary:function(e,t){var n=e.startContainer;if(3==n.nodeType&&e.startOffset!=n.nodeValue.length)return 0;if(1==n.nodeType&&e.startOffset!=n.childNodes.length)return 0;for(;n!==t;){if(n.nextSibling)return 0;n=n.parentNode}return 1},isBoundaryNode:function(e,t){for(var n;!w.isBody(e);)if(n=e,e=e.parentNode,n!==e[t])return!1;return!0}},E=new RegExp(w.fillChar,"g");!function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function t(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function n(t,n,i,o){return 1==n.nodeType&&(b.$empty[n.tagName]||b.$nonChild[n.tagName])&&(i=w.getNodeIndex(n)+(t?0:1),n=n.parentNode),t?(o.startContainer=n,o.startOffset=i,o.endContainer||o.collapse(!0)):(o.endContainer=n,o.endOffset=i,o.startContainer||o.collapse(!1)),e(o),o}function i(e,t){var n,i,o=e.startContainer,r=e.endContainer,a=e.startOffset,s=e.endOffset,l=e.document,d=l.createDocumentFragment();if(1==o.nodeType&&(o=o.childNodes[a]||(n=o.appendChild(l.createTextNode("")))),1==r.nodeType&&(r=r.childNodes[s]||(i=r.appendChild(l.createTextNode("")))),o===r&&3==o.nodeType)return d.appendChild(l.createTextNode(o.substringData(a,s-a))),t&&(o.deleteData(a,s-a),e.collapse(!0)),d;for(var c,u,f=d,m=w.findParents(o,!0),h=w.findParents(r,!0),p=0;m[p]==h[p];)p++;for(var g,v=p;g=m[v];v++){for(c=g.nextSibling,g==o?n||(3==e.startContainer.nodeType?(f.appendChild(l.createTextNode(o.nodeValue.slice(a))),t&&o.deleteData(a,o.nodeValue.length-a)):f.appendChild(t?o:o.cloneNode(!0))):(u=g.cloneNode(!1),f.appendChild(u));c&&c!==r&&c!==h[v];)g=c.nextSibling,f.appendChild(t?c:c.cloneNode(!0)),c=g;f=u}f=d,m[p]||(f.appendChild(m[p-1].cloneNode(!1)),f=f.firstChild);for(var y,v=p;y=h[v];v++){if(c=y.previousSibling,y==r?i||3!=e.endContainer.nodeType||(f.appendChild(l.createTextNode(r.substringData(0,s))),t&&r.deleteData(0,s)):(u=y.cloneNode(!1),f.appendChild(u)),v!=p||!m[p])for(;c&&c!==o;)y=c.previousSibling,f.insertBefore(t?c:c.cloneNode(!0),f.firstChild),c=y;f=u}return t&&e.setStartBefore(h[p]?m[p]?h[p]:m[p-1]:h[p-1]).collapse(!0),n&&w.remove(n),i&&w.remove(i),d}function o(e,t){try{if(s&&w.inDoc(s,e))if(s.nodeValue.replace(E,"").length)s.nodeValue=s.nodeValue.replace(E,"");else{var n=s.parentNode;for(w.remove(s);n&&w.isEmptyInlineElement(n)&&(p.safari?!(w.getPosition(n,t)&w.POSITION_CONTAINS):!n.contains(t));)s=n.parentNode,w.remove(n),n=s}}catch(i){}}function r(e,t){var n;for(e=e[t];e&&w.isFillChar(e);)n=e[t],w.remove(e),e=n}var s,l=0,d=w.fillChar,c=a.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=e,t.collapsed=!0};c.prototype={cloneContents:function(){return this.collapsed?null:i(this,0)},deleteContents:function(){var e;return this.collapsed||i(this,1),p.webkit&&(e=this.startContainer,3!=e.nodeType||e.nodeValue.length||(this.setStartBefore(e).collapse(!0),w.remove(e))),this},extractContents:function(){return this.collapsed?null:i(this,2)},setStart:function(e,t){return n(!0,e,t,this)},setEnd:function(e,t){return n(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,w.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,w.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,w.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,w.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return new c(e.document).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){function t(e){return 1==e.nodeType&&!w.isBookmarkNode(e)&&!b.$empty[e.tagName]&&!b.$nonChild[e.tagName]}for(var n,i=this,o=i.collapsed;1==i.startContainer.nodeType&&(n=i.startContainer.childNodes[i.startOffset])&&t(n);)i.setStart(n,0);if(o)return i.collapse(!0);if(!e)for(;1==i.endContainer.nodeType&&i.endOffset>0&&(n=i.endContainer.childNodes[i.endOffset-1])&&t(n);)i.setEnd(n,n.childNodes.length);return i},getCommonAncestor:function(e,n){var i=this,o=i.startContainer,r=i.endContainer;return o===r?e&&t(this)&&(o=o.childNodes[i.startOffset],1==o.nodeType)?o:n&&3==o.nodeType?o.parentNode:o:w.getCommonAncestor(o,r)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,i=this.collapsed,o=this.endContainer;if(3==t.nodeType){if(0==n)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var r=w.split(t,n);t===o?this.setEnd(r,this.endOffset-n):t.parentNode===o&&(this.endOffset+=1),this.setStartBefore(r)}if(i)return this.collapse(!0)}return e||(n=this.endOffset,o=this.endContainer,3==o.nodeType&&(0==n?this.setEndBefore(o):(n<o.nodeValue.length&&w.split(o,n),this.setEndAfter(o)))),this},txtToElmBoundary:function(){function e(e,t){var n=e[t+"Container"],i=e[t+"Offset"];3==n.nodeType&&(i?i>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return this.collapsed||(e(this,"start"),e(this,"end")),this},insertNode:function(e){var t=e,n=1;11==e.nodeType&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var i=this.startContainer,o=this.startOffset,r=i.childNodes[o];return r?i.insertBefore(e,r):i.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var n,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("\u200d")),i.id="_baidu_bookmark_start_"+(t?"":l++),this.collapsed||(n=i.cloneNode(!0),n.id="_baidu_bookmark_end_"+(t?"":l++)),this.insertNode(i),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(i),{start:e?i.id:i,end:n?e?n.id:n:null,id:e}
},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),w.remove(t),n?(this.setEndBefore(n),w.remove(n)):this.collapse(!0),this},enlarge:function(e,t){var n,i,o=w.isBody,r=this.document.createTextNode("");if(e){for(i=this.startContainer,1==i.nodeType?i.childNodes[this.startOffset]?n=i=i.childNodes[this.startOffset]:(i.appendChild(r),n=i=r):n=i;;){if(w.isBlockElm(i)){for(i=n;(n=i.previousSibling)&&!w.isBlockElm(n);)i=n;this.setStartBefore(i);break}n=i,i=i.parentNode}for(i=this.endContainer,1==i.nodeType?((n=i.childNodes[this.endOffset])?i.insertBefore(r,n):i.appendChild(r),n=i=r):n=i;;){if(w.isBlockElm(i)){for(i=n;(n=i.nextSibling)&&!w.isBlockElm(n);)i=n;this.setEndAfter(i);break}n=i,i=i.parentNode}r.parentNode===this.endContainer&&this.endOffset--,w.remove(r)}if(!this.collapsed){for(;!(0!=this.startOffset||t&&t(this.startContainer)||o(this.startContainer));)this.setStartBefore(this.startContainer);for(;!(this.endOffset!=(1==this.endContainer.nodeType?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)||t&&t(this.endContainer)||o(this.endContainer));)this.setEndAfter(this.endContainer)}return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!w.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!w.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return 1==e.nodeType&&w.isBlockElm(e)}).adjustmentBoundary();for(var i,o,r=this.createBookmark(),a=r.end,s=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!w.isWhitespace(e)},l=w.getNextDomNode(r.start,!1,s),d=this.cloneRange();l&&w.getPosition(l,a)&w.POSITION_PRECEDING;)if(3==l.nodeType||b[e][l.tagName]){for(d.setStartBefore(l),i=l;i&&(3==i.nodeType||b[e][i.tagName])&&i!==a;)o=i,i=w.getNextDomNode(i,1==i.nodeType,null,function(t){return b[e][t.tagName]});var c,u=d.setEndAfter(o).extractContents();if(n&&n.length>0){var f,m;m=f=n[0].cloneNode(!1);for(var h,p=1;h=n[p++];)f.appendChild(h.cloneNode(!1)),f=f.firstChild;c=f}else c=d.document.createElement(e);t&&w.setAttributes(c,t),c.appendChild(u),d.insertNode(n?m:c);var g;if("span"==e&&t.style&&/text\-decoration/.test(t.style)&&(g=w.findParentByTagName(c,"a",!0))?(w.setAttributes(g,t),w.remove(c,!0),c=g):(w.mergeSibling(c),w.clearEmptySibling(c)),w.mergeChild(c,t),l=w.getNextDomNode(c,!1,s),w.mergeToParent(c),i===a)break}else l=w.getNextDomNode(l,!0,s);return this.moveToBookmark(r)},removeInlineStyle:function(e){if(this.collapsed)return this;e=v.isArray(e)?e:[e],this.shrinkBoundary().adjustmentBoundary();for(var t=this.startContainer,n=this.endContainer;;){if(1==t.nodeType){if(v.indexOf(e,t.tagName.toLowerCase())>-1)break;if("body"==t.tagName.toLowerCase()){t=null;break}}t=t.parentNode}for(;;){if(1==n.nodeType){if(v.indexOf(e,n.tagName.toLowerCase())>-1)break;if("body"==n.tagName.toLowerCase()){n=null;break}}n=n.parentNode}var i,o,r=this.createBookmark();t&&(o=this.cloneRange().setEndBefore(r.start).setStartBefore(t),i=o.extractContents(),o.insertNode(i),w.clearEmptySibling(t,!0),t.parentNode.insertBefore(r.start,t)),n&&(o=this.cloneRange().setStartAfter(r.end).setEndAfter(n),i=o.extractContents(),o.insertNode(i),w.clearEmptySibling(n,!1,!0),n.parentNode.insertBefore(r.end,n.nextSibling));for(var a,s=w.getNextDomNode(r.start,!1,function(e){return 1==e.nodeType});s&&s!==r.end;)a=w.getNextDomNode(s,!0,function(e){return 1==e.nodeType}),v.indexOf(e,s.tagName.toLowerCase())>-1&&w.remove(s,!0),s=a;return this.moveToBookmark(r)},getClosedNode:function(){var e;if(!this.collapsed){var n=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(t(n)){var i=n.startContainer.childNodes[n.startOffset];i&&1==i.nodeType&&(b.$empty[i.tagName]||b.$nonChild[i.tagName])&&(e=i)}}return e},select:p.ie?function(e,t){var n;this.collapsed||this.shrinkBoundary();var i=this.getClosedNode();if(i&&!t){try{n=this.document.body.createControlRange(),n.addElement(i),n.select()}catch(a){}return this}var l,c=this.createBookmark(),u=c.start;if(n=this.document.body.createTextRange(),n.moveToElementText(u),n.moveStart("character",1),this.collapsed){if(!e&&3!=this.startContainer.nodeType){var f=this.document.createTextNode(d),m=this.document.createElement("span");m.appendChild(this.document.createTextNode(d)),u.parentNode.insertBefore(m,u),u.parentNode.insertBefore(f,u),o(this.document,f),s=f,r(m,"previousSibling"),r(u,"nextSibling"),n.moveStart("character",-1),n.collapse(!0)}}else{var h=this.document.body.createTextRange();l=c.end,h.moveToElementText(l),n.setEndPoint("EndToEnd",h)}this.moveToBookmark(c),m&&w.remove(m);try{n.select()}catch(a){}return this}:function(e){function t(e){function t(t,n,i){3==t.nodeType&&t.nodeValue.length<n&&(e[i+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start"),t(e.endContainer,e.endOffset,"end")}var n,i=w.getWindow(this.document),a=i.getSelection();if(p.gecko?this.document.body.focus():i.focus(),a){if(a.removeAllRanges(),this.collapsed&&!e){var l=this.startContainer,c=l;1==l.nodeType&&(c=l.childNodes[this.startOffset]),3==l.nodeType&&this.startOffset||(c?c.previousSibling&&3==c.previousSibling.nodeType:l.lastChild&&3==l.lastChild.nodeType)||(n=this.document.createTextNode(d),this.insertNode(n),o(this.document,n),r(n,"previousSibling"),r(n,"nextSibling"),s=n,this.setStart(n,p.webkit?1:0).collapse(!0))}var u=this.document.createRange();if(this.collapsed&&p.opera&&1==this.startContainer.nodeType){var c=this.startContainer.childNodes[this.startOffset];if(c){for(;c&&w.isBlockElm(c)&&1==c.nodeType&&c.childNodes[0];)c=c.childNodes[0];c&&this.setStartBefore(c).collapse(!0)}else c=this.startContainer.lastChild,c&&w.isBr(c)&&this.setStartBefore(c).collapse(!0)}t(this),u.setStart(this.startContainer,this.startOffset),u.setEnd(this.endContainer,this.endOffset),a.addRange(u)}return this},scrollToView:function(e,t){e=e?window:w.getWindow(this.document);var n=this,i=n.document.createElement("span");return i.innerHTML="&nbsp;",n.cloneRange().insertNode(i),w.scrollToView(i,e,t),w.remove(i),n},inFillChar:function(){var e=this.startContainer;return this.collapsed&&3==e.nodeType&&e.nodeValue.replace(new RegExp("^"+w.fillChar),"").length+1==e.nodeValue.length?!0:!1},createAddress:function(e,t){function n(e){for(var n,i=e?o.startContainer:o.endContainer,r=w.findParents(i,!0,function(e){return!w.isBody(e)}),a=[],s=0;n=r[s++];)a.push(w.getNodeIndex(n,t));var l=0;if(t)if(3==i.nodeType){for(var d=i.previousSibling;d&&3==d.nodeType;)l+=d.nodeValue.replace(E,"").length,d=d.previousSibling;l+=e?o.startOffset:o.endOffset}else if(i=i.childNodes[e?o.startOffset:o.endOffset])l=w.getNodeIndex(i,t);else{i=e?o.startContainer:o.endContainer;for(var c=i.firstChild;c;)if(w.isFillChar(c))c=c.nextSibling;else if(l++,3==c.nodeType)for(;c&&3==c.nodeType;)c=c.nextSibling;else c=c.nextSibling}else l=e?w.isFillChar(i)?0:o.startOffset:o.endOffset;return 0>l&&(l=0),a.push(l),a}var i={},o=this;return i.startAddress=n(!0),e||(i.endAddress=o.collapsed?[].concat(i.startAddress):n()),i},moveToAddress:function(e,t){function n(e,t){for(var n,o,r,a=i.document.body,s=0,l=e.length;l>s;s++)if(r=e[s],n=a,a=a.childNodes[r],!a){o=r;break}t?a?i.setStartBefore(a):i.setStart(n,o):a?i.setEndBefore(a):i.setEnd(n,o)}var i=this;return n(e.startAddress,!0),!t&&e.endAddress&&n(e.endAddress),i},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},traversal:function(e,t){if(this.collapsed)return this;for(var n=this.createBookmark(),i=n.end,o=w.getNextDomNode(n.start,!1,t);o&&o!==i&&w.getPosition(o,i)&w.POSITION_PRECEDING;){var r=w.getNextDomNode(o,!1,t);e(o),o=r}return this.moveToBookmark(n)}}}(),function(){function e(e,t){var n=w.getNodeIndex;e=e.duplicate(),e.collapse(t);var i=e.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var o,r,a=i.children,s=e.duplicate(),l=0,d=a.length-1,c=-1;d>=l;){c=Math.floor((l+d)/2),o=a[c],s.moveToElementText(o);var u=s.compareEndPoints("StartToStart",e);if(u>0)d=c-1;else{if(!(0>u))return{container:i,offset:n(o)};l=c+1}}if(-1==c){if(s.moveToElementText(i),s.setEndPoint("StartToStart",e),r=s.text.replace(/(\r\n|\r)/g,"\n").length,a=i.childNodes,!r)return o=a[a.length-1],{container:o,offset:o.nodeValue.length};for(var f=a.length;r>0;)r-=a[--f].nodeValue.length;return{container:a[f],offset:-r}}if(s.collapse(u>0),s.setEndPoint(u>0?"StartToStart":"EndToStart",e),r=s.text.replace(/(\r\n|\r)/g,"\n").length,!r)return b.$empty[o.tagName]||b.$nonChild[o.tagName]?{container:i,offset:n(o)+(u>0?0:1)}:{container:o,offset:u>0?0:o.childNodes.length};for(;r>0;)try{var m=o;o=o[u>0?"previousSibling":"nextSibling"],r-=o.nodeValue.length}catch(h){return{container:i,offset:n(m)}}return{container:o,offset:u>0?-r:o.nodeValue.length+r}}function t(t,n){if(t.item)n.selectNode(t.item(0));else{var i=e(t,!0);n.setStart(i.container,i.offset),0!=t.compareEndPoints("StartToEnd",t)&&(i=e(t,!1),n.setEnd(i.container,i.offset))}return n}function n(e){var t;try{t=e.getNative().createRange()}catch(n){return null}var i=t.item?t.item(0):t.parentElement();return(i.ownerDocument||i)===e.document?t:null}var i=a.Selection=function(e){var t,i=this;i.document=e,g&&(t=w.getWindow(e).frameElement,w.on(t,"beforedeactivate",function(){i._bakIERange=i.getIERange()}),w.on(t,"activate",function(){try{!n(i)&&i._bakIERange&&i._bakIERange.select()}catch(e){}i._bakIERange=null})),t=e=null};i.prototype={getNative:function(){var e=this.document;try{return e?g?e.selection:w.getWindow(e).getSelection():null}catch(t){return null}},getIERange:function(){var e=n(this);return!e&&this._bakIERange?this._bakIERange:e},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?w.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return p.ie&&n(this)||!p.ie&&this.getNative().rangeCount?!0:!1}catch(e){return!1}},getRange:function(){function e(e){for(var t=n.document.body.firstChild,i=e.collapsed;t&&t.firstChild;)e.setStart(t,0),t=t.firstChild;e.startContainer||e.setStart(n.document.body,0),i&&e.collapse(!0)}var n=this;if(null!=n._cachedRange)return this._cachedRange;var i=new r.editor.dom.Range(n.document);if(g){var o=n.getIERange();if(o)try{t(o,i)}catch(a){e(i)}else e(i)}else{var s=n.getNative();if(s&&s.rangeCount){var l=s.getRangeAt(0),d=s.getRangeAt(s.rangeCount-1);i.setStart(l.startContainer,l.startOffset).setEnd(d.endContainer,d.endOffset),i.collapsed&&w.isBody(i.startContainer)&&!i.startOffset&&e(i)}else{if(this._bakRange&&w.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;e(i)}}return this._bakRange=i},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e,t,n,i,o=g?this.getIERange():this.getRange();if(g){if(!o)return this.document.body.firstChild;if(o.item)return o.item(0);for(e=o.duplicate(),e.text.length>0&&e.moveStart("character",1),e.collapse(1),t=e.parentElement(),i=n=o.parentElement();n=n.parentNode;)if(n==t){t=i;break}}else if(o.shrinkBoundary(),t=o.startContainer,1==t.nodeType&&t.hasChildNodes()&&(t=t.childNodes[Math.min(t.childNodes.length-1,o.startOffset)]),3==t.nodeType)return t.parentNode;return t},getText:function(){var e,t;return this.isFocus()&&(e=this.getNative())?(t=p.ie?e.createRange():e.getRangeAt(0),p.ie?t.text:t.toString()):""},clearRange:function(){this.getNative()[p.ie?"empty":"removeAllRanges"]()}}}(),function(){function e(e,t){var n;if(t.textarea)if(v.isString(t.textarea)){for(var i,o=0,r=w.getElementsByTagName(e,"textarea");i=r[o++];)if(i.id=="ueditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||(e.appendChild(n=w.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}var t,n=0,i=UE.Editor=function(e){function t(){for(var e in UE.plugins)UE.plugins[e].call(i);i.langIsReady=!0,i.fireEvent("langReady")}var i=this;i.uid=n++,y.call(i),i.commands={},i.options=v.extend(v.clone(e||{}),UEDITOR_CONFIG,!0),i.shortcutkeys={},i.inputRules=[],i.outputRules=[],i.setOpt({isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:i.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:i.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:i.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0}),UE.instants["ueditorInstant"+i.uid]=i,null!==i.options.langPath?v.loadFile(document,{src:i.options.langPath+i.options.lang+"/"+i.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},t):t()};i.prototype={ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};v.isString(e)?n[e]=t:n=e,v.extend(this.options,n,!0)},destroy:function(){var e=this;e.fireEvent("destroy");var t=e.container.parentNode,n=e.textarea;n?n.style.display="":(n=document.createElement("textarea"),t.parentNode.insertBefore(n,t)),n.style.width=e.iframe.offsetWidth+"px",n.style.height=e.iframe.offsetHeight+"px",n.value=e.getContent(),n.id=e.key,t.innerHTML="",w.remove(t);var i=e.key;for(var o in e)e.hasOwnProperty(o)&&delete this[o];UE.delEditor(i)},render:function(e){var t=this,n=t.options;if(v.isString(e)&&(e=document.getElementById(e)),e){var i=g&&p.version<9,o=(g&&p.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml'"+(i?"":" class='view'")+"><head>"+(n.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+v.unhtml(n.iframeCssUrl)+"'/>":"")+"<style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:100%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}"+(n.initialStyle||"")+"</style></head><body"+(i?" class='view'":"")+"></body>";if(n.customDomain&&document.domain!=location.hostname)o+="<script>window.parent.UE.instants['ueditorInstant"+t.uid+"']._setup(document);</script></html>",e.appendChild(w.createElement(document,"iframe",{id:"ueditor_"+t.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();document.domain="'+document.domain+'";document.write("'+o+'");document.close();}())'}));else{n.minFrameWidth=n.initialFrameWidth?n.initialFrameWidth:n.initialFrameWidth=e.offsetWidth,n.initialFrameHeight?n.minFrameHeight=n.initialFrameHeight:n.initialFrameHeight=n.minFrameHeight=e.offsetHeight,e.style.width=n.initialFrameWidth+"px",e.style.height=n.initialFrameHeight+"px",e.style.zIndex=n.zIndex,e.innerHTML='<iframe id="ueditor_'+this.uid+'"width="100%" height="100%" scroll="no" frameborder="0" ></iframe>';var r=e.firstChild.contentWindow.document;r.open(),r.write(o+"</html>"),r.close(),t._setup(r)}e.style.overflow="hidden"}},_setup:function(t){var n=this,i=n.options;g?(t.body.disabled=!0,t.body.contentEditable=!0,t.body.disabled=!1):(t.body.contentEditable=!0,t.body.spellcheck=!1),n.document=t,n.window=t.defaultView||t.parentWindow,n.iframe=n.window.frameElement,n.body=t.body,n.selection=new a.Selection(t);var o;p.gecko&&(o=this.selection.getNative())&&o.removeAllRanges(),this._initEvents();for(var r=this.iframe.parentNode;!w.isBody(r);r=r.parentNode)if("FORM"==r.tagName){n.form=r,n.options.autoSyncData?w.on(n.window,"blur",function(){e(r,n)}):w.on(r,"submit",function(){e(this,n)});break}if(i.initialContent)if(i.autoClearinitialContent){var s=n.execCommand;n.execCommand=function(){return n.fireEvent("firstBeforeExecCommand"),s.apply(n,arguments)},this._setDefaultContent(i.initialContent)}else this.setContent(i.initialContent,!1,!0);w.isEmptyNode(n.body)&&(n.body.innerHTML="<p>"+(p.ie?"":"<br/>")+"</p>"),i.focus&&setTimeout(function(){n.focus(n.options.focusInEnd),!n.options.autoClearinitialContent&&n._selectionChange()},0),n.container||(n.container=this.iframe.parentNode),i.fullscreen&&n.ui&&n.ui.setFullScreen(!0);try{n.document.execCommand("2D-position",!1,!1)}catch(l){}try{n.document.execCommand("enableInlineTableEditing",!1,!1)}catch(l){}try{n.document.execCommand("enableObjectResizing",!1,!1)}catch(l){}n._bindshortcutKeys(),n.isReady=1,n.fireEvent("ready"),i.onready&&i.onready.call(n),p.ie||w.on(n.window,["blur","focus"],function(e){if("blur"==e.type){n._bakRange=n.selection.getRange();try{n.selection.getNative().removeAllRanges()}catch(e){}}else try{n._bakRange&&n._bakRange.select()}catch(e){}}),p.gecko&&p.version<=10902&&(n.body.contentEditable=!1,setTimeout(function(){n.body.contentEditable=!0},100),setInterval(function(){n.body.style.height=n.iframe.offsetHeight-20+"px"},100)),!i.isShow&&n.setHide(),i.readonly&&n.setDisabled()},sync:function(t){var n=this,i=t?document.getElementById(t):w.findParent(n.iframe.parentNode,function(e){return"FORM"==e.tagName},!0);i&&e(i,n)},setHeight:function(e){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px"),this.document.body.style.height=e-20+"px"},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,v.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,i){var o=i.keyCode||i.which;for(var r in t)for(var a,s=t[r].split(","),l=0;a=s[l++];){a=a.split(":");var d=a[0],c=a[1];(/^(ctrl)(\+shift)?\+(\d+)$/.test(d.toLowerCase())||/^(\d+)$/.test(d))&&(("ctrl"==RegExp.$1?i.ctrlKey||i.metaKey:0)&&(""!=RegExp.$2?i[RegExp.$2.slice(1)+"Key"]:1)&&o==RegExp.$3||o==RegExp.$1)&&(-1!=e.queryCommandState(r,c)&&e.execCommand(r,c),w.preventDefault(i))}})},getContent:function(e,t,n,i,o){var r=this;if(e&&v.isFunction(e)&&(t=e,e=""),t?!t():!this.hasContents())return"";r.fireEvent("beforegetcontent");var a=UE.htmlparser(r.body.innerHTML,i);return r.filterOutputRule(a),r.fireEvent("aftergetcontent",e),f.getOrigin(a.toHtml(o))},getAllHtml:function(){var e=this,t=[];if(e.fireEvent("getAllHtml",t),p.ie&&p.version>8){var n="";v.each(e.document.styleSheets,function(e){n+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),v.each(e.document.getElementsByTagName("script"),function(e){n+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(n||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head><body "+(g&&p.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(w.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return b.$block[n]?"\n":t?t:""}),t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(w.fillChar,"g");return this.body[p.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(t,n,i){function o(e){return"DIV"==e.tagName&&e.getAttribute("cdata_tag")}var r=this;/<\s*\/\s*pre\s*>$/.test(v.trim(t))&&(t+="<p>&nbsp;</p>"),r.fireEvent("beforesetcontent",t);var a=UE.htmlparser(t);if(r.filterInputRule(a),t=a.toHtml(),r.body.innerHTML=(n?r.body.innerHTML:"")+t,"p"==r.options.enterTag){var s,l=this.body.firstChild;if(!l||1==l.nodeType&&(b.$cdata[l.tagName]||o(l)||w.isCustomeNode(l))&&l===this.body.lastChild)this.body.innerHTML="<p>"+(p.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var d=r.document.createElement("p");l;){for(;l&&(3==l.nodeType||1==l.nodeType&&b.p[l.tagName]&&!b.$cdata[l.tagName]);)s=l.nextSibling,d.appendChild(l),l=s;if(d.firstChild){if(!l){r.body.appendChild(d);break}l.parentNode.insertBefore(d,l),d=r.document.createElement("p")}l=l.nextSibling}}r.fireEvent("aftersetcontent"),r.fireEvent("contentchange"),!i&&r._selectionChange(),r._bakRange=r._bakIERange=null;var c;p.gecko&&(c=this.selection.getNative())&&c.removeAllRanges(),r.options.autoSyncData&&r.form&&e(r.form,r)},focus:function(e){try{var t=this,n=t.selection.getRange();e?n.setStartAtLast(t.body.lastChild).setCursor(!1,!0):n.select(!0),this.fireEvent("focus")}catch(i){}},_initEvents:function(){try{var e=this,t=e.document,n=e.window;e._proxyDomEvent=v.bind(e._proxyDomEvent,e),w.on(t,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],e._proxyDomEvent),w.on(n,["focus","blur"],e._proxyDomEvent),w.on(t,["mouseup","keydown"],function(t){"keydown"==t.type&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)||2!=t.button&&e._selectionChange(250,t)});var i,o=0,r=p.ie?e.body:e.document;w.on(r,"dragstart",function(){o=1}),w.on(r,p.webkit?"dragover":"drop",function(){return p.webkit?function(){clearTimeout(i),i=setTimeout(function(){if(!o){var t=e.selection,n=t.getRange();if(n){var i=n.getCommonAncestor();if(i&&e.serialize){var r=e.serialize,a=r.filter(r.transformInput(r.parseHTML(r.word(i.innerHTML))));i.innerHTML=r.toHTML(a)}}}o=0},200)}:function(e){o||(e.preventDefault?e.preventDefault():e.returnValue=!1),o=0}}())}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:4657})}},_proxyDomEvent:function(e){return this.fireEvent(e.type.replace(/^on/,""),e)},_selectionChange:function(e,n){var i,o,r=this,a=!1;if(p.ie&&p.version<9&&n&&"mouseup"==n.type){var s=this.selection.getRange();s.collapsed||(a=!0,i=n.clientX,o=n.clientY)}clearTimeout(t),t=setTimeout(function(){if(r.selection.getNative()){var e;if(a&&"None"==r.selection.getNative().type){e=r.document.body.createTextRange();try{e.moveToPoint(i,o)}catch(t){e=null}}var s;e&&(s=r.selection.getIERange,r.selection.getIERange=function(){return e}),r.selection.cache(),s&&(r.selection.getIERange=s),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!n),r.fireEvent("afterselectionchange"),r.selection.clear())}},e||50)},_callCmdFn:function(e,t){var n,i,o=t[0].toLowerCase();return n=this.commands[o]||UE.commands[o],i=n&&n[e],n&&i||"queryCommandState"!=e?i?i.apply(this,t):void 0:0},execCommand:function(e){e=e.toLowerCase();var t,n=this,i=n.commands[e]||UE.commands[e];return i&&i.execCommand?(i.notNeedUndo||n.__hasEnterExecCommand?(t=this._callCmdFn("execCommand",arguments),!n._ignoreContentChange&&n.fireEvent("contentchange")):(n.__hasEnterExecCommand=!0,-1!=n.queryCommandState.apply(n,arguments)&&(n.fireEvent("beforeexeccommand",e),t=this._callCmdFn("execCommand",arguments),!n._ignoreContentChange&&n.fireEvent("contentchange"),n.fireEvent("afterexeccommand",e)),n.__hasEnterExecCommand=!1),!n._ignoreContentChange&&n._selectionChange(),t):null},queryCommandState:function(){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t,n=0;t=e[n++];)if(this.document.getElementsByTagName(t).length>0)return!0;if(!w.isEmptyBlock(this.body))return!0;for(e=["div"],n=0;t=e[n++];)for(var i,o=w.getElementsByTagName(this.document,t),r=0;i=o[r++];)if(w.isCustomeNode(i))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e,t=this;if("false"==t.body.contentEditable){t.body.contentEditable=!0,e=t.selection.getRange();try{e.moveToBookmark(t.lastBk),delete t.lastBk}catch(n){e.setStartAtFirst(t.body).collapse(!0)}e.select(!0),t.bkqueryCommandState&&(t.queryCommandState=t.bkqueryCommandState,delete t.bkqueryCommandState),t.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(e){var t=this;e=e?v.isArray(e)?e:[e]:[],"true"==t.body.contentEditable&&(t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.body.contentEditable=!1,t.bkqueryCommandState=t.queryCommandState,t.queryCommandState=function(n){return-1!=v.indexOf(e,n)?t.bkqueryCommandState.apply(t,arguments):-1},t.fireEvent("selectionchange"))},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(g?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",e),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var n=this;n.body.innerHTML='<p id="initContent">'+t+"</p>",n.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if("none"==e.container.style.display){try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n,i=0;(n=e[i++])&&(t=t[n],t););return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]),n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var i,o=0;i=t[o++];)n+=this.document.getElementsByTagName(i).length}return n},addInputRule:function(e){this.inputRules.push(e)},filterInputRule:function(e){for(var t,n=0;t=this.inputRules[n++];)t.call(this,e)},addOutputRule:function(e){this.outputRules.push(e)},filterOutputRule:function(e){for(var t,n=0;t=this.outputRules[n++];)t.call(this,e)}},v.inherits(i,y)}();UE.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/gi.test(e)}function t(e){return e=e.replace(/[\d.]+\w+/g,function(e){return v.transUnitToPx(e)})}function n(e){return e.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(p.opera)return"";try{var n=e.match(/width:([ \d.]*p[tx])/i)[1],i=e.match(/height:([ \d.]*p[tx])/i)[1],o=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(n)+'" height="'+t(i)+'" src="'+o+'" />'}catch(r){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,n,i){return"class"==t&&"MsoListParagraph"==i?e:""}).replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,n,i,o){for(var r,a=[],s=o.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g),l=0;r=s[l];l++){var d,c,u=r.split(":");if(2==u.length){if(d=u[0].toLowerCase(),c=u[1].toLowerCase(),/^(background)\w*/.test(d)&&0==c.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(d)&&/^0\w+$/.test(c))continue;switch(d){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(n)||(a[l]=d.replace(/^mso-|-alt$/g,"")+":"+t(c));continue;case"horiz-align":a[l]="text-align:"+c;continue;case"vert-align":a[l]="vertical-align:"+c;continue;case"font-color":case"mso-foreground":a[l]="color:"+c;continue;case"mso-background":case"mso-highlight":a[l]="background:"+c;continue;case"mso-default-height":a[l]="min-height:"+t(c);continue;case"mso-default-width":a[l]="min-width:"+t(c);continue;case"mso-padding-between-alt":a[l]="border-collapse:separate;border-spacing:"+t(c);continue;case"text-line-through":("single"==c||"double"==c)&&(a[l]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==c&&(a[l]="display:none");continue;case"background":break;case"margin":if(!/[1-9]/.test(c))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(d)||/text\-indent|padding|margin/.test(d)&&/\-[\d.]+/.test(c))continue;a[l]=d+":"+u[1]}}return n+(a.length?' style="'+a.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return v.transUnitToPx(e)})}return function(t){return e(t)?n(t):t}}();!function(){function e(e,t,n){return e.push(u),t+(n?1:-1)}function t(e,t){for(var n=0;t>n;n++)e.push(c)}function n(a,s,l,d){switch(a.type){case"root":for(var c,u=0;c=a.children[u++];)l&&"element"==c.type&&!b.$inlineWithA[c.tagName]&&u>1&&(e(s,d,!0),t(s,d)),n(c,s,l,d);break;case"text":i(a,s);break;case"element":o(a,s,l,d);break;case"comment":r(a,s,l)}return s}function i(e,t){t.push("pre"==e.parentNode.tagName?e.data:e.data.replace(/[ ]{2}/g," &nbsp;"))}function o(i,o,r,a){var s="";if(i.attrs){s=[];var l=i.attrs;for(var d in l)s.push(d+(void 0!==l[d]?'="'+v.unhtml(l[d])+'"':""));s=s.join(" ")}if(o.push("<"+i.tagName+(s?" "+s:"")+(b.$empty[i.tagName]?"/":"")+">"),r&&!b.$inlineWithA[i.tagName]&&"pre"!=i.tagName&&i.children&&i.children.length&&(a=e(o,a,!0),t(o,a)),i.children&&i.children.length)for(var c,u=0;c=i.children[u++];)r&&"element"==c.type&&!b.$inlineWithA[c.tagName]&&u>1&&(e(o,a),t(o,a)),n(c,o,r,a);b.$empty[i.tagName]||(r&&!b.$inlineWithA[i.tagName]&&"pre"!=i.tagName&&i.children&&i.children.length&&(a=e(o,a),t(o,a)),o.push("</"+i.tagName+">"))}function r(e,t){t.push("<!--"+e.data+"-->")}function a(e,t){var n;if("element"==e.type&&e.getAttr("id")==t)return e;if(e.children&&e.children.length)for(var i,o=0;i=e.children[o++];)if(n=a(i,t))return n}function s(e,t,n){if("element"==e.type&&e.tagName==t&&n.push(e),e.children&&e.children.length)for(var i,o=0;i=e.children[o++];)s(i,t,n)}function l(e,t){if(e.children&&e.children.length)for(var n,i=0;n=e.children[i];)l(n,t),n.parentNode&&(n.children&&n.children.length&&t(n),n.parentNode&&i++);else t(e)}var d=UE.uNode=function(e){this.type=e.type,this.data=e.data,this.tagName=e.tagName,this.parentNode=e.parentNode,this.attrs=e.attrs||{},this.children=e.children},c="    ",u="\n";d.createElement=function(e){return/[<>]/.test(e)?UE.htmlparser(e).children[0]:new d({type:"element",children:[],tagName:e})},d.createText=function(e){return new UE.uNode({type:"text",data:v.unhtml(e||"")})},d.prototype={toHtml:function(e){var t=[];return n(this,t,e,0),t.join("")},innerHTML:function(e){if("element"!=this.type||b.$empty[this.tagName])return this;if(v.isString(e)){if(this.children)for(var t,n=0;t=this.children[n++];)t.parentNode=null;this.children=[];for(var t,i=UE.htmlparser(e),n=0;t=i.children[n++];)this.children.push(t),t.parentNode=this;return this}var i=new UE.uNode({type:"root",children:this.children});return i.toHtml()},innerText:function(e){if("element"!=this.type||b.$empty[this.tagName])return this;if(e){if(this.children)for(var t,n=0;t=this.children[n++];)t.parentNode=null;return this.children=[],this.appendChild(d.createText(e)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data
},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return 0==n?null:t.children[n-1]},nextSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n++];)if(e===this)return t.children[n]},replaceChild:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,1,e),t.parentNode=null,e.parentNode=this,e}},appendChild:function(e){if("root"==this.type||"element"==this.type&&!b.$empty[this.tagName]){this.children||(this.children=[]),e.parentNode&&e.parentNode.removeChild(e);for(var t,n=0;t=this.children[n];n++)if(t===e){this.children.splice(n,1);break}return this.children.push(e),e.parentNode=this,e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,0,e),e.parentNode=this,e}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i+1,0,e),e.parentNode=this,e}},removeChild:function(e,t){if(this.children)for(var n,i=0;n=this.children[i];i++)if(n===e){if(this.children.splice(i,1),n.parentNode=null,t&&n.children&&n.children.length)for(var o,r=0;o=n.children[r];r++)this.children.splice(i+r,0,o),o.parentNode=this;return n}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(!e)return void delete this.attrs;if(this.attrs||(this.attrs={}),v.isObject(e))for(var n in e)e[n]?this.attrs[n.toLowerCase()]=e[n]:delete this.attrs[n];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e]},getIndex:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return n;return-1},getNodeById:function(e){var t;if(this.children&&this.children.length)for(var n,i=0;n=this.children[i++];)if(t=a(n,e))return t},getNodesByTagName:function(e){e=v.trim(e).replace(/[ ]{2,}/g," ").split(" ");var t=[],n=this;return v.each(e,function(e){if(n.children&&n.children.length)for(var i,o=0;i=n.children[o++];)s(i,e,t)}),t},getStyle:function(e){var t=this.getAttr("style");if(!t)return"";var n=new RegExp(e+":([^;]+)","i"),i=t.match(n);return i&&i[0]?i[1]:""},setStyle:function(e,t){function n(e,t){var n=new RegExp(e+":([^;]+;?)","gi");i=i.replace(n,""),t&&(i=e+":"+v.unhtml(t)+";"+i)}var i=this.getAttr("style");if(i||(i=""),v.isObject(e))for(var o in e)n(o,e[o]);else n(e,t);this.setAttr("style",i)},traversal:function(e){return this.children&&this.children.length&&l(this,e),this}}}();UE.htmlparser=function(e,t){function n(e,t){if(u[e.tagName]){var n=d.createElement(u[e.tagName]);e.appendChild(n),n.appendChild(d.createText(t)),e=n}else e.appendChild(d.createText(t))}function i(e,t,n){var o;if(o=c[t]){for(var r,s=e;"root"!=s.type;){if(v.isArray(o)?-1!=v.indexOf(o,s.tagName):o==s.tagName){e=s,r=!0;break}s=s.parentNode}r||(e=i(e,v.isArray(o)?o[0]:o))}var l=new d({parentNode:e,type:"element",tagName:t.toLowerCase(),children:b.$empty[t]?null:[]});if(n){for(var u,f={};u=a.exec(n);)f[u[1].toLowerCase()]=v.unhtml(u[2]||u[3]||u[4]);l.attrs=f}return e.children.push(l),b.$empty[t]?e:l}function o(e,t){e.children.push(new d({type:"comment",data:t,parentNode:e}))}var r=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,a=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,s={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(w.fillChar,"g"),""),t||(e=e.replace(new RegExp("[\\r\\t\\n"+(t?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(t?"":" ")+"]*","g"),function(e,n){return n&&s[n.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(new RegExp("^[\\r\\n"+(t?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(t?"":" ")+"]+$"),"")}));for(var l,d=UE.uNode,c={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},u={ol:"li",ul:"li"},f=0,m=0,h=new d({type:"root",children:[]}),p=h;l=r.exec(e);){f=l.index;try{if(f>m&&n(p,e.slice(m,f)),l[3])p=i(p,l[3].toLowerCase(),l[4]);else if(l[1]){if("root"!=p.type){for(var g=p;"element"==p.type&&p.tagName!=l[1].toLowerCase();)if(p=p.parentNode,"root"==p.type)throw p=g,"break";p=p.parentNode}}else l[2]&&o(p,l[2])}catch(y){}m=r.lastIndex}return m<e.length&&n(p,e.slice(m)),h},UE.filterNode=function(){function e(t,n){switch(t.type){case"text":break;case"element":var i;if(i=n[t.tagName])if("-"===i)t.parentNode.removeChild(t);else if(v.isFunction(i)){var o=t.parentNode,r=t.getIndex();if(i(t),t.parentNode){if(t.children)for(var a,s=0;a=t.children[s];)e(a,n),a.parentNode&&s++}else for(var a,s=r;a=o.children[s];)e(a,n),a.parentNode&&s++}else{var l=i.$;if(l&&t.attrs){var d,c={};for(var u in l){if(d=t.getAttr(u),"style"==u&&v.isArray(l[u])){var f=[];v.each(l[u],function(e){var n;(n=t.getStyle(e))&&f.push(e+":"+n)}),d=f.join(";")}d&&(c[u]=d)}t.attrs=c}if(t.children)for(var a,s=0;a=t.children[s];)e(a,n),a.parentNode&&s++}else if(b.$cdata[t.tagName])t.parentNode.removeChild(t);else{var o=t.parentNode,r=t.getIndex();t.parentNode.removeChild(t,!0);for(var a,s=r;a=o.children[s];)e(a,n),a.parentNode&&s++}break;case"comment":t.parentNode.removeChild(t)}}return function(t,n){if(v.isEmptyObject(n))return t;var i;(i=n["-"])&&v.each(i.split(" "),function(e){n[e]="-"});for(var o,r=0;o=t.children[r];)e(o,n),o.parentNode&&r++;return t}}();UE.plugins.basestyle=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},t=function(e,t){return w.filterNodeList(e.selection.getStartElementPath(),t)},n=this;n.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),n.addInputRule(function(e){v.each(e.getNodesByTagName("b i"),function(e){switch(e.tagName){case"b":e.tagName="strong";break;case"i":e.tagName="em"}})});for(var i in e)!function(e,i){n.commands[e]={execCommand:function(e){var o=n.selection.getRange(),r=t(this,i);if(o.collapsed){if(r){var a=n.document.createTextNode("");o.insertNode(a).removeInlineStyle(i),o.setStartBefore(a),w.remove(a)}else{var s=o.document.createElement(i[0]);("superscript"==e||"subscript"==e)&&(a=n.document.createTextNode(""),o.insertNode(a).removeInlineStyle(["sub","sup"]).setStartBefore(a).collapse(!0)),o.insertNode(s).setStart(s,0)}o.collapse(!0)}else("superscript"==e||"subscript"==e)&&(r&&r.tagName.toLowerCase()==e||o.removeInlineStyle(["sub","sup"])),r?o.removeInlineStyle(i):o.applyInlineStyle(i[0]);o.select()},queryCommandState:function(){return t(this,i)?1:0}}}(i,e[i])},UE.plugins.defaultfilter=function(){var e=this;e.addInputRule(function(t){var n;t.traversal(function(t){if("element"==t.type){if(!b.$cdata[t.tagName]&&e.options.autoClearEmptyNode&&b.$inline[t.tagName]&&!b.$empty[t.tagName]&&(!t.attrs||v.isEmptyObject(t.attrs)))return void(t.firstChild()?"span"!=t.tagName||t.attrs&&!v.isEmptyObject(t.attrs)||t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t));switch(t.tagName){case"style":case"script":t.setAttr({cdata_tag:t.tagName,cdata_data:encodeURIComponent(t.innerText()||"")}),t.tagName="div",t.removeChild(t.firstChild());break;case"a":(n=t.getAttr("href"))&&t.setAttr("_href",n);break;case"img":if((n=t.getAttr("src"))&&/^data:/.test(n)){t.parentNode.removeChild(t);break}t.setAttr("_src",t.getAttr("src"));break;case"span":p.webkit&&(n=t.getStyle("white-space"))&&/nowrap|normal/.test(n)&&(t.setStyle("white-space",""),e.options.autoClearEmptyNode&&v.isEmptyObject(t.attrs)&&t.parentNode.removeChild(t,!0));break;case"p":(n=t.getAttr("align"))&&(t.setAttr("align"),t.setStyle("text-align",n));var i=t.getAttr("style");i&&(i=i.replace(/(margin|padding)[^;]+/g,""),t.setAttr("style",i)),t.firstChild()||t.innerHTML(UE.browser.ie?"&nbsp;":"<br>");break;case"div":if(t.getAttr("cdata_tag"))break;if(n=t.getAttr("class"),n&&/^line number\d+/.test(n))break;for(var o,r=UE.uNode.createElement("p");o=t.firstChild();)"text"!=o.type&&UE.dom.dtd.$block[o.tagName]?r.firstChild()?(t.parentNode.insertBefore(r,t),r=UE.uNode.createElement("p")):t.parentNode.insertBefore(o,t):r.appendChild(o);r.firstChild()&&t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t);break;case"dl":t.tagName="ul";break;case"dt":case"dd":t.tagName="li";break;case"li":var a=t.getAttr("class");a&&/list\-/.test(a)||t.setAttr();var s=t.getNodesByTagName("ol ul");UE.utils.each(s,function(e){t.parentNode.insertAfter(e,t)});break;case"td":case"th":case"caption":t.children&&t.children.length||t.appendChild(p.ie?UE.uNode.createText(" "):UE.uNode.createElement("br"))}}"comment"==t.type&&t.parentNode.removeChild(t)})}),e.addOutputRule(function(t){var n;t.traversal(function(t){if("element"==t.type){if(e.options.autoClearEmptyNode&&b.$inline[t.tagName]&&!b.$empty[t.tagName]&&(!t.attrs||v.isEmptyObject(t.attrs)))return void(t.firstChild()?"span"!=t.tagName||t.attrs&&!v.isEmptyObject(t.attrs)||t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t));switch(t.tagName){case"div":(n=t.getAttr("cdata_tag"))&&(t.tagName=n,t.appendChild(UE.uNode.createText(t.getAttr("cdata_data"))),t.setAttr({cdata_tag:"",cdata_data:""}));break;case"a":(n=t.getAttr("_href"))&&t.setAttr({href:n,_href:""});break;case"img":(n=t.getAttr("_src"))&&t.setAttr({src:t.getAttr("_src"),_src:""})}}})})},UE.commands.inserthtml={execCommand:function(e,t,n){var i,o,r=this;if(t&&r.fireEvent("beforeinserthtml",t)!==!0){if(i=r.selection.getRange(),o=i.document.createElement("div"),o.style.display="inline",!n){var a=UE.htmlparser(t);r.options.filterRules&&UE.filterNode(a,r.options.filterRules),r.filterInputRule(a),t=a.toHtml()}if(o.innerHTML=v.trim(t),!i.collapsed){var s=i.startContainer;if(w.isFillChar(s)&&i.setStartBefore(s),s=i.endContainer,w.isFillChar(s)&&i.setEndAfter(s),i.txtToElmBoundary(),i.endContainer&&1==i.endContainer.nodeType&&(s=i.endContainer.childNodes[i.endOffset],s&&w.isBr(s)&&i.setEndAfter(s)),0==i.startOffset&&(s=i.startContainer,w.isBoundaryNode(s,"firstChild")&&(s=i.endContainer,i.endOffset==(3==s.nodeType?s.nodeValue.length:s.childNodes.length)&&w.isBoundaryNode(s,"lastChild")&&(r.body.innerHTML="<p>"+(p.ie?"":"<br/>")+"</p>",i.setStart(r.body.firstChild,0).collapse(!0)))),!i.collapsed&&i.deleteContents(),1==i.startContainer.nodeType){var l,d=i.startContainer.childNodes[i.startOffset];if(d&&w.isBlockElm(d)&&(l=d.previousSibling)&&w.isBlockElm(l)){for(i.setEnd(l,l.childNodes.length).collapse();d.firstChild;)l.appendChild(d.firstChild);w.remove(d)}}}var d,c,l,u,f,m=0;i.inFillChar()&&(d=i.startContainer,w.isFillChar(d)?(i.setStartBefore(d).collapse(!0),w.remove(d)):w.isFillChar(d,!0)&&(d.nodeValue=d.nodeValue.replace(E,""),i.startOffset--,i.collapsed&&i.collapse(!0)));var h=w.findParentByTagName(i.startContainer,"li",!0);if(h){for(var g,y;d=o.firstChild;){for(;d&&(3==d.nodeType||!w.isBlockElm(d)||"HR"==d.tagName);)g=d.nextSibling,i.insertNode(d).collapse(),y=d,d=g;if(d)if(/^(ol|ul)$/i.test(d.tagName)){for(;d.firstChild;)y=d.firstChild,w.insertAfter(h,d.firstChild),h=h.nextSibling;w.remove(d)}else{var C;g=d.nextSibling,C=r.document.createElement("li"),w.insertAfter(h,C),C.appendChild(d),y=d,d=g,h=C}}h=w.findParentByTagName(i.startContainer,"li",!0),w.isEmptyBlock(h)&&w.remove(h),y&&i.setStartAfter(y).collapse(!0).select(!0)}else{for(;d=o.firstChild;){if(m){for(var N=r.document.createElement("p");d&&(3==d.nodeType||!b.$block[d.tagName]);)f=d.nextSibling,N.appendChild(d),d=f;N.firstChild&&(d=N)}if(i.insertNode(d),f=d.nextSibling,!m&&d.nodeType==w.NODE_ELEMENT&&w.isBlockElm(d)&&(c=w.findParent(d,function(e){return w.isBlockElm(e)}),c&&"body"!=c.tagName.toLowerCase()&&(!b[c.tagName][d.nodeName]||d.parentNode!==c))){if(b[c.tagName][d.nodeName])for(u=d.parentNode;u!==c;)l=u,u=u.parentNode;else l=c;w.breakParent(d,l||u);var l=d.previousSibling;w.trimWhiteTextNode(l),l.childNodes.length||w.remove(l),!p.ie&&(g=d.nextSibling)&&w.isBlockElm(g)&&g.lastChild&&!w.isBr(g.lastChild)&&g.appendChild(r.document.createElement("br")),m=1}var g=d.nextSibling;if(!o.firstChild&&g&&w.isBlockElm(g)){i.setStart(g,0).collapse(!0);break}i.setEndAfter(d).collapse()}if(d=i.startContainer,f&&w.isBr(f)&&w.remove(f),w.isBlockElm(d)&&w.isEmptyNode(d))if(f=d.nextSibling)w.remove(d),1==f.nodeType&&b.$block[f.tagName]&&i.setStart(f,0).collapse(!0).shrinkBoundary();else try{d.innerHTML=p.ie?w.fillChar:"<br/>"}catch(x){i.setStartBefore(d),w.remove(d)}try{i.select(!0)}catch(x){}}setTimeout(function(){i=r.selection.getRange(),i.scrollToView(r.autoHeightEnabled,r.autoHeightEnabled?w.getXY(r.iframe).y:0),r.fireEvent("afterinserthtml")},200)}}},UE.plugins.autotypeset=function(){function e(e,t){return e&&e.parentNode&&l[e.tagName.toLowerCase()]?o&&o.contains(e)||e.getAttribute("pagebreak")?0:t?!w.isEmptyBlock(e):w.isEmptyBlock(e):void 0}function t(t,i){var l,d=r.selection.getRange(),c=d.createBookmark(!0);if(i){if(!a.pasteFilter)return;l=r.document.createElement("div"),l.innerHTML=i.html}else{var u;if(d.collapsed)l=r.document.body,u=w.getElementsByTagName(l,"*");else{d.txtToElmBoundary();for(var f=d.startContainer,m=d.endContainer,h=w.getNodeIndex("body"==f.tagName.toLowerCase()?f.firstChild:f),p=w.getNodeIndex("body"==m.tagName.toLowerCase()?m.lastChild:m),g=r.document.body.children,v=[],y=h;p>=y;y++)v.push(g[y]);u=v}}for(var b,C=0;b=u[C++];){if(!o&&"DIV"==b.tagName&&b.getAttribute("highlighter")&&(o=b),e(b)){if(a.mergeEmptyline)for(var N,E=b.nextSibling;e(E);)N=E,E=N.nextSibling,w.remove(N);if(a.removeEmptyline&&w.inDoc(b,l)&&!s[b.parentNode.tagName.toLowerCase()]){w.remove(b);continue}}e(b,!0)&&(a.indent&&n(b),a.textAlign&&(b.style.textAlign=a.textAlign))}i&&(i.html=l.innerHTML),d.moveToBookmark(c).select()}function n(e){if(!w.findParent(e,function(e){return 1==e.nodeType&&"li"==e.tagName.toLowerCase()})){for(var t=e.firstChild,n=t;t&&1==t.nodeType&&!b.$empty[t.tagName];)w.isBookmarkNode(t)&&(t=t.nextSibling),n=t,t=t.firstChild;if(!n||1!=n.nodeType||!/img|iframe|br/gi.test(n.tagName)){var o=(n.innerText||n.textContent||n.nodeValue).replace(/(^\u3000*)|(\u3000*$)/g,"").replace(/(^\s*)|(\s*$)/g,"");i(n,o),n.parentNode.insertBefore(e.ownerDocument.createTextNode("\u3000\u3000"),n)}}}function i(e,t){"string"==typeof e.textContent?e.textContent=t:"string"==typeof e.nodeValue?e.nodeValue=t:e.innerText=t}this.setOpt({autotypeset:{mergeEmptyline:!0,indent:!1,indentValue:"2em"}});var o,r=this,a=r.options.autotypeset,s={li:1},l={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1};a&&(r.commands.autotypeset={execCommand:function(){t()}})},UE.commands.imagefloat={execCommand:function(e,t){var n=this,i=n.selection.getRange();if(!i.collapsed){var o=i.getClosedNode();if(o&&"IMG"==o.tagName)switch(t){case"left":case"right":case"none":for(var r,a,s,l=o.parentNode;b.$inline[l.tagName]||"A"==l.tagName;)l=l.parentNode;if(r=l,"P"==r.tagName&&"center"==w.getStyle(r,"text-align")){if(!w.isBody(r)&&1==w.getChildCount(r,function(e){return!w.isBr(e)&&!w.isWhitespace(e)}))if(a=r.previousSibling,s=r.nextSibling,a&&s&&1==a.nodeType&&1==s.nodeType&&a.tagName==s.tagName&&w.isBlockElm(a)){for(a.appendChild(r.firstChild);s.firstChild;)a.appendChild(s.firstChild);w.remove(r),w.remove(s)}else w.setStyle(r,"text-align","");i.selectNode(o).select()}w.setStyle(o,"float","none"==t?"":t),"none"==t&&w.removeAttributes(o,"align");break;case"center":if("center"!=n.queryCommandValue("imagefloat")){for(l=o.parentNode,w.setStyle(o,"float",""),w.removeAttributes(o,"align"),r=o;l&&1==w.getChildCount(l,function(e){return!w.isBr(e)&&!w.isWhitespace(e)})&&(b.$inline[l.tagName]||"A"==l.tagName);)r=l,l=l.parentNode;i.setStartBefore(r).setCursor(!1),l=n.document.createElement("div"),l.appendChild(r),w.setStyle(r,"float",""),n.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+l.innerHTML+"</p>"),r=n.document.getElementById("_img_parent_tmp"),r.removeAttribute("id"),r=r.firstChild,i.selectNode(r).select(),s=r.parentNode.nextSibling,s&&w.isEmptyNode(s)&&w.remove(s)}}}},queryCommandValue:function(){var e,t,n=this.selection.getRange();return n.collapsed?"none":(e=n.getClosedNode(),e&&1==e.nodeType&&"IMG"==e.tagName?(t=e.getAttribute("align")||w.getComputedStyle(e,"float"),"none"==t&&(t="center"==w.getComputedStyle(e.parentNode,"text-align")?"center":t),{left:1,right:1,center:1}[t]?t:"none"):"none")},queryCommandState:function(){var e,t=this.selection.getRange();return t.collapsed?-1:(e=t.getClosedNode(),e&&1==e.nodeType&&"IMG"==e.tagName?0:-1)}},UE.commands.insertimage={execCommand:function(e,t){if(t=v.isArray(t)?t:[t],t.length){var n=this,i=n.selection.getRange(),o=i.getClosedNode();if(o&&/img/i.test(o.tagName)&&"edui-faked-video"!=o.className&&!o.getAttribute("word_img")){var r=t.shift(),a=r.floatStyle;delete r.floatStyle,w.setAttributes(o,r),n.execCommand("imagefloat",a),t.length>0&&(i.setStartAfter(o).setCursor(!1,!0),n.execCommand("insertimage",t))}else{var s,l=[],d="";if(s=t[0],1==t.length)d='<img src="'+s.src+'" '+(s._src?' _src="'+s._src+'" ':"")+(s.width?'width="'+s.width+'" ':"")+(s.height?' height="'+s.height+'" ':"")+("left"==s.floatStyle||"right"==s.floatStyle?' style="float:'+s.floatStyle+';"':"")+(s.title&&""!=s.title?' title="'+s.title+'"':"")+(s.border&&"0"!=s.border?' border="'+s.border+'"':"")+(s.alt&&""!=s.alt?' alt="'+s.alt+'"':"")+(s.hspace&&"0"!=s.hspace?' hspace = "'+s.hspace+'"':"")+(s.vspace&&"0"!=s.vspace?' vspace = "'+s.vspace+'"':"")+"/>","center"==s.floatStyle&&(d='<p style="text-align: center">'+d+"</p>"),l.push(d);else for(var c=0;s=t[c++];)d="<p "+("center"==s.floatStyle?'style="text-align: center" ':"")+'><img src="'+s.src+'" '+(s.width?'width="'+s.width+'" ':"")+(s._src?' _src="'+s._src+'" ':"")+(s.height?' height="'+s.height+'" ':"")+' style="'+(s.floatStyle&&"center"!=s.floatStyle?"float:"+s.floatStyle+";":"")+(s.border||"")+'" '+(s.title?' title="'+s.title+'"':"")+" /></p>",l.push(d);n.execCommand("insertHtml",l.join(""))}}}},UE.plugins.selectall=function(){var e=this;e.commands.selectall={execCommand:function(){var e=this,t=e.body,n=e.selection.getRange();n.selectNodeContents(t),w.isEmptyBlock(t)&&(p.opera&&t.firstChild&&1==t.firstChild.nodeType&&n.setStartAtFirst(t.firstChild),n.collapse(!0)),n.select(!0)},notNeedUndo:1},e.addshortcutkey({selectAll:"ctrl+65"})},UE.plugins.wordcount=function(){var e=this;e.addListener("contentchange",function(){e.fireEvent("wordcount")});var t;e.addListener("ready",function(){var e=this;w.on(e.body,"keyup",function(n){var i=n.keyCode||n.which,o={16:1,18:1,20:1,37:1,38:1,39:1,40:1};i in o||(clearTimeout(t),t=setTimeout(function(){e.fireEvent("wordcount")},200))})})},UE.plugins.undo=function(){function e(e,t){if(e.length!=t.length)return 0;for(var n=0,i=e.length;i>n;n++)if(e[n]!=t[n])return 0;return 1}function t(t,n){return t.collapsed!=n.collapsed?0:e(t.startAddress,n.startAddress)&&e(t.endAddress,n.endAddress)?1:0}function n(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&1==this.list.length)return void this.reset();for(;this.list[this.index].content==this.list[this.index-1].content;)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var e=this.editor,t=this.list[this.index],n=UE.htmlparser(t.content.replace(d,""));e.options.autoClearEmptyNode=!1,e.filterInputRule(n),e.options.autoClearEmptyNode=u,e.document.body.innerHTML=n.toHtml(),e.fireEvent("afterscencerestore"),p.ie&&v.each(w.getElementsByTagName(e.document,"td th caption p"),function(t){w.isEmptyNode(t)&&w.fillNode(e.document,t)});try{var i=new a.Range(e.document).moveToAddress(t.address);i.select(c[i.startContainer.nodeName.toLowerCase()])}catch(o){}this.update(),this.clearKey(),e.fireEvent("reset",!0)},this.getScene=function(){var e=this.editor,t=e.selection.getRange(),n=t.createAddress(!1,!0);e.fireEvent("beforegetscene");var i=UE.htmlparser(e.body.innerHTML,!0);e.options.autoClearEmptyNode=!1,e.filterOutputRule(i),e.options.autoClearEmptyNode=u;var o=i.toHtml();p.ie&&(o=o.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">")),e.fireEvent("aftergetscene");try{}catch(r){}return{address:n,content:o}},this.save=function(e,n){clearTimeout(o);var i=this.getScene(n),r=this.list[this.index];r&&r.content==i.content&&(e?1:t(r.address,i.address))||(this.list=this.list.slice(0,this.index+1),this.list.push(i),this.list.length>s&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){h=0,f=null}}function i(){this.undoManger.save()}var o,r=this,s=r.options.maxUndoCount||20,l=r.options.maxInputCount||20,d=new RegExp(w.fillChar+"|</hr>","gi"),c={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},u=r.options.autoClearEmptyNode;r.undoManger=new n,r.undoManger.editor=r,r.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)}),r.addListener("beforeexeccommand",i),r.addListener("afterexeccommand",i),r.addListener("reset",function(e,t){t||this.undoManger.reset()}),r.commands.redo=r.commands.undo={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+("undo"==e.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var f,m={16:1,17:1,18:1,37:1,38:1,39:1,40:1},h=0,g=!1;r.addListener("ready",function(){w.on(this.body,"compositionstart",function(){g=!0}),w.on(this.body,"compositionend",function(){g=!1})}),r.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var y=!0;r.addListener("keydown",function(e,t){function n(e){e.selection.getRange().collapsed&&e.fireEvent("contentchange"),e.undoManger.save(!1,!0),e.fireEvent("selectionchange")}var i=this,r=t.keyCode||t.which;if(!(m[r]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){if(g)return;if(!i.selection.getRange().collapsed)return i.undoManger.save(!1,!0),void(y=!1);0==i.undoManger.list.length&&i.undoManger.save(!0),clearTimeout(o),o=setTimeout(function(){if(g)var e=setInterval(function(){g||(n(i),clearInterval(e))},300);else n(i)},200),f=r,h++,h>=l&&n(i)}}),r.addListener("keyup",function(e,t){var n=t.keyCode||t.which;if(!(m[n]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){if(g)return;y||(this.undoManger.save(!1,!0),y=!0)}})},UE.plugins.paste=function(){function e(e){var t=this.document;if(!t.getElementById("baidu_pastebin")){var n=this.selection.getRange(),i=n.createBookmark(),o=t.createElement("div");o.id="baidu_pastebin",p.webkit&&o.appendChild(t.createTextNode(w.fillChar+w.fillChar)),t.body.appendChild(o),i.start.style.display="",o.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+w.getXY(i.start).y+"px",n.selectNodeContents(o).select(!0),setTimeout(function(){if(p.webkit)for(var r,a=0,s=t.querySelectorAll("#baidu_pastebin");r=s[a++];){if(!w.isEmptyNode(r)){o=r;break}w.remove(r)}try{o.parentNode.removeChild(o)}catch(l){}n.moveToBookmark(i).select(!0),e(o)},0)}}function t(e){return e.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,n,i){return n=n.toLowerCase(),{img:1}[n]?e:(i=i.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,n){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+n+" ":""}),{span:1,div:1}[n]?"":"<"+t+n+" "+v.trim(i)+">")})}function n(e){var n;if(e.firstChild){for(var s,l=w.getElementsByTagName(e,"span"),d=0;s=l[d++];)("_baidu_cut_start"==s.id||"_baidu_cut_end"==s.id)&&w.remove(s);if(p.webkit){for(var c,u=e.querySelectorAll("div br"),d=0;c=u[d++];){var f=c.parentNode;"DIV"==f.tagName&&1==f.childNodes.length&&(f.innerHTML="<p><br/></p>",w.remove(f))}for(var m,h=e.querySelectorAll("#baidu_pastebin"),d=0;m=h[d++];){var g=a.document.createElement("p");for(m.parentNode.insertBefore(g,m);m.firstChild;)g.appendChild(m.firstChild);w.remove(m)}for(var y,b=e.querySelectorAll("meta"),d=0;y=b[d++];)w.remove(y);var u=e.querySelectorAll("br");for(d=0;y=u[d++];)/^apple-/i.test(y.className)&&w.remove(y)}if(p.gecko){var C=e.querySelectorAll("[_moz_dirty]");for(d=0;y=C[d++];)y.removeAttribute("_moz_dirty")}if(!p.ie)for(var y,N=e.querySelectorAll("span.Apple-style-span"),d=0;y=N[d++];)w.remove(y,!0);n=e.innerHTML,n=UE.filterWord(n);var E=UE.htmlparser(n,!0);if(a.options.filterRules&&UE.filterNode(E,a.options.filterRules),a.filterInputRule(E),p.webkit){var x=E.lastChild();x&&"element"==x.type&&"br"==x.tagName&&E.removeChild(x),v.each(a.body.querySelectorAll("div"),function(e){w.isEmptyBlock(e)&&w.remove(e)})}if(n={html:E.toHtml()},a.fireEvent("beforepaste",n,E),!n.html)return;E=UE.htmlparser(n.html,!0),1===a.queryCommandState("pasteplain")?(o=UE.filterNode(E,a.options.filterTxtRules).toHtml(),a.execCommand("insertHtml",t(o),!0)):(UE.filterNode(E,a.options.filterTxtRules),i=E.toHtml(),o=n.html,r=a.selection.getRange().createAddress(!0),a.execCommand("insertHtml",o,!0)),a.fireEvent("afterpaste",n)}}var i,o,r,a=this;a.addListener("pasteTransfer",function(e,t){if(r&&i&&o&&i!=o){var n=a.selection.getRange();if(n.moveToAddress(r,!0),!n.collapsed){for(;!w.isBody(n.startContainer);){var s=n.startContainer;if(1==s.nodeType){if(s=s.childNodes[n.startOffset],!s){n.setStartBefore(n.startContainer);continue}var l=s.previousSibling;l&&3==l.nodeType&&new RegExp("^[\n\r	 "+w.fillChar+"]*$").test(l.nodeValue)&&n.setStartBefore(l)}if(0!=n.startOffset)break;n.setStartBefore(n.startContainer)}for(;!w.isBody(n.endContainer);){var d=n.endContainer;if(1==d.nodeType){if(d=d.childNodes[n.endOffset],!d){n.setEndAfter(n.endContainer);continue}var c=d.nextSibling;c&&3==c.nodeType&&new RegExp("^[\n\r	"+w.fillChar+"]*$").test(c.nodeValue)&&n.setEndAfter(c)}if(n.endOffset!=n.endContainer.childNodes.length)break;n.setEndAfter(n.endContainer)}}n.deleteContents(),n.select(!0),a.__hasEnterExecCommand=!0;var u=o;2===t?u=u.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,n,i){return n=n.toLowerCase(),{img:1}[n]?e:(i=i.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,n){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+n+" ":""}),{span:1,div:1}[n]?"":"<"+t+n+" "+v.trim(i)+">")}):t&&(u=i),a.execCommand("inserthtml",u,!0),a.__hasEnterExecCommand=!1;var f=a.selection.getRange().createAddress(!0);r.endAddress=f.startAddress}}),a.addListener("ready",function(){w.on(a.body,"cut",function(){var e=a.selection.getRange();!e.collapsed&&a.undoManger&&a.undoManger.save()}),w.on(a.body,p.ie||p.opera?"keydown":"paste",function(t){(!p.ie&&!p.opera||(t.ctrlKey||t.metaKey)&&"86"==t.keyCode)&&e.call(a,function(e){n(e)})})})},UE.plugins.list=function(){function e(e){var t=[];for(var n in e)t.push(n);return t}function t(e){var t=e.className;return w.hasClass(e,/custom_/)?t.match(/custom_(\w+)/)[1]:w.getStyle(e,"list-style-type")}function n(e,n){v.each(w.getElementsByTagName(e,"ol ul"),function(r){if(w.inDoc(r,e)){var a=r.parentNode;if(a.tagName==r.tagName){var s=t(r)||("OL"==r.tagName?"decimal":"disc"),l=t(a)||("OL"==a.tagName?"decimal":"disc");if(s==l){var d=v.indexOf(m[r.tagName],s);d=d+1==m[r.tagName].length?0:d+1,o(r,m[r.tagName][d])}}var c=0,u=2;w.hasClass(r,/custom_/)?/[ou]l/i.test(a.tagName)&&w.hasClass(a,/custom_/)||(u=1):/[ou]l/i.test(a.tagName)&&w.hasClass(a,/custom_/)&&(u=3);var h=w.getStyle(r,"list-style-type");h&&(r.style.cssText="list-style-type:"+h),r.className=v.trim(r.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+u,v.each(w.getElementsByTagName(r,"li"),function(e){if(e.style.cssText&&(e.style.cssText=""),!e.firstChild)return void w.remove(e);if(e.parentNode===r){if(c++,w.hasClass(r,/custom_/)){var n=1,i=t(r);if("OL"==r.tagName){if(i)switch(i){case"cn":case"cn1":case"cn2":c>10&&(c%10==0||c>10&&20>c)?n=2:c>20&&(n=3);break;case"num2":c>9&&(n=2)}e.className="list-"+f[i]+c+" list-"+i+"-paddingleft-"+n}else e.className="list-"+f[i]+" list-"+i+"-paddingleft"}else e.className=e.className.replace(/list-[\w\-]+/gi,"");var o=e.getAttribute("class");null===o||o.replace(/\s/g,"")||w.removeAttributes(e,"class")}}),!n&&i(r,r.tagName.toLowerCase(),t(r)||w.getStyle(r,"list-style-type"),!0)}})}function i(e,i,o,r){var a=e.nextSibling;a&&1==a.nodeType&&a.tagName.toLowerCase()==i&&(t(a)||w.getStyle(a,"list-style-type")||("ol"==i?"decimal":"disc"))==o&&(w.moveChild(a,e),0==a.childNodes.length&&w.remove(a)),a&&w.isFillChar(a)&&w.remove(a);var s=e.previousSibling;s&&1==s.nodeType&&s.tagName.toLowerCase()==i&&(t(s)||w.getStyle(s,"list-style-type")||("ol"==i?"decimal":"disc"))==o&&w.moveChild(e,s),s&&w.isFillChar(s)&&w.remove(s),!r&&w.isEmptyBlock(e)&&w.remove(e),t(e)&&n(e.ownerDocument,!0)}function o(e,t){f[t]&&(e.className="custom_"+t);try{w.setStyle(e,"list-style-type",t)}catch(n){}}function r(e){var t=e.previousSibling;t&&w.isEmptyBlock(t)&&w.remove(t),t=e.nextSibling,t&&w.isEmptyBlock(t)&&w.remove(t)}function a(){null===c&&(c=parseInt(s(d.body).css("lineHeight"),10)+5),d.body.scrollTop&&(d.body.scrollTop+=c)}function l(e){for(;e&&!w.isBody(e);){if("TABLE"==e.nodeName)return null;if("LI"==e.nodeName)return e;e=e.parentNode}}var d=this,c=null,u={TD:1,PRE:1,BLOCKQUOTE:1},f={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};d.setOpt({insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1});var m={OL:e(d.options.insertorderedlist),UL:e(d.options.insertunorderedlist)},h=d.options.listiconpath;for(var g in f)d.options.insertorderedlist.hasOwnProperty(g)||d.options.insertunorderedlist.hasOwnProperty(g)||delete f[g];d.ready(function(){var e=[];for(var t in f){if("dash"==t||"dot"==t)e.push("li.list-"+f[t]+"{background-image:url("+h+f[t]+".gif)}"),e.push("ul.custom_"+t+"{list-style:none;}ul.custom_"+t+" li{background-position:0 3px;background-repeat:no-repeat}");else{for(var n=0;99>n;n++)e.push("li.list-"+f[t]+n+"{background-image:url("+h+"list-"+f[t]+n+".gif)}");e.push("ol.custom_"+t+"{list-style:none;}ol.custom_"+t+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(t){case"cn":e.push("li.list-"+t+"-paddingleft-1{padding-left:25px}"),e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}"),e.push("li.list-"+t+"-paddingleft-3{padding-left:55px}");break;case"cn1":e.push("li.list-"+t+"-paddingleft-1{padding-left:30px}"),e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}"),e.push("li.list-"+t+"-paddingleft-3{padding-left:55px}");break;case"cn2":e.push("li.list-"+t+"-paddingleft-1{padding-left:40px}"),e.push("li.list-"+t+"-paddingleft-2{padding-left:55px}"),e.push("li.list-"+t+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":e.push("li.list-"+t+"-paddingleft-1{padding-left:25px}");break;case"num2":e.push("li.list-"+t+"-paddingleft-1{padding-left:35px}"),e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}");break;case"dash":e.push("li.list-"+t+"-paddingleft{padding-left:35px}");break;case"dot":e.push("li.list-"+t+"-paddingleft{padding-left:20px}")}}e.push(".list-paddingleft-1{padding-left:0}"),e.push(".list-paddingleft-2{padding-left:"+d.options.listDefaultPaddingLeft+"px}"),e.push(".list-paddingleft-3{padding-left:"+2*d.options.listDefaultPaddingLeft+"px}"),v.cssRule("list","ol,ul{margin:0;pading:0;"+(p.ie?"":"width:95%")+"}li{clear:both;}"+e.join("\n"),d.document)}),d.ready(function(){w.on(d.body,"cut",function(){setTimeout(function(){var e,t=d.selection.getRange();
if((e=w.findParentByTagName(t.startContainer,"li",!0))&&!e.nextSibling&&w.isEmptyBlock(e)){var n,i=e.parentNode;if(n=i.previousSibling)w.remove(i),t.setStartAtLast(n).collapse(!0),t.select(!0);else if(n=i.nextSibling)w.remove(i),t.setStartAtFirst(n).collapse(!0),t.select(!0);else{var o=d.document.createElement("p");w.fillNode(d.document,o),i.parentNode.insertBefore(o,i),w.remove(i),t.setStart(o,0).collapse(!0),t.select(!0)}}})})}),d.addListener("beforepaste",function(e,n){var i,o=this,r=o.selection.getRange(),a=UE.htmlparser(n.html,!0);if(i=w.findParentByTagName(r.startContainer,"li",!0)){var s=i.parentNode,l="OL"==s.tagName?"ul":"ol";v.each(a.getNodesByTagName(l),function(n){if(n.tagName=s.tagName,n.setAttr(),n.parentNode===a)e=t(s)||("OL"==s.tagName?"decimal":"disc");else{var i=n.parentNode.getAttr("class");e=i&&/custom_/.test(i)?i.match(/custom_(\w+)/)[1]:n.parentNode.getStyle("list-style-type"),e||(e="OL"==s.tagName?"decimal":"disc")}var o=v.indexOf(m[s.tagName],e);n.parentNode!==a&&(o=o+1==m[s.tagName].length?0:o+1);var r=m[s.tagName][o];f[r]?n.setAttr("class","custom_"+r):n.setStyle("list-style-type",r)})}n.html=a.toHtml()}),d.addInputRule(function(e){function t(e,t){var o=t.firstChild();if(o&&"element"==o.type&&"span"==o.tagName&&/Wingdings|Symbol/.test(o.getStyle("font-family"))){for(var r in i)if(i[r]==o.data)return r;return"disc"}for(var r in n)if(n[r].test(e))return r}v.each(e.getNodesByTagName("li"),function(e){for(var t,n=UE.uNode.createElement("p"),i=0;t=e.children[i];)"text"==t.type||b.p[t.tagName]?n.appendChild(t):n.firstChild()?(e.insertBefore(n,t),n=UE.uNode.createElement("p"),i+=2):i++;(n.firstChild()&&!n.parentNode||!e.firstChild())&&e.appendChild(n)});var n={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},i={square:"n"};v.each(e.getNodesByTagName("p"),function(e){function i(e,t,i){"ol"==e.tagName?t.innerHTML(t.innerHTML().replace(n[i],"")):t.removeChild(t.firstChild());var o=UE.uNode.createElement("li");o.appendChild(t),e.appendChild(o)}if("MsoListParagraph"==e.getAttr("class")){e.setAttr("class","");var o,r=e;if("li"!=e.parentNode.tagName&&(o=t(e.innerText(),e))){var a=UE.uNode.createElement(d.options.insertorderedlist.hasOwnProperty(o)?"ol":"ul");for(f[o]?a.setAttr("class","custom_"+o):a.setStyle("list-style-type",o);e&&"li"!=e.parentNode.tagName&&t(e.innerText(),e);)r=e.nextSibling(),r||e.parentNode.insertBefore(a,e),i(a,e,o),e=r;!a.parentNode&&e&&e.parentNode&&e.parentNode.insertBefore(a,e)}}})}),d.addListener("contentchange",function(){n(d.document)}),d.addListener("keydown",function(e,t){function n(e){t.preventDefault?t.preventDefault():t.returnValue=!1,e&&a(),d.fireEvent("contentchange"),d.undoManger&&d.undoManger.save()}function i(e,t){for(;e&&!w.isBody(e);){if(t(e))return null;if(1==e.nodeType&&/[ou]l/i.test(e.tagName))return e;e=e.parentNode}return null}var o=t.keyCode||t.which;if(13==o&&!t.shiftKey){var s=d.selection.getRange(),l=w.findParent(s.startContainer,function(e){return w.isBlockElm(e)},!0),c=w.findParentByTagName(s.startContainer,"li",!0);if(l&&"PRE"!=l.tagName&&!c){var u=l.innerHTML.replace(new RegExp(w.fillChar,"g"),"");/^\s*1\s*\.[^\d]/.test(u)&&(l.innerHTML=u.replace(/^\s*1\s*\./,""),s.setStartAtLast(l).collapse(!0).select(),d.__hasEnterExecCommand=!0,d.execCommand("insertorderedlist"),d.__hasEnterExecCommand=!1)}var f=d.selection.getRange(),m=i(f.startContainer,function(e){return"TABLE"==e.tagName}),h=f.collapsed?m:i(f.endContainer,function(e){return"TABLE"==e.tagName});if(m&&h&&m===h){if(!f.collapsed){if(m=w.findParentByTagName(f.startContainer,"li",!0),h=w.findParentByTagName(f.endContainer,"li",!0),!m||!h||m!==h){var p=f.cloneRange(),g=p.collapse(!1).createBookmark();f.deleteContents(),p.moveToBookmark(g);var c=w.findParentByTagName(p.startContainer,"li",!0);return r(c),p.select(),void n()}if(f.deleteContents(),c=w.findParentByTagName(f.startContainer,"li",!0),c&&w.isEmptyBlock(c))return x=c.previousSibling,next=c.nextSibling,C=d.document.createElement("p"),w.fillNode(d.document,C),v=c.parentNode,x&&next?(f.setStart(next,0).collapse(!0).select(!0),w.remove(c)):((x||next)&&x?c.parentNode.parentNode.insertBefore(C,v.nextSibling):v.parentNode.insertBefore(C,v),w.remove(c),v.firstChild||w.remove(v),f.setStart(C,0).setCursor()),void n()}if(c=w.findParentByTagName(f.startContainer,"li",!0)){if(w.isEmptyBlock(c)){g=f.createBookmark();var v=c.parentNode;if(c!==v.lastChild?(w.breakParent(c,v),r(c)):(v.parentNode.insertBefore(c,v.nextSibling),w.isEmptyNode(v)&&w.remove(v)),!b.$list[c.parentNode.tagName])if(w.isBlockElm(c.firstChild))w.remove(c,!0);else{for(C=d.document.createElement("p"),c.parentNode.insertBefore(C,c);c.firstChild;)C.appendChild(c.firstChild);w.remove(c)}f.moveToBookmark(g).select()}else{var y=c.firstChild;if(!y||!w.isBlockElm(y)){var C=d.document.createElement("p");for(!c.firstChild&&w.fillNode(d.document,C);c.firstChild;)C.appendChild(c.firstChild);c.appendChild(C),y=C}var N=d.document.createElement("span");f.insertNode(N),w.breakParent(N,c);var E=N.nextSibling;y=E.firstChild,y||(C=d.document.createElement("p"),w.fillNode(d.document,C),E.appendChild(C),y=C),w.isEmptyNode(y)&&(y.innerHTML="",w.fillNode(d.document,y)),f.setStart(y,0).collapse(!0).shrinkBoundary().select(),w.remove(N);var x=E.previousSibling;x&&w.isEmptyBlock(x)&&(x.innerHTML="<p></p>",w.fillNode(d.document,x.firstChild))}n(!0)}}}if(8==o&&(f=d.selection.getRange(),f.collapsed&&w.isStartInblock(f)&&(p=f.cloneRange().trimBoundary(),c=w.findParentByTagName(f.startContainer,"li",!0),c&&w.isStartInblock(p)))){if(m=w.findParentByTagName(f.startContainer,"p",!0),m&&m!==c.firstChild){var v=w.findParentByTagName(m,["ol","ul"]);return w.breakParent(m,v),r(m),d.fireEvent("contentchange"),f.setStart(m,0).setCursor(!1,!0),d.fireEvent("saveScene"),void w.preventDefault(t)}if(c&&(x=c.previousSibling)){if(46==o&&c.childNodes.length)return;if(b.$list[x.tagName]&&(x=x.lastChild),d.undoManger&&d.undoManger.save(),y=c.firstChild,w.isBlockElm(y))if(w.isEmptyNode(y))for(x.appendChild(y),f.setStart(y,0).setCursor(!1,!0);c.firstChild;)x.appendChild(c.firstChild);else N=d.document.createElement("span"),f.insertNode(N),w.isEmptyBlock(x)&&(x.innerHTML=""),w.moveChild(c,x),f.setStartBefore(N).collapse(!0).select(!0),w.remove(N);else if(w.isEmptyNode(c)){var C=d.document.createElement("p");x.appendChild(C),f.setStart(C,0).setCursor()}else for(f.setEnd(x,x.childNodes.length).collapse().select(!0);c.firstChild;)x.appendChild(c.firstChild);return w.remove(c),d.fireEvent("contentchange"),d.fireEvent("saveScene"),void w.preventDefault(t)}if(c&&!c.previousSibling){var v=c.parentNode,g=f.createBookmark();if(w.isTagNode(v.parentNode,"ol ul"))v.parentNode.insertBefore(c,v),w.isEmptyNode(v)&&w.remove(v);else{for(;c.firstChild;)v.parentNode.insertBefore(c.firstChild,v);w.remove(c),w.isEmptyNode(v)&&w.remove(v)}return f.moveToBookmark(g).setCursor(!1,!0),d.fireEvent("contentchange"),d.fireEvent("saveScene"),void w.preventDefault(t)}}}),d.addListener("keyup",function(e,n){var o=n.keyCode||n.which;if(8==o){var r,a=d.selection.getRange();(r=w.findParentByTagName(a.startContainer,["ol","ul"],!0))&&i(r,r.tagName.toLowerCase(),t(r)||w.getComputedStyle(r,"list-style-type"),!0)}}),d.addListener("tabkeydown",function(){function e(e){if(-1!=d.options.maxListLevel){for(var t=e.parentNode,n=0;/[ou]l/i.test(t.tagName);)n++,t=t.parentNode;if(n>=d.options.maxListLevel)return!0}}var n=d.selection.getRange(),r=w.findParentByTagName(n.startContainer,"li",!0);if(r){var a;if(!n.collapsed){d.fireEvent("saveScene"),a=n.createBookmark();for(var s,l,c=0,u=w.findParents(r);l=u[c++];)if(w.isTagNode(l,"ol ul")){s=l;break}var f=r;if(a.end)for(;f&&!(w.getPosition(f,a.end)&w.POSITION_FOLLOWING);)if(e(f))f=w.getNextDomNode(f,!1,null,function(e){return e!==s});else{var h=f.parentNode,p=d.document.createElement(h.tagName),g=v.indexOf(m[p.tagName],t(h)||w.getComputedStyle(h,"list-style-type")),y=g+1==m[p.tagName].length?0:g+1,b=m[p.tagName][y];for(o(p,b),h.insertBefore(p,f);f&&!(w.getPosition(f,a.end)&w.POSITION_FOLLOWING);){if(r=f.nextSibling,p.appendChild(f),!r||w.isTagNode(r,"ol ul")){if(r)for(;(r=r.firstChild)&&"LI"!=r.tagName;);else r=w.getNextDomNode(f,!1,null,function(e){return e!==s});break}f=r}i(p,p.tagName.toLowerCase(),b),f=r}return d.fireEvent("contentchange"),n.moveToBookmark(a).select(),!0}if(e(r))return!0;var h=r.parentNode,p=d.document.createElement(h.tagName),g=v.indexOf(m[p.tagName],t(h)||w.getComputedStyle(h,"list-style-type"));g=g+1==m[p.tagName].length?0:g+1;var b=m[p.tagName][g];if(o(p,b),w.isStartInblock(n))return d.fireEvent("saveScene"),a=n.createBookmark(),h.insertBefore(p,r),p.appendChild(r),i(p,p.tagName.toLowerCase(),b),d.fireEvent("contentchange"),n.moveToBookmark(a).select(!0),!0}}),d.commands.insertorderedlist=d.commands.insertunorderedlist={execCommand:function(e,n){n||(n="insertorderedlist"==e.toLowerCase()?"decimal":"disc");var r=this,a=this.selection.getRange(),s=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!w.isWhitespace(e)},d="insertorderedlist"==e.toLowerCase()?"ol":"ul",c=r.document.createDocumentFragment();a.adjustmentBoundary().shrinkBoundary();var f,m,h,p,g=a.createBookmark(!0),y=l(r.document.getElementById(g.start)),C=0,N=l(r.document.getElementById(g.end)),E=0;if(y||N){if(y&&(f=y.parentNode),g.end||(N=y),N&&(m=N.parentNode),f===m){for(;y!==N;){if(p=y,y=y.nextSibling,!w.isBlockElm(p.firstChild)){for(var x=r.document.createElement("p");p.firstChild;)x.appendChild(p.firstChild);p.appendChild(x)}c.appendChild(p)}if(p=r.document.createElement("span"),f.insertBefore(p,N),!w.isBlockElm(N.firstChild)){for(x=r.document.createElement("p");N.firstChild;)x.appendChild(N.firstChild);N.appendChild(x)}c.appendChild(N),w.breakParent(p,f),w.isEmptyNode(p.previousSibling)&&w.remove(p.previousSibling),w.isEmptyNode(p.nextSibling)&&w.remove(p.nextSibling);var S=t(f)||w.getComputedStyle(f,"list-style-type")||("insertorderedlist"==e.toLowerCase()?"decimal":"disc");if(f.tagName.toLowerCase()==d&&S==n){for(var T,_=0,k=r.document.createDocumentFragment();T=c.childNodes[_++];)if(w.isTagNode(T,"ol ul"))v.each(w.getElementsByTagName(T,"li"),function(e){for(;e.firstChild;)k.appendChild(e.firstChild)});else for(;T.firstChild;)k.appendChild(T.firstChild);p.parentNode.insertBefore(k,p)}else h=r.document.createElement(d),o(h,n),h.appendChild(c),p.parentNode.insertBefore(h,p);return w.remove(p),h&&i(h,d,n),void a.moveToBookmark(g).select()}if(y){for(;y;){if(p=y.nextSibling,w.isTagNode(y,"ol ul"))c.appendChild(y);else{for(var B=r.document.createDocumentFragment(),L=0;y.firstChild;)w.isBlockElm(y.firstChild)&&(L=1),B.appendChild(y.firstChild);if(L)c.appendChild(B);else{var D=r.document.createElement("p");D.appendChild(B),c.appendChild(D)}w.remove(y)}y=p}f.parentNode.insertBefore(c,f.nextSibling),w.isEmptyNode(f)?(a.setStartBefore(f),w.remove(f)):a.setStartAfter(f),C=1}if(N&&w.inDoc(m,r.document)){for(y=m.firstChild;y&&y!==N;){if(p=y.nextSibling,w.isTagNode(y,"ol ul"))c.appendChild(y);else{for(B=r.document.createDocumentFragment(),L=0;y.firstChild;)w.isBlockElm(y.firstChild)&&(L=1),B.appendChild(y.firstChild);L?c.appendChild(B):(D=r.document.createElement("p"),D.appendChild(B),c.appendChild(D)),w.remove(y)}y=p}var A=w.createElement(r.document,"div",{tmpDiv:1});w.moveChild(N,A),c.appendChild(A),w.remove(N),m.parentNode.insertBefore(c,m),a.setEndBefore(m),w.isEmptyNode(m)&&w.remove(m),E=1}}C||a.setStartBefore(r.document.getElementById(g.start)),g.end&&!E&&a.setEndAfter(r.document.getElementById(g.end)),a.enlarge(!0,function(e){return u[e.tagName]}),c=r.document.createDocumentFragment();for(var R,I=a.createBookmark(),O=w.getNextDomNode(I.start,!1,s),U=a.cloneRange(),H=w.isBlockElm;O&&O!==I.end&&w.getPosition(O,I.end)&w.POSITION_PRECEDING;)if(3==O.nodeType||b.li[O.tagName]){if(1==O.nodeType&&b.$list[O.tagName]){for(;O.firstChild;)c.appendChild(O.firstChild);R=w.getNextDomNode(O,!1,s),w.remove(O),O=R;continue}for(R=O,U.setStartBefore(O);O&&O!==I.end&&(!H(O)||w.isBookmarkNode(O));)R=O,O=w.getNextDomNode(O,!1,null,function(e){return!u[e.tagName]});O&&H(O)&&(O.style.textIndent&&(O.style.textIndent=""),p=w.getNextDomNode(R,!1,s),p&&w.isBookmarkNode(p)&&(O=w.getNextDomNode(p,!1,s),R=p)),U.setEndAfter(R),O=w.getNextDomNode(R,!1,s);var P=a.document.createElement("li");if(P.appendChild(U.extractContents()),w.isEmptyNode(P)){for(var R=a.document.createElement("p");P.firstChild;)R.appendChild(P.firstChild);P.appendChild(R)}c.appendChild(P)}else O=w.getNextDomNode(O,!0,s);a.moveToBookmark(I).collapse(!0),h=r.document.createElement(d),o(h,n),h.appendChild(c),a.insertNode(h),i(h,d,n);for(var T,_=0,M=w.getElementsByTagName(h,"div");T=M[_++];)T.getAttribute("tmpDiv")&&w.remove(T,!0);a.moveToBookmark(g).select()},queryCommandState:function(e){for(var t,n="insertorderedlist"==e.toLowerCase()?"ol":"ul",i=this.selection.getStartElementPath(),o=0;t=i[o++];){if("TABLE"==t.nodeName)return 0;if(n==t.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(e){for(var n,i,o="insertorderedlist"==e.toLowerCase()?"ol":"ul",r=this.selection.getStartElementPath(),a=0;i=r[a++];){if("TABLE"==i.nodeName){n=null;break}if(o==i.nodeName.toLowerCase()){n=i;break}}return n?t(n)||w.getComputedStyle(n,"list-style-type"):null}}},UE.plugins.attachLoader=function(){function e(e,t){UE.utils.loadFile(document,{src:e,tag:"script",type:"text/javascript",defer:"defer"},function(){i++,t&&t()})}function t(){1===i&&(UE.AttachResourceReady=!0,n.fireEvent("attachresourceready"))}var n=this,i=0;this.addListener("ready",function(){n.options.wangpanLoaderJs&&e(n.options.wangpanLoaderJs,t)})},UE.plugins.enterkey=function(){var e,t=this,n=t.options.enterTag;t.addListener("keyup",function(n,i){var o=i.keyCode||i.which;if(13==o){var r,a=t.selection.getRange(),s=a.startContainer;if(p.ie)t.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(e)){if(p.gecko){var l=w.findParentByTagName(s,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);l||(t.document.execCommand("formatBlock",!1,"<p>"),r=1)}else if(1==s.nodeType){var d,c=t.document.createTextNode("");if(a.insertNode(c),d=w.findParentByTagName(c,"div",!0)){for(var u=t.document.createElement("p");d.firstChild;)u.appendChild(d.firstChild);d.parentNode.insertBefore(u,d),w.remove(d),a.setStartBefore(c).setCursor(),r=1}w.remove(c)}t.undoManger&&r&&t.undoManger.save()}p.opera&&a.select()}}}),t.addListener("keydown",function(i,o){var r=o.keyCode||o.which;if(13==r){if(t.fireEvent("beforeenterkeydown"))return void w.preventDefault(o);t.fireEvent("saveScene",!0,!0),e="";var a=t.selection.getRange();if(!a.collapsed){var s=a.startContainer,l=a.endContainer,d=w.findParentByTagName(s,"td",!0),c=w.findParentByTagName(l,"td",!0);if(d&&c&&d!==c||!d&&c||d&&!c)return void(o.preventDefault?o.preventDefault():o.returnValue=!1)}if("p"==n)p.ie||(s=w.findParentByTagName(a.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),s||p.opera?(e=s.tagName,"p"==s.tagName.toLowerCase()&&p.gecko&&w.removeDirtyAttr(s)):(t.document.execCommand("formatBlock",!1,"<p>"),p.gecko&&(a=t.selection.getRange(),s=w.findParentByTagName(a.startContainer,"p",!0),s&&w.removeDirtyAttr(s))));else if(o.preventDefault?o.preventDefault():o.returnValue=!1,a.collapsed){f=a.document.createElement("br"),a.insertNode(f);var u=f.parentNode;u.lastChild===f?(f.parentNode.insertBefore(f.cloneNode(!0),f),a.setStartBefore(f)):a.setStartAfter(f),a.setCursor()}else if(a.deleteContents(),s=a.startContainer,1==s.nodeType&&(s=s.childNodes[a.startOffset])){for(;1==s.nodeType;){if(b.$empty[s.tagName])return a.setStartBefore(s).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!s.firstChild){var f=a.document.createElement("br");return s.appendChild(f),a.setStart(s,0).setCursor(),t.undoManger&&t.undoManger.save(),!1}s=s.firstChild}s===a.startContainer.childNodes[a.startOffset]?(f=a.document.createElement("br"),a.insertNode(f).setCursor()):a.setStart(s,0).setCursor()}else f=a.document.createElement("br"),a.insertNode(f).setStartAfter(f).setCursor()}})},UE.plugins.keystrokes=function(){var e=this,t=!0,n=null;e.addListener("keydown",function(i,o){var r=o.keyCode||o.which,a=e.selection.getRange();if(!a.collapsed&&!(o.ctrlKey||o.shiftKey||o.altKey||o.metaKey)&&(r>=65&&90>=r||r>=48&&57>=r||r>=96&&111>=r||{13:1,8:1,46:1}[r])){var s=a.startContainer;if(w.isFillChar(s)&&a.setStartBefore(s),s=a.endContainer,w.isFillChar(s)&&a.setEndAfter(s),a.txtToElmBoundary(),a.endContainer&&1==a.endContainer.nodeType&&(s=a.endContainer.childNodes[a.endOffset],s&&w.isBr(s)&&a.setEndAfter(s)),0==a.startOffset&&(s=a.startContainer,w.isBoundaryNode(s,"firstChild")&&(s=a.endContainer,a.endOffset==(3==s.nodeType?s.nodeValue.length:s.childNodes.length)&&w.isBoundaryNode(s,"lastChild"))))return e.fireEvent("saveScene"),e.body.innerHTML="<p>"+(p.ie?"":"<br/>")+"</p>",a.setStart(e.body.firstChild,0).setCursor(!1,!0),void e._selectionChange()}if(8==r){a=e.selection.getRange(),t=a.collapsed;var l,d;if(a.collapsed&&a.inFillChar()&&(l=a.startContainer,w.isFillChar(l)?(a.setStartBefore(l).shrinkBoundary(!0).collapse(!0),w.remove(l)):(l.nodeValue=l.nodeValue.replace(new RegExp("^"+w.fillChar),""),a.startOffset--,a.collapse(!0).select(!0))),l=a.getClosedNode())return e.fireEvent("saveScene"),a.setStartBefore(l),w.remove(l),a.setCursor(),e.fireEvent("saveScene"),void w.preventDefault(o);if(!p.ie&&(l=w.findParentByTagName(a.startContainer,"table",!0),d=w.findParentByTagName(a.endContainer,"table",!0),l&&!d||!l&&d||l!==d))return void o.preventDefault();l=a.startContainer;var c=w.findParentByTagName(l,"pre",!0);c&&w.isEmptyNode(c)&&w.remove(c),l=a.startContainer;var u=w.findParentByTagName(l,"p",!0);c=u&&u.previousSibling,c&&"pre"===c.tagName.toLowerCase()&&(n=c)}if(9==r){var f={ol:1,ul:1,table:1};if(e.fireEvent("tabkeydown",o))return void w.preventDefault(o);var m=e.selection.getRange();e.fireEvent("saveScene");for(var h=0,g="",v=e.options.tabSize||4,y=e.options.tabNode||"&nbsp;";v>h;h++)g+=y;var b=e.document.createElement("span");if(b.innerHTML=g+w.fillChar,m.collapsed)m.insertNode(b.cloneNode(!0).firstChild).setCursor(!0);else if(l=w.findParent(m.startContainer,N),d=w.findParent(m.endContainer,N),l&&d&&l===d)m.deleteContents(),m.insertNode(b.cloneNode(!0).firstChild).setCursor(!0);else{var C=m.createBookmark(),N=function(e){return w.isBlockElm(e)&&!f[e.tagName.toLowerCase()]};m.enlarge(!0);for(var E=m.createBookmark(),x=w.getNextDomNode(E.start,!1,N);x&&!(w.getPosition(x,E.end)&w.POSITION_FOLLOWING);)x.insertBefore(b.cloneNode(!0).firstChild,x.firstChild),x=w.getNextDomNode(x,!1,N);m.moveToBookmark(E).moveToBookmark(C).select()}w.preventDefault(o)}if(p.gecko&&46==r&&(m=e.selection.getRange(),m.collapsed&&(l=m.startContainer,w.isEmptyBlock(l)))){for(var S=l.parentNode;1==w.getChildCount(S)&&!w.isBody(S);)l=S,S=S.parentNode;return void(l===S.lastChild&&o.preventDefault())}}),e.addListener("keyup",function(e,i){var o,r=i.keyCode||i.which,a=this;if(8==r){if(n&&n.parentNode){if(!n.nextSibling||"p"!==n.nextSibling.tagName.toLowerCase()){var s=document.createElement("p");s.innerHTML=w.fillChar+"<br>",w.insertAfter(n,s)}n=null}if(a.fireEvent("delkeyup"))return;if(o=a.selection.getRange(),o.collapsed){var l,d=["h1","h2","h3","h4","h5","h6"];if((l=w.findParentByTagName(o.startContainer,d,!0))&&w.isEmptyBlock(l)){var c=l.previousSibling;if(c&&"TABLE"!=c.nodeName)return w.remove(l),void o.setStartAtLast(c).setCursor(!1,!0);var u=l.nextSibling;if(u&&"TABLE"!=u.nodeName)return w.remove(l),void o.setStartAtFirst(u).setCursor(!1,!0)}if(w.isBody(o.startContainer)){var l=w.createElement(a.document,"p",{innerHTML:p.ie?w.fillChar:"<br/>"});o.insertNode(l).setStart(l,0).setCursor(!1,!0)}}if(!t&&(3==o.startContainer.nodeType||1==o.startContainer.nodeType&&w.isEmptyBlock(o.startContainer)))if(p.ie){var f=o.document.createElement("span");o.insertNode(f).setStartBefore(f).collapse(!0),o.select(),w.remove(f)}else o.select()}})},UE.plugins.fiximgclick=function(){try{var e=this;p.webkit&&e.addListener("click",function(t,n){try{if("IMG"==n.target.tagName){var i=new a.Range(e.document);i.selectNode(n.target).select()}}catch(n){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:9170})}})}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:9172})}},UE.plugins.pasteplain=function(){var e=this;e.setOpt({pasteplain:!1,filterTxtRules:function(){function e(e){e.tagName="p",e.setStyle()}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(e){for(var t,n=UE.uNode.createElement("p");t=e.firstChild();)"text"!=t.type&&UE.dom.dtd.$block[t.tagName]?n.firstChild()?(e.parentNode.insertBefore(n,e),n=UE.uNode.createElement("p")):e.parentNode.insertBefore(t,e):n.appendChild(t);n.firstChild()&&e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)},ol:function(e){e.parentNode.removeChild(e,!0)},ul:function(e){e.parentNode.removeChild(e,!0)},dl:function(e){e.parentNode.removeChild(e,!0)},dt:function(e){e.parentNode.removeChild(e,!0)},dd:function(e){e.parentNode.removeChild(e,!0)},li:function(e){e.parentNode.removeChild(e,!0)},caption:e,th:e,tr:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,td:function(e){var t=!!e.innerText();t&&e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e),e.parentNode.removeChild(e,e.innerText())}}}()});var t=e.options.pasteplain;e.commands.pasteplain={queryCommandState:function(){return t?1:0},execCommand:function(){t=0|!t},notNeedUndo:1}},UE.plugins.autoupload=function(){function e(e,t){var n,i,o,r,a,s,l=t,d=/image\/\w+/i.test(e.type)?"image":"file",c="loading_"+(+new Date).toString(36);if(n=l.options[d+"FieldName"],i=1024*l.options[d+"MaxSize"]*1024,o=l.options.imageUrl,a=function(e){var t=l.document.getElementById(c);t&&w.remove(t),l.fireEvent("showmessage",{id:c,content:e,type:"error",timeout:4e3})},"image"==d){r='<img style="max-width:100%;" class="loadingclass" id="'+c+'" src="javascript:;">',s=function(e){var t=e.url,n=l.document.getElementById(c);n&&setTimeout(function(){w.removeClasses(n,"loadingclass"),n.setAttribute("src",t),n.setAttribute("_src",t),n.removeAttribute("id"),n.onload=function(){n.removeAttribute("style")},l.trigger("contentchange",n)},1e3)},l.execCommand("inserthtml",r);var u=new FileReader;if(u.onload=function(e){var t=l.document.getElementById(c);t.setAttribute("src",e.target.result)},u.readAsDataURL(e),e.size>i)return void a(l.getLang("autoupload.exceedSizeError"));var f=new XMLHttpRequest,m=new FormData;m.append(n,e,e.name||"blob."+e.type.substr("image/".length)),m.append("type","ajax");for(var h in l.options.customObj)m.append(h,l.options.customObj[h]);f.open("post",o,!0),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.addEventListener("load",function(e){try{var t=new Function("return "+v.trim(e.target.response))();"0"==t.errorNo&&t.url?s(t):a(t.state)}catch(n){a(l.getLang("autoupload.loadError"))}}),f.send(m)}}function t(e){return e.clipboardData&&e.clipboardData.items&&1==e.clipboardData.items.length&&/^image\//.test(e.clipboardData.items[0].type)?e.clipboardData.items:null}function n(e){return e.dataTransfer&&e.dataTransfer.files?e.dataTransfer.files:null}var i=this;i.addListener("ready",function(){if(window.FormData&&window.FileReader){var o=function(o){var r,a=!1;if(r="paste"==o.type?t(o):n(o)){for(var s,l=r.length;l--;)s=r[l],s.getAsFile&&(s=s.getAsFile()),s&&s.size>0&&(e(s,i),a=!0);a&&o.preventDefault()}};i.options.enablePasteUpload!==!1&&w.on(i.body,"paste",o),i.options.enableDragUpload!==!1?(w.on(i.body,"drop",o),w.on(i.body,"dragover",function(e){"Files"==e.dataTransfer.types[0]&&e.preventDefault()})):p.gecko&&w.on(i.body,"drop",function(e){n(e)&&e.preventDefault()})}})},UE.plugins.insertcode=function(){var e=this;e.ready(function(){v.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;line-height:1.5}",e.document)}),e.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"}),e.commands.insertcode={execCommand:function(e,t){var n=this,i=n.selection.getRange(),o=w.findParentByTagName(i.startContainer,"pre",!0);if(o)o.className="brush:"+t+";toolbar:false;";else{var r="";if(i.collapsed)r=p.ie?p.version>8?"":"&nbsp;":"<br/>";else{var a=i.extractContents(),s=n.document.createElement("div");s.appendChild(a),v.each(UE.filterNode(UE.htmlparser(s.innerHTML.replace(/[\r\t]/g,"")),n.options.filterTxtRules).children,function(e){if(p.ie&&p.version>8)"element"==e.type?"br"==e.tagName?r+="\n":b.$empty[e.tagName]||(v.each(e.children,function(t){"element"==t.type?"br"==t.tagName?r+="\n":b.$empty[e.tagName]||(r+=t.innerText()):r+=t.data}),/\n$/.test(r)||(r+="\n")):r+=e.data+"\n",!e.nextSibling()&&/\n$/.test(r)&&(r=r.replace(/\n$/,""));else if(p.ie)"element"==e.type?"br"==e.tagName?r+="<br>":b.$empty[e.tagName]||(v.each(e.children,function(t){"element"==t.type?"br"==t.tagName?r+="<br>":b.$empty[e.tagName]||(r+=t.innerText()):r+=t.data}),/br>$/.test(r)||(r+="<br>")):r+=e.data+"<br>",!e.nextSibling()&&/<br>$/.test(r)&&(r=r.replace(/<br>$/,""));else if(r+="element"==e.type?b.$empty[e.tagName]?"":e.innerText():e.data,!/br\/?\s*>$/.test(r)){if(!e.nextSibling())return;r+="<br>"}})}n.execCommand("inserthtml",'<pre id="coder"class="brush:'+t+';toolbar:false">'+r+"</pre>",!0),o=n.document.getElementById("coder"),w.removeAttributes(o,"id");var l=o.previousSibling;l&&w.isEmptyBlock(l)&&w.remove(l);var i=n.selection.getRange();w.isEmptyBlock(o)?i.setStart(o,0).setCursor(!1,!0):i.selectNodeContents(o).select()}},queryCommandValue:function(){var e=this.selection.getStartElementPath(),t="";return v.each(e,function(e){if("PRE"==e.nodeName){var n=e.className.match(/brush:([^;]+)/);return t=n&&n[1]?n[1]:"",!1}}),t}},e.addInputRule(function(e){v.each(e.getNodesByTagName("pre"),function(e){var t=e.getNodesByTagName("br");if(t.length)return void(p.ie&&p.version>8&&v.each(t,function(e){var t=UE.uNode.createText("\n");e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e)}));if(!(p.ie&&p.version>8)){var n=e.innerText().split(/\n/);e.innerHTML(""),v.each(n,function(t){t.length&&e.appendChild(UE.uNode.createText(t)),e.appendChild(UE.uNode.createElement("br"))})}})}),e.addOutputRule(function(e){v.each(e.getNodesByTagName("pre"),function(e){var t="";v.each(e.children,function(e){t+="text"==e.type?e.data.replace(/[ ]/g,"&nbsp;"):"\n"}),e.innerText(t.replace(/(&nbsp;|\n)+$/,""))})}),e.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,highlightcode:1,insertcode:1,inserthtml:1,selectall:1};e.queryCommandState;e.queryCommandState=function(e){var t=this;return!t.notNeedCodeQuery[e.toLowerCase()]&&t.selection&&t.queryCommandValue("insertcode")?-1:UE.Editor.prototype.queryCommandState.apply(this,arguments)},e.addListener("beforeenterkeydown",function(){var t=e.selection.getRange(),n=w.findParentByTagName(t.startContainer,"pre",!0);if(n){if(e.fireEvent("saveScene"),t.collapsed||t.deleteContents(),p.ie)if(p.version>8){var i=e.document.createTextNode("\n"),o=t.startContainer;if(0==t.startOffset){var r=o.previousSibling;if(r){t.insertNode(i);var a=e.document.createTextNode(" ");t.setStartAfter(i).insertNode(a).setStart(a,0).collapse(!0).select(!0)}}else{t.insertNode(i).setStartAfter(i);var a=e.document.createTextNode(" ");o=t.startContainer.childNodes[t.startOffset],o&&!/^\n/.test(o.nodeValue)&&t.setStartBefore(i),t.insertNode(a).setStart(a,0).collapse(!0).select(!0)}}else{var s=e.document.createElement("br");t.insertNode(s),t.insertNode(e.document.createTextNode(w.fillChar)),t.setStartAfter(s),n=s.previousSibling;for(var l;n;)if(l=n,n=n.previousSibling,!n||"BR"==n.nodeName){n=l;break}if(n){for(var d="";n&&"BR"!=n.nodeName&&new RegExp("^[ "+w.fillChar+"]*$").test(n.nodeValue);)d+=n.nodeValue,n=n.nextSibling;if("BR"!=n.nodeName){var c=n.nodeValue.match(new RegExp("^([ "+w.fillChar+"]+)"));c&&c[1]&&(d+=c[1])}d=e.document.createTextNode(d),t.insertNode(d).setStartAfter(d)}t.collapse(!0).select()}else{var n,s=e.document.createElement("br");t.insertNode(s).setStartAfter(s).collapse(!0);var u=s.nextSibling;u?t.setStartAfter(s):t.insertNode(s.cloneNode(!1)),n=s.previousSibling;for(var l;n;)if(l=n,n=n.previousSibling,!n||"BR"==n.nodeName){n=l;break}if(n){for(var d="";n&&"BR"!=n.nodeName&&new RegExp("^[\\s"+w.fillChar+"]*$").test(n.nodeValue);)d+=n.nodeValue,n=n.nextSibling;if("BR"!=n.nodeName){var c=n.nodeValue.match(new RegExp("^([\\s"+w.fillChar+"]+)"));c&&c[1]&&(d+=c[1])}d&&(d=e.document.createTextNode(d),t.insertNode(d).setStartAfter(d))}t.collapse(!0).select(!0)}return e.fireEvent("saveScene"),!0}}),e.addListener("tabkeydown",function(t,n){var i=e.selection.getRange(),o=w.findParentByTagName(i.startContainer,"pre",!0);if(o){if(e.fireEvent("saveScene"),n.shiftKey);else if(i.collapsed){var r=e.document.createTextNode("    ");i.insertNode(r).setStartAfter(r).collapse(!0).select(!0)}else{for(var a=i.createBookmark(),s=a.start.previousSibling;s;){if(o.firstChild===s&&!w.isBr(s)){o.insertBefore(e.document.createTextNode("    "),s);break}if(w.isBr(s)){o.insertBefore(e.document.createTextNode("    "),s.nextSibling);break}s=s.previousSibling}var l=a.end;for(s=a.start.nextSibling,o.firstChild===a.start&&o.insertBefore(e.document.createTextNode("    "),s.nextSibling);s&&s!==l;){if(w.isBr(s)&&s.nextSibling){if(s.nextSibling===l)break;o.insertBefore(e.document.createTextNode("    "),s.nextSibling)}s=s.nextSibling}i.moveToBookmark(a).select()}return e.fireEvent("saveScene"),!0}}),e.addListener("beforeinserthtml",function(e,t){var n=this,i=n.selection.getRange(),o=w.findParentByTagName(i.startContainer,"pre",!0);if(o){i.collapsed||i.deleteContents();var r="";if(p.ie&&p.version>8){v.each(UE.filterNode(UE.htmlparser(t),n.options.filterTxtRules).children,function(e){"element"==e.type?"br"==e.tagName?r+="\n":b.$empty[e.tagName]||(v.each(e.children,function(t){"element"==t.type?"br"==t.tagName?r+="\n":b.$empty[e.tagName]||(r+=t.innerText()):r+=t.data}),/\n$/.test(r)||(r+="\n")):r+=e.data+"\n",!e.nextSibling()&&/\n$/.test(r)&&(r=r.replace(/\n$/,""))});var a=n.document.createTextNode(v.html(r.replace(/&nbsp;/g," ")));i.insertNode(a).selectNode(a).select()}else{var s=n.document.createDocumentFragment();v.each(UE.filterNode(UE.htmlparser(t),n.options.filterTxtRules).children,function(e){"element"==e.type?"br"==e.tagName?s.appendChild(n.document.createElement("br")):b.$empty[e.tagName]||(v.each(e.children,function(t){"element"==t.type?"br"==t.tagName?s.appendChild(n.document.createElement("br")):b.$empty[e.tagName]||s.appendChild(n.document.createTextNode(v.html(t.innerText().replace(/&nbsp;/g," ")))):s.appendChild(n.document.createTextNode(v.html(t.data.replace(/&nbsp;/g," "))))}),"BR"!=s.lastChild.nodeName&&s.appendChild(n.document.createElement("br"))):s.appendChild(n.document.createTextNode(v.html(e.data.replace(/&nbsp;/g," ")))),e.nextSibling()||"BR"!=s.lastChild.nodeName||s.removeChild(s.lastChild)}),i.insertNode(s).select()}return!0}}),e.addListener("keydown",function(e,t){var n=this,i=t.keyCode||t.which;if(40==i){var o,r=n.selection.getRange(),a=r.startContainer;if(r.collapsed&&(o=w.findParentByTagName(r.startContainer,"pre",!0))&&!o.nextSibling){for(var s=o.lastChild;s&&"BR"==s.nodeName;)s=s.previousSibling;(s===a||r.startContainer===o&&r.startOffset==o.childNodes.length)&&(n.execCommand("insertparagraph"),w.preventDefault(t))}}})},UE.plugins.paragraph=function(){var e=this,t=w.isBlockElm,n=["TD","LI","PRE"],i=function(e,i,o,r){var a,s=e.createBookmark(),l=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase()&&!w.isBookmarkNode(e):!w.isWhitespace(e)
};e.enlarge(!0);for(var d,c=e.createBookmark(),u=w.getNextDomNode(c.start,!1,l),f=e.cloneRange();u&&!(w.getPosition(u,c.end)&w.POSITION_FOLLOWING);)if(3!=u.nodeType&&t(u))u=w.getNextDomNode(u,!0,l);else{for(f.setStartBefore(u);u&&u!==c.end&&!t(u);)d=u,u=w.getNextDomNode(u,!1,null,function(e){return!t(e)});f.setEndAfter(d),a=e.document.createElement(i),o&&(w.setAttributes(a,o),r&&"customstyle"==r&&o.style&&(a.style.cssText=o.style)),a.appendChild(f.extractContents()),w.isEmptyNode(a)&&w.fillChar(e.document,a),f.insertNode(a);var m=a.parentNode;t(m)&&!w.isBody(a.parentNode)&&-1==v.indexOf(n,m.tagName)&&(r&&"customstyle"==r||(m.getAttribute("dir")&&a.setAttribute("dir",m.getAttribute("dir")),m.style.cssText&&(a.style.cssText=m.style.cssText+";"+a.style.cssText),m.style.textAlign&&!a.style.textAlign&&(a.style.textAlign=m.style.textAlign),m.style.textIndent&&!a.style.textIndent&&(a.style.textIndent=m.style.textIndent),m.style.padding&&!a.style.padding&&(a.style.padding=m.style.padding)),o&&/h\d/i.test(m.tagName)&&!/h\d/i.test(a.tagName)?(w.setAttributes(m,o),r&&"customstyle"==r&&o.style&&(m.style.cssText=o.style),w.remove(a,!0),a=m):w.remove(a.parentNode,!0)),u=-1!=v.indexOf(n,m.tagName)?m:a,u=w.getNextDomNode(u,!1,l)}return e.moveToBookmark(c).moveToBookmark(s)};e.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),e.commands.paragraph={execCommand:function(e,t,n,o){var r=this.selection.getRange();if(r.collapsed){var a=this.document.createTextNode("p");if(r.insertNode(a),p.ie){var s=a.previousSibling;s&&w.isWhitespace(s)&&w.remove(s),s=a.nextSibling,s&&w.isWhitespace(s)&&w.remove(s)}}if(r=i(r,t,n,o),a&&(r.setStartBefore(a).collapse(!0),pN=a.parentNode,w.remove(a),w.isBlockElm(pN)&&w.isEmptyNode(pN)&&w.fillNode(this.document,pN)),p.gecko&&r.collapsed&&1==r.startContainer.nodeType){var l=r.startContainer.childNodes[r.startOffset];l&&1==l.nodeType&&l.tagName.toLowerCase()==t&&r.setStart(l,0).collapse(!0)}return r.select(),!0},queryCommandValue:function(){var e=w.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e?e.tagName.toLowerCase():""}}},UE.plugins.blockquote=function(){function e(e){return w.filterNodeList(e.selection.getStartElementPath(),"blockquote")}var t=this;t.commands.blockquote={execCommand:function(t,n){var i=this.selection.getRange(),o=e(this),r=b.blockquote,a=i.createBookmark();if(o){var s=i.startContainer,l=w.isBlockElm(s)?s:w.findParent(s,function(e){return w.isBlockElm(e)}),d=i.endContainer,c=w.isBlockElm(d)?d:w.findParent(d,function(e){return w.isBlockElm(e)});l=w.findParentByTagName(l,"li",!0)||l,c=w.findParentByTagName(c,"li",!0)||c,"LI"==l.tagName||"TD"==l.tagName||l===o||w.isBody(l)?w.remove(o,!0):w.breakParent(l,o),l!==c&&(o=w.findParentByTagName(c,"blockquote"),o&&("LI"==c.tagName||"TD"==c.tagName||w.isBody(c)?o.parentNode&&w.remove(o,!0):w.breakParent(c,o)));for(var u,f=w.getElementsByTagName(this.document,"blockquote"),m=0;u=f[m++];)u.childNodes.length?w.getPosition(u,l)&w.POSITION_FOLLOWING&&w.getPosition(u,c)&w.POSITION_PRECEDING&&w.remove(u,!0):w.remove(u)}else{for(var h=i.cloneRange(),p=1==h.startContainer.nodeType?h.startContainer:h.startContainer.parentNode,g=p,v=1;;){if(w.isBody(p)){g!==p?i.collapsed?(h.selectNode(g),v=0):h.setStartBefore(g):h.setStart(p,0);break}if(!r[p.tagName]){i.collapsed?h.selectNode(g):h.setStartBefore(g);break}g=p,p=p.parentNode}if(v)for(g=p=p=1==h.endContainer.nodeType?h.endContainer:h.endContainer.parentNode;;){if(w.isBody(p)){g!==p?h.setEndAfter(g):h.setEnd(p,p.childNodes.length);break}if(!r[p.tagName]){h.setEndAfter(g);break}g=p,p=p.parentNode}p=i.document.createElement("blockquote"),w.setAttributes(p,n),p.appendChild(h.extractContents()),h.insertNode(p);for(var y,C=w.getElementsByTagName(p,"blockquote"),m=0;y=C[m++];)y.parentNode&&w.remove(y,!0)}i.moveToBookmark(a).select()},queryCommandState:function(){return e(this)?1:0}}};var r=r||{};r.editor=r.editor||{},r.editor.ui={},function(){function e(){var e=document.getElementById("edui_fixedlayer");d.setViewportOffset(e,{left:0,top:0})}function t(){i.on(window,"scroll",e),i.on(window,"resize",r.editor.utils.defer(e,0,!0))}var n=r.editor.browser,i=r.editor.dom.domUtils,o="$EDITORUI",a=window[o]={},s="ID"+o,l=0,d=r.editor.ui.uiUtils={uid:function(e){return e?e[s]||(e[s]=++l):++l},hook:function(e,t){var n;return e&&e._callbacks?n=e:(n=function(){var t;e&&(t=e.apply(this,arguments));for(var i=n._callbacks,o=i.length;o--;){var r=i[o].apply(this,arguments);void 0===t&&(t=r)}return t},n._callbacks=[]),n._callbacks.push(t),n},createElementByHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return n.ie&&n.quirks?document.body:document.documentElement},getClientRect:function(e){var t;try{t=e.getBoundingClientRect()}catch(n){t={left:0,top:0,height:0,width:0}}for(var o,r={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(o=e.ownerDocument)!==document&&(e=i.getWindow(o).frameElement);)t=e.getBoundingClientRect(),r.left+=t.left,r.top+=t.top;return r.bottom=r.top+r.height,r.right=r.left+r.width,r},getViewportRect:function(){var e=d.getViewportElement(),t=0|(window.innerWidth||e.clientWidth),n=0|(window.innerHeight||e.clientHeight);return{left:0,top:0,height:n,width:t,bottom:n,right:t}},setViewportOffset:function(e,t){var n=d.getFixedLayer();e.parentNode===n?(e.style.left=t.left+"px",e.style.top=t.top+"px"):i.setViewportOffset(e,t)},getEventOffset:function(e){var t=e.target||e.srcElement,n=d.getClientRect(t),i=d.getViewportOffsetByEvent(e);return{left:i.left-n.left,top:i.top-n.top}},getViewportOffsetByEvent:function(e){var t=e.target||e.srcElement,n=i.getWindow(t).frameElement,o={left:e.clientX,top:e.clientY};if(n&&t.ownerDocument!==document){var r=d.getClientRect(n);o.left+=r.left,o.top+=r.top}return o},setGlobal:function(e,t){return a[e]=t,o+'["'+e+'"]'},unsetGlobal:function(e){delete a[e]},copyAttributes:function(e,t){for(var o=t.attributes,r=o.length;r--;){var a=o[r];"style"==a.nodeName||"class"==a.nodeName||n.ie&&!a.specified||e.setAttribute(a.nodeName,a.nodeValue)}t.className&&i.addClass(e,t.className),t.style.cssText&&(e.style.cssText+=";"+t.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&(e===t?!1:e.contains?e.contains(t):16&e.compareDocumentPosition(t))},startDrag:function(e,t,n){function i(e){var n=e.clientX-a,i=e.clientY-s;t.ondragmove(n,i,e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function o(){n.removeEventListener("mousemove",i,!0),n.removeEventListener("mouseup",o,!0),window.removeEventListener("mouseup",o,!0),t.ondragstop()}function r(){l.releaseCapture(),l.detachEvent("onmousemove",i),l.detachEvent("onmouseup",r),l.detachEvent("onlosecaptrue",r),t.ondragstop()}var n=n||document,a=e.clientX,s=e.clientY;if(n.addEventListener)n.addEventListener("mousemove",i,!0),n.addEventListener("mouseup",o,!0),window.addEventListener("mouseup",o,!0),e.preventDefault();else{var l=e.srcElement;l.setCapture(),l.attachEvent("onmousemove",i),l.attachEvent("onmouseup",r),l.attachEvent("onlosecaptrue",r),e.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var i=document.getElementById("edui_fixedlayer");return null==i&&(i=document.createElement("div"),i.id="edui_fixedlayer",document.body.appendChild(i),n.ie&&n.version<=8?(i.style.position="absolute",t(),setTimeout(e)):i.style.position="fixed",i.style.left="0",i.style.top="0",i.style.width="0",i.style.height="0"),i},makeUnselectable:function(e){if(n.opera||n.ie&&n.version<9){if(e.unselectable="on",e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)1==e.childNodes[t].nodeType&&d.makeUnselectable(e.childNodes[t])}else void 0!==e.style.MozUserSelect?e.style.MozUserSelect="none":void 0!==e.style.WebkitUserSelect?e.style.WebkitUserSelect="none":void 0!==e.style.KhtmlUserSelect&&(e.style.KhtmlUserSelect="none")}}}(),function(){var e=r.editor.utils,t=r.editor.ui.uiUtils,n=r.editor.EventBase,i=r.editor.ui.UIBase=function(){};i.prototype={className:"",uiName:"",initOptions:function(e){try{var n=this;for(var i in e)n[i]=e[i];this.id=this.id||"edui"+t.uid()}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:10542})}},initUIBase:function(){try{this._globalKey=e.unhtml(t.setGlobal(this.id,this))}catch(n){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:10545})}},render:function(e){for(var n,i=this.renderHtml(),o=t.createElementByHtml(i),r=w.getElementsByTagName(o,"*"),a="edui-"+(this.theme||this.editor.options.theme),s=document.getElementById("edui_fixedlayer"),l=0;n=r[l++];)w.addClass(n,a);w.addClass(o,a),s&&(s.className="",w.addClass(s,a));var d=this.getDom();null!=d?(d.parentNode.replaceChild(o,d),t.copyAttributes(o,d)):("string"==typeof e&&(e=document.getElementById(e)),e=e||t.getFixedLayer(),w.addClass(e,a),e.appendChild(o)),this.postRender()},getDom:function(e){return document.getElementById(e?this.id+"_"+e:this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();e&&r.editor.dom.domUtils.remove(e),t.unsetGlobal(this.id)}},e.inherits(i,n)}(),function(){var e=r.editor.utils,t=r.editor.ui.UIBase,n=r.editor.ui.Separator=function(e){this.initOptions(e),this.initSeparator()};n.prototype={uiName:"separator",initSeparator:function(){try{this.initUIBase()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:10621})}},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},e.inherits(n,t)}(),function(){var e=r.editor.utils,t=r.editor.dom.domUtils,n=r.editor.ui.UIBase,i=r.editor.ui.uiUtils,o=r.editor.ui.Mask=function(e){this.initOptions(e),this.initUIBase()};o.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;t.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e._fill()})})},show:function(e){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_fill:function(){var e=this.getDom(),t=i.getViewportRect();e.style.width=t.width+"px",e.style.height=t.height+"px"}},e.inherits(o,n)}(),function(){function e(e,t){for(var n=0;n<s.length;n++){var i=s[n];if(!i.isHidden()&&i.queryAutoHide(t)!==!1){if(e&&/scroll/gi.test(e.type)&&"edui-wordpastepop"==i.className)return;i.hide()}}}var t=r.editor.utils,n=r.editor.ui.uiUtils,i=r.editor.dom.domUtils,o=r.editor.ui.UIBase,a=r.editor.ui.Popup=function(e){this.initOptions(e),this.initPopup()},s=[];a.postHide=e;var l=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];a.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){try{this.initUIBase(),s.push(this)}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:10721})}},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return this.content?"string"==typeof this.content?this.content:this.content.renderHtml():""},_UIBase_postRender:o.prototype.postRender,postRender:function(){this.content instanceof o&&this.content.postRender(),this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var e=this.getDom("content");return n.getClientRect(e)},fitSize:function(){var e=this.getDom("body");e.style.width="",e.style.height="";var t=this.mesureSize();return e.style.width=t.width+"px",e.style.height=t.height+"px",t},showAnchor:function(e,t){this.showAnchorRect(n.getClientRect(e),t)},showAnchorRect:function(e,t){this._doAutoRender();var o=n.getViewportRect();this._show();var a,s,d,c,u=this.fitSize();t?(a=this.canSideLeft&&e.right+u.width>o.right&&e.left>u.width,s=this.canSideUp&&e.top+u.height>o.bottom&&e.bottom>u.height,d=a?e.left-u.width:e.right,c=s?e.bottom-u.height:e.top):(a=this.canSideLeft&&e.right+u.width>o.right&&e.left>u.width,s=this.canSideUp&&e.top+u.height>o.bottom&&e.bottom>u.height,d=a?e.right-u.width:e.left,c=s?e.top-u.height:e.bottom);var f=this.getDom();n.setViewportOffset(f,{left:d-10,top:c+5}),i.removeClasses(f,l),f.className+=" "+l[2*(s?1:0)+(a?1:0)],this.editor&&(f.style.zIndex=1*this.editor.container.style.zIndex+10,r.editor.ui.uiUtils.getFixedLayer().style.zIndex=f.style.zIndex-1)},showAt:function(e){var t=e.left,n=e.top,i={left:t,top:n,right:t,bottom:n,height:0,width:0};this.showAnchorRect(i,!1,!0)},_show:function(){if(this._hidden){var e=this.getDom();e.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(e){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,e||this.fireEvent("hide"))},queryAutoHide:function(e){return!e||!n.contains(this.getDom(),e)}},t.inherits(a,o),i.on(document,"mousedown",function(t){var n=t.target||t.srcElement;e(t,n)}),i.on(window,"scroll",function(t,n){e(t,n)})}(),function(){var e=r.editor.browser,t=r.editor.dom.domUtils,n=r.editor.ui.uiUtils,i='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(e.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');r.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){try{this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:10891})}},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return i})},Stateful_onMouseEnter:function(e,t){this.target=t,(!this.isDisabled()||this.alwalysHoverable)&&(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(){(!this.isDisabled()||this.alwalysHoverable)&&(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(e,t){var i=e.relatedTarget;n.contains(t,i)||t===i||this.Stateful_onMouseEnter(e,t)},Stateful_onMouseOut:function(e,t){var i=e.relatedTarget;n.contains(t,i)||t===i||this.Stateful_onMouseLeave(e,t)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(e){return t.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.hasState(e)||(this.getStateDom().className+=" edui-state-"+e)},removeState:function(e){this.hasState(e)&&t.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){!this.isDisabled()&&e?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){e?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}(),function(){var e=r.editor.utils,t=r.editor.ui.UIBase,n=r.editor.ui.Stateful,i=r.editor.ui.Button=function(e){this.initOptions(e),this.initButton()};i.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){try{this.initUIBase(),this.Stateful_init()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11e3})}},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onClick:function(){try{this.isDisabled()||this.fireEvent("click")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11020})}}},e.inherits(i,t),e.extend(i.prototype,n)}(),function(){var e=r.editor.utils,t=r.editor.dom.domUtils,n=r.editor.ui.uiUtils,i=r.editor.ui.UIBase,o=r.editor.ui.Popup,a=r.editor.ui.Stateful,s=r.editor.ui.CellAlignPicker,l=r.editor.ui.Menu=function(e){this.initOptions(e),this.initMenu()},d={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};l.prototype={items:null,uiName:"menu",initMenu:function(){try{this.items=this.items||[],this.initPopup(),this.initItems()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11062})}},initItems:function(){try{for(var e=0;e<this.items.length;e++){var t=this.items[e];"-"==t?this.items[e]=this.getSeparator():t instanceof c||(t.editor=this.editor,t.theme=this.editor.options.theme,this.items[e]=this.createItem(t))}}catch(n){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11074})}},getSeparator:function(){return d},createItem:function(e){return e.menu=this,new c(e)},_Popup_getContentHtmlTpl:o.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(0==this.items.length)return this._Popup_getContentHtmlTpl();for(var e=[],t=0;t<this.items.length;t++){var n=this.items[t];e[t]=n.renderHtml()}return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:o.prototype.postRender,postRender:function(){for(var e=this,i=0;i<this.items.length;i++){var o=this.items[i];o.ownerMenu=this,o.postRender()}t.on(this.getDom(),"mouseover",function(t){t=t||event;var i=t.relatedTarget||t.fromElement,o=e.getDom();n.contains(o,i)||o===i||e.fireEvent("over")}),this._Popup_postRender()},queryAutoHide:function(e){if(e){if(n.contains(this.getDom(),e))return!1;for(var t=0;t<this.items.length;t++){var i=this.items[t];if(i.queryAutoHide(e)===!1)return!1}}},clearItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];clearTimeout(t._showingTimer),clearTimeout(t._closingTimer),t.subMenu&&t.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&t.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},e.inherits(l,o);var c=r.editor.ui.MenuItem=function(e){if(this.initOptions(e),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof l))if(e.className&&-1!=e.className.indexOf("aligntd")){var n=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment"),this.subMenu=new o({content:new s(this.subMenu),parentMenu:n,editor:n.editor,destroy:function(){this.getDom()&&t.remove(this.getDom())}}),this.subMenu.addListener("postRenderAfter",function(){t.on(this.getDom(),"mouseover",function(){n.addState("opened")})})}else this.subMenu=new l(this.subMenu)};c.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var e=this;this.addListener("over",function(){e.ownerMenu.fireEvent("submenuover",e),e.subMenu&&e.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){e.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(e._closingTimer),e._closingTimer=null,e.addState("opened")}),this.ownerMenu.addListener("hide",function(){e.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,n){n!==e&&e.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(t){return t&&n.contains(e.getDom(),t)?!1:this._bakQueryAutoHide(t)}),this.getDom().style.tabIndex="-1",n.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;e.isDisabled()||(e.addState("opened"),clearTimeout(e._showingTimer),clearTimeout(e._closingTimer),e._closingTimer=null,e._showingTimer=setTimeout(function(){e.showSubMenu()},250))},delayHideSubMenu:function(){var e=this;e.isDisabled()||(e.removeState("opened"),clearTimeout(e._showingTimer),e._closingTimer||(e._closingTimer=setTimeout(function(){e.hasState("opened")||e.hideSubMenu(),e._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){return this.subMenu&&this.hasState("opened")?this.subMenu.queryAutoHide(e):void 0},_onClick:function(e,t){try{if(this.hasState("disabled"))return;this.fireEvent("click",e,t)!==!1&&(this.subMenu?this.showSubMenu():o.postHide(e))}catch(n){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11285})}},showSubMenu:function(){var e=n.getClientRect(this.getDom());e.right-=5,e.left+=2,e.width-=7,e.top-=4,e.bottom+=4,e.height+=8,this.subMenu.showAnchorRect(e,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},e.inherits(c,i),e.extend(c.prototype,a,!0)}(),function(){var e=r.editor.utils,t=r.editor.ui.uiUtils,n=(r.editor.dom.domUtils,r.editor.ui.UIBase),i=r.editor.ui.Stateful,o=r.editor.ui.SplitButton=function(e){this.initOptions(e),this.initSplitButton()};o.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){try{this.initUIBase(),this.Stateful_init();if(null!=this.popup){var e=this.popup;this.popup=null,this.setPopup(e)}}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11330})}},_UIBase_postRender:n.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(n){this.popup!==n&&(null!=this.popup&&this.popup.dispose(),n.addListener("show",e.bind(this._onPopupShow,this)),n.addListener("hide",e.bind(this._onPopupHide,this)),n.addListener("postrender",e.bind(function(){n.getDom("body").appendChild(t.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(t.getClientRect(this.getDom()).width-2)+'px"></div>')),n.getDom().className+=" "+this.className},this)),this.popup=n)},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon iknow_editor_icons"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var e=t.getClientRect(this.getDom());e.top-=this.popup.SHADOW_RADIUS,e.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(e)},_onArrowClick:function(){try{this.isDisabled()||this.showPopup()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11380})}},_onButtonClick:function(){try{this.isDisabled()||this.fireEvent("buttonclick")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11385})}}},e.inherits(o,n),e.extend(o.prototype,i,!0)}(),function(){var e=r.editor.utils,t=r.editor.ui.uiUtils,n=r.editor.ui.Menu,i=r.editor.ui.SplitButton,o=r.editor.ui.Combox=function(e){this.initOptions(e),this.initCombox()};o.prototype={uiName:"combox",initCombox:function(){try{var e=this;this.items=this.items||[];for(var t=0;t<this.items.length;t++){var i=this.items[t];i.uiName="listitem",i.index=t,i.onclick=function(){try{e.selectByIndex(this.index)}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11417})}}}this.popup=new n({items:this.items,uiName:"list",editor:this.editor}),this.initSplitButton()}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11425})}},_SplitButton_postRender:i.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var e=t.getClientRect(this.getDom());e.top+=1,e.bottom-=1,e.height-=2,this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var t=this.indexByValue(e);-1!=t?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(e)),this.value=e)},setLabel:function(e){this.getDom("button_body").innerHTML=e,this.label=e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var t=0;t<this.items.length;t++)if(e==this.items[t].value)return t;return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){e<this.items.length&&this.fireEvent("select",e)!==!1&&(this.selectedIndex=e,this.value=this.items[e].value,this.setLabel(this.items[e].label))}},e.inherits(o,i)}(),function(){var e=r.editor.utils,t=r.editor.ui.uiUtils,n=r.editor.ui.UIBase,i=r.editor.ui.Toolbar=function(e){this.initOptions(e),this.initToolbar()};i.prototype={items:null,initToolbar:function(){try{this.items=this.items||[],this.initUIBase()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11496})}},add:function(e){this.items.push(e)},getHtmlTpl:function(){for(var e=[],t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div id="##" class="hancong edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+e.join("")+"</div>"},postRender:function(){for(var e=this.getDom(),n=0;n<this.items.length;n++)this.items[n].postRender();t.makeUnselectable(e)},_onMouseDown:function(){return!1}},e.inherits(i,n)}(),function(){var e,t,n,i=r.editor.utils,o=r.editor.ui.Stateful,a=r.editor.ui.UIBase,l=r.editor.ui.Button,d=r.editor.ui.Popup,f=r.editor.ui.AttachPicker=function(e){this.initOptions(e),this.initAttechPicker()},m={_errorBoxKey:"iknowDialogErrorBox",_coverBtnKey:"iknowDialogSbumitCover",_cache:null,_coverConfirm:null,_warningDialog:null,select:function(e){return this.updateSubmitState(e),e.path?void(this._cache=this.checkData(e)?e:null):void(this._cache=null)},insert:function(){h.hide();var e=this._cache;return e&&e.path?this.isImageFile(e.path)?(this.showWarning("\u63d2\u5165\u56fe\u7247\u8bf7\u4f7f\u7528\u56fe\u7247\u529f\u80fd!"),!1):void(this.hasAttachment()?this.showConfirm():(this.updateFile(),this._cache=null)):(this.showWarning("\u672a\u9009\u62e9\u6587\u4ef6!"),!1)},dialogopen:function(){var e=s(".BDWidget_dialog_footer .dlg-sbtn"),t=null,n=null;if(e.length){t=e.position(),e.addClass("iknow_ue_disable"),n=document.createElement("div"),n.id=this._coverBtnKey,n.style.cssText=["position: absolute","top: 0","left: 0","width: 270px","height: 56px","z-index: 999","background: white","filter: alpha(opacity=0)","opacity: 0"].join("; "),t=s(".BDWidget_dialog_footer"),t&&t.append(n);var i=document.createElement("div");if(i.id=this._errorBoxKey,i.style.cssText=["font: 14px/20px Arial","text-align: right","color: red","position: absolute","bottom: 45px","right: 0","padding-right: 20px;"].join(";"),i.innerHTML="&nbsp;",t=t[0],!t)return null;t.parentNode.insertBefore(i,t)}},updateSubmitState:function(e){!e.path||this.isImageFile(e.path)?this.disableSubmit():this.enableSubmit()},disableSubmit:function(){var e=s("#"+this._coverBtnKey);e.length&&(e.show(),s(".BDWidget_dialog_footer .dlg-sbtn").addClass("iknow_ue_disable"))},enableSubmit:function(){var e=s("#"+this._coverBtnKey);e.length&&(e.hide(),s(".BDWidget_dialog_footer .dlg-sbtn").removeClass("iknow_ue_disable"))},updateFile:function(){return this._cache?(this._cache.wealth=0,e.setUploadFile({error:!1,fileInfo:this._cache},!0),!0):!1},cancel:function(){h.hide(),this._cache=null},checkData:function(e){var t=!0;return this.isImageFile(e.path)?(this.showError("\u63d2\u5165\u56fe\u7247\u8bf7\u4f7f\u7528\u56fe\u7247\u529f\u80fd\uff01"),t=!1):this.clearError(),t},hasAttachment:function(){return e.swfupload&&e.swfupload.customSettings.successCount>0},showConfirm:function(){var e=this;this._coverConfirm?this._coverConfirm.show():this._coverConfirm=c.confirm('<div class="f-14"><img class="grid" src="https://gss0.bdstatic.com/70cFsjip0QIZ8tyhnq/img/iknow/feedback/icon-question.png"><p>\u60a8\u53ea\u80fd\u4e0a\u4f20\u4e00\u4e2a\u9644\u4ef6\uff0c\u4e0a\u4e00\u9644\u4ef6\u5c06\u88ab\u8986\u76d6\uff0c\u786e\u5b9a\u5417\uff1f</p><p class="f-12 f-gray pl-20">\uff08\u5982\u679c\u60f3\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\uff0c\u8bf7\u6253\u5305\uff09</p></div>',{width:400,height:165,title:"\u77e5\u9053\u63d0\u793a",onaccept:function(){e.updateFile(),u.fire("dialog.close")},oncancel:function(){u.fire("dialog.close")}})},showWarning:function(e){this._warningDialog?this._warningDialog.setContnet(e).show():this._warningDialog=c.alert('<div style="color: red; text-align: center;">'+e+"</div>",{width:400,height:150,title:"\u77e5\u9053\u63d0\u793a",onaccept:function(){u.fire("dialog.close")}})},isImageFile:function(e){return/\.((jpg)|(jpeg)|(gif)|(bmp)|(png)|(jpe)|(cur)|(tif)|(tiff)|(ico))$/i.test(e)},showError:function(e){var t=this.getErrorBox();t&&(t.innerHTML=e)},clearError:function(){this.showError("&nbsp;")},getErrorBox:function(){return s("#iknowDialogErrorBox")[0]}},h={wrap:null,attachWarningDialog:null,init:function(e){try{var t=this;if(this.wrap)return this;var n=document.getElementById("BDWidget_dialog_body"),i={width:s(document).width(),height:s(document).height()};zIndex=n?s(n).css("zIndex")-1:5e3,this.wrap=document.createElement("div"),this.wrap.style.cssText=["width:"+i.width+"px","height:"+i.height+"px","position: absolute","top: 0","left: 0","background: #2d2d2d","z-index:"+zIndex,"filter: alpha(opacity=20)","opacity:0.2","display: none"].join("; "),document.body.insertBefore(this.wrap,document.body.firstChild),s(e).on("click",function(){try{if(!UE.AttachInited)return t.attachWarningDialog||(t.attachWarningDialog=c.alert('<div style="color: red; text-align: center;">\u7f51\u76d8\u672a\u51c6\u5907\u5c31\u7eea</div>',{width:400,height:150,title:"\u77e5\u9053\u63d0\u793a",onaccept:function(){u.fire("dialog.close")
}})),t.attachWarningDialog.show(),!1;h.show()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11839})}})}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11841})}},show:function(){return this.wrap.style.display="block",this},hide:function(){return this.wrap.style.display="none",this}};f.prototype={initAttechPicker:function(){try{this.initUIBase(),this.initButtons(),this.Stateful_init()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:11859})}},initButtons:function(){function i(){var t=null;UE.AttachInited||UE.AttachResourceReady&&window.BDWidget&&(UE.AttachInited=!0,t=document.getElementById("iknowWPBtn"),BDWidget.init(e.options.WP_KEY,function(){try{this.insertFrom({ele:t,onSuccess:function(){m.insert()},onSelect:function(e){m.select(e)},onCancel:function(){m.cancel()},onLoad:function(){m.dialogopen()}})}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12118})}}))}try{var o=this;e=this.editor,e.ui.uploadfile=t=function(e){var t="uploadfile",n=e.options.buttonConfig.attachment.list[t],i=+new Date,o="swfuPlaceholder"+i,r="swfuFlash"+i,a="swfuProgress"+i,c="swfuWealth"+i,u=new l({className:"edui-for-"+t,label:n,showText:!0,getHtmlTpl:function(){return'<div id="##">'+this.label+'</div><div class="ue_flash" id="'+r+'"><div id="'+o+'"></div></div>'},onmouseover:function(){this.addState("hover")},onmouseout:function(){this.removeState("hover")},getStateDom:function(){return s("#"+r)[0].parentNode}});return u.addListener("postrender",function(){for(var t="",n=e.options.wealthList,i=document.createElement("div"),l=0;l<n.length;l++){var u=n[l];t+='<option value="'+u.key+'">'+u.value+"</option>"}i.id=a,i.innerHTML='<div class="progressWrapper" style="display:none;"><div class="fileIcon icon_file_default"></div><div class="progressName textClip"></div><div class="progressSize"></div><div class="progressRename"><input class="progressRenameValue" type="text"><a class="btn btn-22-green progressRenameBtn" rel="nofollow"><em><b>\u786e\u5b9a</b></em></a></div><div class="progressMessage"></div><div class="progressBarWrapper"><div class="progressBar"></div><span class="progressBarText"></span></div><div class="progressWealthWrapper"><span class="progressWealthText">\u5b9a\u4ef7:</span><select name="wealth" class="progressWealth" id="'+c+'">'+t+'</select></div><a class="progressCancel" href="#">\u53d6\u6d88</a><div class="progressFileOperator"><a href="#" class="rename">\u91cd\u547d\u540d</a><a href="#" class="remove">\u5220\u9664</a></div></div>',e.ui.getDom().insertBefore(i,e.ui.getDom("iframeholder")),e._uploadFile={fileInfo:null,backFileInfo:null,score:0,status:"ready",errorCode:null},e.swfupload=new SWFUpload({flash_url:e.options.swfUploadFlashUrl,upload_url:e.options.swfUploadUrl,file_post_name:e.options.swfUploadPostName,file_types:"*.*",file_types_description:"All Files",file_queue_limit:0,file_size_limit:"4 GB",custom_settings:{progressTarget:a,swfUploadUrl:e.options.swfUploadUrl,swfUploadDir:e.options.swfUploadDir,isLogin:e.options.isLogin,isnewtipshow:e.options.isnewtipshow,isInsertFromWangPan:!1,isEditorFile:!1,isUploading:!1,successCount:0,currentFile:null,getUploadFile:function(t){return void 0==t&&(t="fileInfo"),e._uploadFile[t]||null},setUploadFile:function(t,n,i){return e._uploadFile.hasOwnProperty(t)?(i&&e._uploadFile[t]?e._uploadFile[t][i]=n:e._uploadFile[t]=n,!0):!1},setBindUploadStatus:function(t,n){e._uploadFile.status=t,e._uploadFile.errorCode="error"==t?n:null},setEditorStatusBar:function(t){s(".f-red",e.container).length&&s(".edui-editor-wordcount",e.container).eq(0).html(t)},hideAllPopup:function(){d.postHide()}},button_action:SWFUpload.BUTTON_ACTION.SELECT_FILE,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,button_cursor:SWFUpload.CURSOR.HAND,button_placeholder_id:o,button_width:70,button_height:24,minimum_flash_version:"9.0.28",swfupload_pre_load_handler:swfUploadPreLoad,swfupload_loaded_handler:swfUploadLoaded,swfupload_load_failed_handler:swfUploadLoadFailed,file_dialog_start_handler:swfUploadFileDialogStart,file_dialog_complete_handler:swfUploadFileDialogComplete,file_queued_handler:swfUploadFileQueued,file_queue_error_handler:swfUploadFileQueueError,queue_complete_handler:swfUploadQueueComplete,upload_start_handler:swfUploadSendStart,upload_progress_handler:swfUploadSendProgress,upload_success_handler:swfUploadSendSuccess,upload_error_handler:swfUploadSendError,upload_complete_handler:swfUploadSendComplete}),e.setUploadFile=function(t,n){editorSetUploadFile(t,n,e),document.getElementById(c).selectedIndex=t.fileInfo&&t.fileInfo.wealth?t.fileInfo.wealth:0},e.getUploadFile=function(){var t={};return t.status=e._uploadFile.status,t.errorCode=e._uploadFile.errorCode,t.fileInfo=e._uploadFile.fileInfo||{},t.fileInfo.wealth=document.getElementById(c).value,t},e.uploadAction=function(t,n){editorSubmitUploadFile(t,e,n)};var f=function(e){return document.getElementById(e)},m=f(r);/^[\s]*<object/i.test(m.innerHTML)||(m.title="\u60a8\u7684Flash\u63d2\u4ef6\u7248\u672c\u8fc7\u4f4e\uff0c\u8bf7\u66f4\u65b0\u540e\u518d\u5c1d\u8bd5\uff01")}),u}(this.editor),e.ui.wangpan=n=function(e){var t="wangpan",n=e.options.buttonConfig.attachment.list[t],r=new l({className:"edui-for-"+t+" "+t,label:n,getHtmlTpl:function(){return'<div id="iknowWPBtn" onclick="$$._onClickWangpan(event);">'+this.label+"</div>"},onmouseover:function(){this.addState("hover")},onmouseout:function(){this.removeState("hover")},getStateDom:function(){return s("#iknowWPBtn")[0].parentNode},showText:!0});return r._onWangPanDialogOk=function(){},r.editor=e,o.addListener("postrender",function(){h.init(document.getElementById("iknowWPBtn")),i()}),e.addListener("attachresourceready",i),s.browser&&s.browser.ie<7&&(window.wangpanEditorForIE=e),r}(this.editor)}catch(r){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:r.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12123})}},getHtmlTpl:function(){return'<div id="##" class="edui-attachpicker %%"><div class="edui-attachpicker-top"></div><div class="edui-attachpicker-body"><div class="edui-attachpicker-item edui-attachpicker-uploadfile" stateful _title="\u4e0a\u4f20\u6587\u4ef6\u5230\u7f51\u76d8">'+t.getHtmlTpl()+'</div><div class="edui-attachpicker-item edui-attachpicker-wangpan" stateful _title="\u4ece\u7f51\u76d8\u63d2\u5165\u6587\u4ef6">'+n.getHtmlTpl()+"</div></div></div>"},getStateDom:function(){return this.target},postRender:function(){t.fireEvent("postrender"),this.fireEvent("postrender")},_onClick:function(e){try{d.postHide(e),this.isDisabled()||this.fireEvent("click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12149})}},_onMouseOver:function(){this.isDisabled()||this.fireEvent("mouseover")},_onMouseOut:function(){this.isDisabled()||this.fireEvent("mouseout")},_onClickWangpan:function(e){try{d.postHide(e)}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12162})}},_UIBase_render:a.prototype.render},i.inherits(f,a),i.extend(f.prototype,o,!0)}(),UE.Editor.prototype.hasWordOverflow=function(){return this.getContentLength(!0)>this.options.maximumWords},UE.Editor.prototype.getIconName=function(e){var t={icon_file_image:"jpg,jpeg,gif,bmp,png,jpe,cur,svg,svgz,tif,tiff,ico",icon_file_visio:"vsd,vsdx",icon_file_pdf:"pdf",icon_file_word:"doc,docx,ods,ots,odt,rtf,dot,dotx,odm",icon_file_excel:"xls,xlsx,xlt,xltx,csv",icon_file_text:"txt,html,htm,xhtml,xml,js,css",icon_file_music:"wma,wav,mp3,aac,ra,ram,mp2,ogg,aif,mpega,amr,mid,midi",icon_file_video:"wmv,rmvb,mpeg4,mpeg2,flv,avi,3gp,mpga,qt,rm,wmz,wmd,wvx,wmx,wm,swf,mpg,mp4,mkv,mpeg,mov",icon_file_powerpoint:"ppt,pptx,pps,pot,ppsx,potx",icon_file_ipa:"ipa",icon_file_exe:"exe,msi",icon_file_zip:"zip,rar,7z,tar,gz",icon_file_apk:"apk",icon_file_default:"default",icon_file_torrent:"torrent"},n={};for(i in t){var o=t[i].split(",");for(j in o)n.hasOwnProperty(o[j]),void 0==n[o[j]]&&(n[o[j]]=i)}return n[e.toLowerCase()]?n[e.toLowerCase()]:n["default"]},r.editor.ui.Toolbar.prototype.getHtmlTpl=function(){for(var e=[],t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" >'+e.join("")+"</div>"},r.editor.ui.Button.prototype.getHtmlTpl=function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick(event, this);" onmouseover="return $$._onMouseOver();" onmouseout="return $$._onMouseOut();">'+(this.showIcon?'<div class="edui-box edui-icon iknow_editor_icons"></div>':"")+(this.showText?'<div class="edui-box edui-label iknow_editor_icons"></div>':"")+"</div></div></div></div>"},r.editor.ui.Button.prototype._onMouseOver=function(){this.isDisabled()||this.fireEvent("mouseover")},r.editor.ui.Button.prototype._onMouseOut=function(){this.isDisabled()||this.fireEvent("mouseout")};var x=UE.Editor.prototype._setup;UE.Editor.prototype._setup=function(){x.apply(this,arguments),this.fireEvent("selectionchange")},UE.Editor.prototype.initAttach=function(){try{this.attachment&&(document.getElementById("edui_fixedlayer").style.display="none",this.attachment.fireEvent("mouseover"),this.attachment.fireEvent("mouseout"),window.setTimeout(function(){document.getElementById("edui_fixedlayer").style.display=""},500))}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12262})}};var S=r.editor.ui.Combox.prototype.showPopup;r.editor.ui.Combox.prototype.showPopup=function(){S.apply(this,arguments),this.popup&&(!r.editor.browser.ie||r.editor.browser.version>6)&&(this.popup.getDom().style.position="fixed")},r.editor.ui.Popup.prototype.getHtmlTpl=function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1; display: none; left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},UE.plugins.autoheight=function(){function e(){var e=this;clearTimeout(o),r||(!e.queryCommandState||e.queryCommandState&&1!=e.queryCommandState("source"))&&(o=setTimeout(function(){var t=e.body.lastChild;i=Math.max(w.getXY(t).y+t.offsetHeight+25,Math.max(s.minFrameHeight,s.initialFrameHeight)),i!=a&&(i<e.options.initialMaxFrameHeight?(e.setHeight(i),a=i,e.body.style.overflowY="hidden",e.autoHeightEnabled=!0):(e.setHeight(e.options.initialMaxFrameHeight),a=i,e.body.style.overflowY=n||"",e.autoHeightEnabled=!1))},50))}var t=this;if(t.autoHeightEnabled=t.options.autoHeightEnabled!==!1,t.autoHeightEnabled){var n,i,o,r,a=0,s=t.options;t.addListener("fullscreenchanged",function(e,t){r=t}),t.addListener("destroy",function(){t.removeListener("contentchange afterinserthtml keyup mouseup",e)}),t.enableAutoHeight=function(){var t=this;if(t.autoHeightEnabled){var i=t.document;t.autoHeightEnabled=!0,n=i.body.style.overflowY,i.body.style.overflowY="hidden",t.addListener("contentchange afterinserthtml keyup mouseup",e),setTimeout(function(){e.call(t)},p.gecko?100:0),t.fireEvent("autoheightchanged",t.autoHeightEnabled)}},t.disableAutoHeight=function(){t.body.style.overflowY=n||"",t.removeListener("contentchange",e),t.removeListener("keyup",e),t.removeListener("mouseup",e),t.autoHeightEnabled=!1,t.fireEvent("autoheightchanged",t.autoHeightEnabled)},t.addListener("ready",function(){t.enableAutoHeight();var n;w.on(p.ie?t.body:t.document,p.webkit?"dragover":"drop",function(){clearTimeout(n),n=setTimeout(function(){e.call(t)},100)})})}},UE.plugins.image=function(){var e=!0,t=this.options;UE.commands.insertimage={execCommand:function(t,n){var i=this;if(n.src){var o;o="<p><img "+(n.id?' id="'+n.id+'"':"")+' src="'+f.autoTrans(n.src)+'" '+(n.data_ue_src?' data_ue_src="'+n.data_ue_src+'" ':"")+(n.width?'width="'+n.width+'" ':"")+(n.height?' height="'+n.height+'" ':"")+(n.alt?' alt="'+n.alt+'"':"")+"/></p>",i.execCommand("inserthtml",o),e&&n.keepHeight!==!0&&(e=!1)}},queryCommandState:function(){var e=this.document.getElementsByTagName("img");return e.length>t.maxImagesCount-1?-2:0}}},UE.commands.insertmap={queryCommandState:function(){return 0==this.document.getElementsByTagName("iframe").length?0:-2}},UE.commands.deletemap={execCommand:function(){var e=this.document.getElementsByTagName("iframe")[0];e&&e.parentNode.removeChild(e)}},UE.plugins.video=function(){function e(e){v.each(e.getNodesByTagName("img"),function(e){if("edui-faked-video"==e.getAttr("class")){var t=['<video style="display:none"',' class="',e.getAttr("class"),'"',' data_type="',e.getAttr("data_type"),'"',' data_img="',e.getAttr("data_img"),'"',' data_src="',e.getAttr("data_src"),'"',' data_swf="',e.getAttr("data_swf"),'"',' data_title="',e.getAttr("data_title"),'"',' data_time="',e.getAttr("data_time"),'"',' data_def="',e.getAttr("data_def"),'"',' data_itemid="',e.getAttr("data_itemid"),'"',">","</video>"];e.parentNode.replaceChild(UE.uNode.createElement(t.join("")),e)}})}function t(e){v.each(e.getNodesByTagName("video"),function(e){if("edui-faked-video"==e.getAttr("class")){var t=['<img src="https://gss0.bdstatic.com/7051cy89RsgCncy6lo7D0j9wexYrbOWh7c50/editor/video-bg.png"',' class="',e.getAttr("class"),'" width=219 height=175',' data_type="',e.getAttr("data_type"),'"',' data_img="',e.getAttr("data_img"),'"',' data_src="',e.getAttr("data_src"),'"',' data_swf="',e.getAttr("data_swf"),'"',' data_title="',e.getAttr("data_title"),'"',' data_time="',e.getAttr("data_time"),'"',' data_def="',e.getAttr("data_def"),'"',' data_itemid="',e.getAttr("data_itemid"),'"',">"];e.parentNode.replaceChild(UE.uNode.createElement(t.join("")),e)}})}var n=this;n.addOutputRule(function(t){e(t)}),n.addInputRule(function(e){t(e)}),n.commands.insertvideo={execCommand:function(e,t){var i=['<img src="https://gss0.bdstatic.com/7051cy89RsgCncy6lo7D0j9wexYrbOWh7c50/editor/video-bg.png"',' class="edui-faked-video" width=219 height=175',' data_type="',t.type,'"',' data_img="',t.img,'"',' data_src="',t.src,'"',' data_swf="',t.swf,'"',' data_title="',t.title,'"',' data_time="',t.time,'"',' data_def="',t.def,'"',' data_itemid="',t.itemid,'"',">"];n.execCommand("inserthtml",i.join(""),!0)},queryCommandState:function(){var e=n.selection.getRange().getClosedNode(),t=e&&"edui-faked-video"==e.className;return t?1:0}}},function(){var e=r.editor.dom.domUtils,t=r.editor.ui;t.buttons={};var n=function(e){return document.getElementById(e)};t.insertimage=function(i){function o(e,t,n,i){if(e)var o=setInterval(function(){0==i&&clearInterval(o),e[t]?(e[t](),clearInterval(o)):i--},n)}var a,s=i.options.buttonConfig.insertimage,l=s.title,d=s.hoverTitle,c=s.overflowMsg,u="ue_con_"+ +new Date,m=new t.Button({className:"edui-for-insertimage",title:d||"",label:l||"",alwalysHoverable:!0,postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled),this.fireEvent("renderReady")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%" '+(this.title?'title="'+this.title+'"':"")+'><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" class="%%-body" >'+(this.showIcon?'<div class="edui-box edui-icon iknow_editor_icons"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+'</div></div></div><div id="'+u+'" class="ue_flash"></div></div>'},onmouseover:function(e){UE.ui.Popup.postHide(e)},showText:!0});return m.addListener("renderReady",function(){function t(){a&&a.flashInit&&a.flashInit()&&(clearInterval(h),i.options.isLogin?(a.setHandCursor(!0),a.setJSFuncName([g,v,y,C,b])):a.setHandCursor(!1))}function o(e){if(r.editor.browser.chrome){var t=document.createElement("input");t.type="text",t.style.height="0",t.style.width="0",e.container.parentNode.appendChild(t),setTimeout(function(){t.focus(),e.focus(),t.parentNode.removeChild(t)},1)}}function s(t,n){var r=i.document.getElementById("ue_waitflag_"+t);r.hasLoaded=!1,n&&r?(r.setAttribute("data_ue_src",n),r.removeAttribute("id"),r.removeAttribute("_src"),r.onload=function(){if(!this.hasLoaded){this.hasLoaded=!0;var t=i.document.createElement("span");t.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;",t.innerHTML=".";var n=t.cloneNode(!0);i.selection.getRange().insertNode(n),e.scrollToView(n,e.getWindow(n),0),n&&n.parentNode.removeChild(n),i.fireEvent("contentchange")}},r.src=f.autoTrans(n)):r&&r.parentNode.removeChild(r),o(i),i.fireEvent("contentchange")}e.on(m.getDom(),"mouseover",function(){!m.isDisabled()&&m.addState("hover")}),e.on(m.getDom(),"mouseout",function(){m.removeState("hover")});var l="ue_flash_"+ +new Date;r.swf.create({id:l,url:i.options.flashUrl,width:i.options.imgFlashWidth,height:i.options.imgFlashHeight,errorMessage:"\u60a8\u7684Flash\u63d2\u4ef6\u7248\u672c\u8fc7\u4f4e\uff0c\u8bf7\u66f4\u65b0\u540e\u518d\u5c1d\u8bd5\uff01",wmode:"transparent",ver:"9.0.0",vars:{width:i.options.imgFlashWidth,height:i.options.imgFlashHeight,fileExtension:i.options.acceptImageType,fileSize:i.options.imageMaxSize}},u);var c=n(u);c.children[0]||(p.firefox?c.innerText="":c.textContent="",c.title="\u60a8\u7684Flash\u63d2\u4ef6\u7248\u672c\u8fc7\u4f4e\uff0c\u8bf7\u66f4\u65b0\u540e\u518d\u5c1d\u8bd5\uff01");var h=setInterval(t,50);a=r.swf.getMovie(l);var g="ue_success"+ +new Date,v="ue_error"+ +new Date,y="ue_select"+ +new Date,b="ue_checkupload"+ +new Date,C="ue_logout"+ +new Date;if(!i.options.isLogin){var N=m.getDom(),w=n(N.id+"_body").children[1];w.style.color="#999",N.setAttribute("title",d);var E=n(N.id+"_body").children[0];e.removeClasses(E,["edui-icon"]),e.addClass(E,"edui_disableIcon"),e.addClass(w,"edui-label-disabled")}window[b]=function(){return i.fireEvent("flashClicked"),i.options.isLogin},window[y]=function(e){if(i.fireEvent("imageBeforeUploadEvent"),e.errorNo)return void i.fireEvent("imageSizeError");var t=+new Date,n=i.options.waitImageUrl;i.execCommand("insertimage",{id:"ue_waitflag_"+t,src:n,data_ue_src:n}),i.fireEvent("contentchange");var o=i.options.customObj;o.position=t,o.editorIndex=u,a.upload(i.options.imageUrl,i.options.imageFieldName,o)},window[g]=function(e){s(e.index,e.url?i.options.imagePath+e.url:null),i.fireEvent("uploadSuccess",e)},window[C]=function(){i.fireEvent("isLogout")},window[v]=function(e){s(e.index),i.fireEvent("networkError",e)}}),i.addListener("selectionchange",function(){var t=i.queryCommandState("insertimage"),r=m.getDom(),s=n(r.id+"_body").children[1];if(!i.options.isLogin){m.setDisabled(!0),s.style.color="#999",r.setAttribute("title",d);var l=n(r.id+"_body").children[0];return e.removeClasses(l,["edui-icon"]),void e.addClass(l,"edui_disableIcon")}0>t?(m.setDisabled(!0),m.setChecked(!1),o(a,"disabledUpload",200,100),-2===t&&(m.getDom().setAttribute("title",c),e.addClass(s,"edui-label-overflow"))):(m.setDisabled(!1),m.setChecked(t),o(a,"enabledUpload",200,100),m.getDom().setAttribute("title",d),e.removeClasses(s,["edui-label-overflow"]))}),m},t.insertmap=function(i){var o=i.options.buttonConfig.insertmap,r=o.title,a=o.unTitle,s=o.hoverTitle,l=new t.Button({className:"edui-for-insertmap insertmap",title:s,label:r,alwalysHoverable:!0,onmouseover:function(){},onclick:function(){try{i.fireEvent("showmap"),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:"insertmap"})}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12796})}},showText:!0});return i.addListener("selectionchange",function(){var t=i.queryCommandState("insertmap"),o=l.getDom(),d=n(o.id+"_body").children[1];-2==t?(l.setDisabled(!1),l.setChecked(t),l.onclick=function(){try{i.execCommand("deletemap")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12835})}},e.removeClasses(o,"insertmap"),e.addClass(o,"deletemap"),o.setAttribute("title",a),d.innerHTML=a):(l.setDisabled(!1),l.setChecked(t),l.onclick=function(){try{i.fireEvent("showmap"),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:"attachment"})}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12852})}},e.removeClasses(o,"deletemap"),e.addClass(o,"insertmap"),o.setAttribute("title",s),d.innerHTML=r)}),l},t.attachment=function(i){function o(){r=new t.Popup({content:function(){var e=new t.AttachPicker({editor:i,Stateful_onMouseOut:function(e,t){f.fireEvent("mouseout",arguments[0]);var n=s(t);n.hasClass("edui-attachpicker-uploadfile")?i.ui.uploadfile.fireEvent("mouseout"):n.hasClass("edui-attachpicker-wangpan")&&i.ui.wangpan.fireEvent("mouseout")},Stateful_onMouseOver:function(e,t){f.fireEvent("mouseover",arguments[0]);var n=s(t);n.hasClass("edui-attachpicker-uploadfile")?i.ui.uploadfile.fireEvent("mouseover"):n.hasClass("edui-attachpicker-wangpan")&&i.ui.wangpan.fireEvent("mouseover")},Stateful_onMouseEnter:function(e,t){this.Stateful_onMouseOver(e,t)},Stateful_onMouseLeave:function(e,t){this.Stateful_onMouseOut(e,t)},Stateful_onMouseDown:function(){},Stateful_onMouseUp:function(){}});return e}(),editor:i,className:"edui-attachPop",hide:function(e){!this._hidden&&this.getDom()&&(this.getDom().style.left="-10000px",this._hidden=!0,e||this.fireEvent("hide"))}}),r.render()}var r,a,l="attachment",d=i.options.buttonConfig[l],c=d.title,u=d.hoverTitle,f=new t.Button({className:"edui-for-"+l+(i.options.isLogin?"":"not-login"),title:u,label:c||"",alwalysHoverable:!0,onmouseover:function(e){a&&clearTimeout(a),r||o(),i.options.isLogin&&"uploading"!=i._uploadFile.status&&"finish"!=i._uploadFile.status&&(UE.ui.Popup.postHide(e),r.showAnchor(this.getDom()))},onmouseout:function(e){a=setTimeout(function(){UE.ui.Popup.postHide(e)},500)},onclick:function(e){try{r||o(),i.options.isLogin&&"uploading"!=i._uploadFile.status&&"finish"!=i._uploadFile.status&&(UE.ui.Popup.postHide(e),r.showAnchor(this.getDom())),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:"attachment"})}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:12901})}},theme:i.options.theme,showText:!0});return f.addListener("renderReady",function(){if(o(),!i.options.isLogin){var t=f.getDom(),r=n(t.id+"_body").children[1],a=n(t.id+"_body").children[0];r.style.color="#999",t.setAttribute("title",u),e.removeClasses(a,["edui-icon"]),e.addClass(a,"edui_disableIcon")}}),i.addListener("selectionchange",function(e,t,n){var o=i.queryCommandState(l);i.options.isLogin&&-1!=o?n||(f.setDisabled(!1),f.setChecked(o)):(f.setDisabled(!0),f.setChecked(!1))}),i.attachment=f,f},t.insertvideo=function(i){var o="insertvideo",r=i.options.buttonConfig[o],a=r.title,l=r.hoverTitle,d=new t.Button({className:"edui-for-"+o+(i.options.isLogin?"":"not-login"),title:l,label:a||"",alwalysHoverable:!0,theme:i.options.theme,showText:!0,onclick:function(){try{i.fireEvent("showvideo",{ui:d});var e=s(i.container),t=e.find(".edui-editor-toolbarbox"),n=t.find(".insert-video-wp");n.show(),n.find(".insert-video-arrow").css({left:t.find(".edui-for-insertvideo").position().left-9}),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:"insertvideo"})}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13020})}}});return d.addListener("renderReady",function(){if(!i.options.isLogin){var t=d.getDom(),o=n(t.id+"_body").children[1],r=n(t.id+"_body").children[0];o.style.color="#999",t.setAttribute("title",l),e.removeClasses(r,["edui-icon"]),e.addClass(r,"edui_disableIcon")}}),i.addListener("selectionchange",function(){var t=i.queryCommandState("insertvideo"),o=d.getDom(),r=n(o.id+"_body").children[1];if(!i.options.isLogin){d.setDisabled(!0),r.style.color="#999",o.setAttribute("title",l);var a=n(o.id+"_body").children[0];return e.removeClasses(a,["edui-icon"]),void e.addClass(a,"edui_disableIcon")}-1===t?(d.setDisabled(!0),d.setChecked(!1)):(d.setDisabled(!1),d.setChecked(!1))}),i.addListener("showimageplus",function(){s("#insert-video-wp").removeClass("show")}),d},t.insertimageplus=function(e){var n="insertimageplus",i=e.options.buttonConfig[n],o=i.title,r=i.hoverTitle,a=e.options.extraParam&&e.options.extraParam.qid,l=new t.Button({className:"edui-for-"+n+(e.options.isLogin?"":"not-login"),title:r,label:o||"",alwalysHoverable:!0,theme:e.options.theme,showText:!0,onclick:function(){try{var t=s(e.container),n=t.find(".edui-editor-toolbarbox"),i=n.find(".insert-image-plus-wp"),o=this;if(o.isRecommend=!1,i.show(),i.find(".trangle").css({left:n.find(".edui-for-insertimageplus").position().left+7}),e.fireEvent("showimageplus",{}),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:"insertimageplus"}),F.context("releated-image-"+a))return;e.addListener("showvideo",function(){i.hide()}),e.addListener("focus",function(){i.hide()});var r=h.create({auto:!0,swf:e.options.webuploaderSwf,server:e.options.imageUrl,pick:n.find(".user-webuploader-btn")[0],fileVal:"image",duplicate:!0,accept:{title:"Images",extensions:"gif,jpg,jpeg,png",mimeTypes:"image/*"},formData:e.options.customObj});r.on("uploadSuccess",function(t,n){{var o=n.url,r=+new Date;s(this)}e.execCommand("insertimage",{id:"ue_waitflag_"+r,src:o,data_ue_src:o,keepHeight:!0}),i.hide(),e.fireEvent("contentchange"),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:"user-upload"})}),t.on("click",".recommend-image-item",function(t){try{if(t.preventDefault(),o.isRecommend)return!1;o.isRecommend=!0;var n=+new Date,r=s(this),a=r.attr("src");e.execCommand("insertimage",{id:"ue_waitflag_"+n,src:a,data_ue_src:a,keepHeight:!0}),i.hide(),e.fireEvent("contentchange"),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:"recommend-image-item"})}catch(l){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:l.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13169})}}),setTimeout(function(){var e=0;n.find(".recommend-image-item").each(function(t,n){var i=s(n);e+=i.width()+10}),e+=2,n.find(".recommend-image-item").length>0?n.find(".recommend-images").css("width",e):n.find(".recommend-images").css("width","auto")},100)}catch(l){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:l.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13184})}},onmouseout:function(){},postRender:function(){}});return e.addListener("ready",function(){var t=['<div class="insert-image-plus-wp">','<div class="insert-image-plus-content">','<div class="trangle"></div>','<div class="user-uploader user-webuploader-btn"></div>','<div class="recommend-title">\u63a8\u8350\u56fe\u7247</div>','<div class="recommend-images-wp"><div class="recommend-images"></div></div>',"</div>","</div>"].join(""),n=s(e.container),i=n.find(".edui-editor-toolbarbox");i.append(t),i.find(".insert-image-plus-wp").click(function(){try{}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13209})}}),s.ajax({url:"/question/api/relatedimg",type:"GET",dataType:"json",data:{qid:e.options.extraParam&&e.options.extraParam.qid}}).done(function(e){if(e.data&&e.data.length>0){for(var t,n="",o=0;item=e.data[o];o++)t=new Image,t.src=f.autoTrans(item),n=n+'<img class="recommend-image-item" src="'+f.autoTrans(item)+'">';i.find(".recommend-images").append(n)}else i.find(".recommend-title").hide(),i.find(".recommend-images").html('<p class="no-recommend-tips">\u6682\u65e0\u63a8\u8350\u56fe\u7247</p>').css({width:"auto"})}).fail(function(){i.find(".recommend-title").hide(),i.find(".recommend-images").html('<p class="no-recommend-tips">\u6682\u65e0\u63a8\u8350\u56fe\u7247</p>').css({width:"auto"})})}),l},t.fullscreen=function(e,n){n="\u5168\u5c4f";var i=new t.Button({className:"edui-for-fullscreen",title:n,theme:e.options.theme,onclick:function(){try{e.ui&&e.ui.setFullScreen(!e.ui.isFullScreen()),this.setChecked(e.ui.isFullScreen());var t=s(e.container),n=t.find(".edui-editor-toolbarbox"),i=n.find(".insert-video-wp");i.find(".insert-video-arrow").css({left:n.find(".edui-for-insertvideo").position().left-9});var o=n.find(".insert-image-plus-wp");o.find(".trangle").css({left:n.find(".edui-for-insertimageplus").position().left+7}),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:"fullscreen"})}catch(r){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:r.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13274})}}});return t.buttons.fullscreen=i,e.addListener("selectionchange",function(){var t=e.queryCommandState("fullscreen");i.setDisabled(-1==t),i.setChecked(e.ui.isFullScreen())}),i};for(var i,o=["bold","italic"],a=0;i=o[a++];)i=i.toLowerCase(),t[i]=function(e){return function(n){var i=n.options.buttonConfig[e],o=i.title,r=(i.hoverTitle,new t.Button({className:"edui-for-"+e,title:o,onclick:function(){try{n.execCommand(e),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:e})}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13306})}},theme:n.options.theme,showText:!0}));return t.buttons[e]=r,n.addListener("selectionchange",function(t,i,o){var a=n.queryCommandState(e);-1==a?(r.setDisabled(!0),r.setChecked(!1)):o||(r.setDisabled(!1),r.setChecked(a))}),r}}(i);for(var i,o=["paragraph","blockquote"],a=0;i=o[a++];)i=i.toLowerCase(),t[i]=function(e){return function(n){var i=n.options.labelMap[e],o=new t.Button({className:"edui-for-"+e,title:i,label:i||"",onclick:function(){try{"paragraph"==e?n.execCommand(e,"p"===n.queryCommandValue("Paragraph")?"h2":"p"):n.execCommand(e),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:e})}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13351})}},theme:n.options.theme,showText:!0});return t.buttons[e]=o,n.addListener("selectionchange",function(t,i,r){var a=n.queryCommandState(e);-1==a?(o.setDisabled(!0),o.setChecked(!1)):r||(o.setDisabled(!1),o.setChecked(a))}),o}}(i);for(var l,d=["insertorderedlist","insertunorderedlist","autotypeset"],c=0;l=d[c++];)!function(e){t[e]=function(i){var o=i.options.buttonConfig[e],r=o.title,a=o.hoverTitle,s=new t.Button({className:"edui-for-"+e+" "+e,title:a,label:r||"",alwalysHoverable:!0,onmouseover:function(e){UE.ui.Popup.postHide(e)},onclick:function(){try{i.fireEvent("beforeexeccmd",e),i.execCommand(e),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:e})}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13399})}},showText:!0});return s.addListener("renderReady",function(){}),i.addListener("selectionchange",function(t,o,r){{var a=i.queryCommandState(e),l=s.getDom();n(l.id+"_body").children[1]}-1==a?(s.setDisabled(!0),s.setChecked(!1)):r||(s.setDisabled(!1),s.setChecked(a))}),s}}(l);t.insertcode=function(e){var n=e.options.buttonConfig.insertcode,i=n.title||"\u4ee3\u7801\u8bed\u8a00",o=n.hoverTitle,r=e.options.insertcode||[],a=[];
v.each(r,function(t,n){a.push({label:t,value:n,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})});var s=new t.Combox({editor:e,items:a,onselect:function(t,n){e.execCommand("insertcode",this.items[n].value)},onbuttonclick:function(){try{this.showPopup(),m.send({module:"common",page:window.location.pathname,area:"editor-btn",action:"click",btn:cmd})}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13479})}},title:o,initValue:i,className:"edui-for-insertcode",indexByValue:function(e){if(e)for(var t,n=0;t=this.items[n];n++)if(-1!=t.value.indexOf(e))return n;return-1}});return e.addListener("selectionchange",function(){s.getDom().setAttribute("title",o),s.setDisabled(!1);var t=e.queryCommandValue("insertcode");return t?(t&&(t=t.replace(/['"]/g,"").split(",")[0]),void s.setValue(t)):void s.setValue(i)}),s},t.toggleeditor=function(e){var n=e.options.buttonConfig.toggleeditor,i=n.title,o=(n.unTitle,new t.Button({className:"hideeditor",label:i}));return o.addListener("renderReady",function(){var t=o.getDom(),n=r.editor.dom.domUtils;n.on(t,"click",function(){try{n.hasClass(t,"hideeditor")?(n.removeClasses(o,["hideeditor"]),n.addClass(o,"showeditor"),e.fireEvent("hideEditor",e.ui.getDom())):n.hasClass(t,"showeditor")&&(n.removeClasses(iconBtn,["showeditor"]),n.addClass(iconBtn,"hideeditor"),e.fireEvent("showEditor",e.ui.getDom()))}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13544})}})}),o},t.insertplace=function(i){var o=i.options.buttonConfig.insertplace,r=o.title,a=o.unTitle,s=o.hoverTitle,l=new t.Button({className:"edui-for-insertplace insertplace",title:s,label:r,_onClick:function(e){try{i.options.isLoginForPlace&&i.fireEvent("showPlaceDialog","add"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13564})}},showText:!0});return l.addListener("renderReady",function(){var t=l.getDom(),o=n(t.id+"_body").children[1];i.options.isLoginForPlace?(l.onclick=function(){try{i.fireEvent("showPlaceDialog","add")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13578})}},e.removeClasses(l,["editplace"]),e.addClass(l,"insertplace"),o.innerHTML=r):(o.style.color="#999",l.onclick=function(){try{i.fireEvent("isLogout")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13574})}}),t.onclick=function(e){try{e=e||window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13586})}}}),i.addListener("addPlace",function(){var t=n(l.getDom().id+"_body").children[1];return i.options.isLoginForPlace?(l.onclick=function(){try{i.fireEvent("showPlaceDialog","edit")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13597})}},e.addClass(l,"editplace"),void(t.innerHTML=a)):(t.style.color="#999",void i.fireEvent("isLogout"))}),i.addListener("deletePlace",function(){var t=n(l.getDom().id+"_body").children[1];return i.options.isLoginForPlace?(l.onclick=function(){try{i.fireEvent("showPlaceDialog","add")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13610})}},e.removeClasses(l,["editplace"]),e.addClass(l,"insertplace"),void(t.innerHTML=r)):(t.style.color="#999",void i.fireEvent("isLogout"))}),l}}(),function(){function e(e){this.initOptions(e),this.initEditorUI()}var t=r.editor.utils,n=r.editor.ui.uiUtils,i=r.editor.ui.UIBase,a=r.editor.dom.domUtils,s=[];e.prototype={uiName:"editor",initEditorUI:function(){function e(e,t){e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var n=e.options,i=n.maximumWords,o=n.wordCountMsg,r=n.wordOverFlowMsg,a=t.getDom("wordcount");if(n.wordCount){var s=e.getContentLength(!0);s>i?(a.innerHTML=r,e.fireEvent("wordcountoverflow")):a.innerHTML=o.replace("{#leave}",i-s).replace("{#count}",s)}}try{this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars();var t=this.editor,n=this;t.addListener("ready",function(){function i(){e(t,n),a.un(t.document,"click",arguments.callee)}t.getDialog=function(e){return t.ui._dialogs[e+"Dialog"]},a.on(t.window,"scroll",function(e){r.editor.ui.Popup.postHide(e)}),t.ui._actualFrameWidth=t.options.initialFrameWidth,t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":</div>"),t.options.wordCount&&(a.on(t.document,"click",i),t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")),t.ui._scale(),t.options.scaleEnabled?(t.autoHeightEnabled&&t.disableAutoHeight(),n.enableScale()):n.disableScale(),t.options.elementPathEnabled||t.options.wordCount||t.options.scaleEnabled||(t.ui.getDom("elementpath").style.display="none",t.ui.getDom("wordcount").style.display="none",t.ui.getDom("scale").style.display="none"),t.selection.isFocus()&&t.fireEvent("selectionchange",!1,!0)}),t.addListener("mousedown",function(e,t){var n=t.target||t.srcElement;r.editor.ui.Popup.postHide(t,n)}),t.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(t),t.getDialog("edittip").open()});var i,s,l=!1;t.addListener("afterpaste",function(){t.queryCommandState("pasteplain")||(i=new r.editor.ui.Popup({content:new r.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"}),i.render(),l=!0)}),t.addListener("afterinserthtml",function(){clearTimeout(s),s=setTimeout(function(){if(i&&(l||t.ui._isTransfer)){var e=a.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),n=t.selection.getRange();n.insertNode(e);var r=o(e,"firstChild","previousSibling");i.showAnchor(3==r.nodeType?r.parentNode:r),a.remove(e),delete t.ui._isTransfer,l=!1}},200)}),t.addListener("contextmenu",function(e,t){r.editor.ui.Popup.postHide(t)}),t.addListener("keydown",function(e,t){i&&i.dispose(t);var n=t.keyCode||t.which;t.altKey&&90==n&&UE.ui.buttons.fullscreen.onclick()}),t.addListener("wordcount",function(){e(this,n)}),t.addListener("selectionchange",function(){t.options.elementPathEnabled&&n[(-1==t.queryCommandState("elementpath")?"dis":"en")+"ableElementPath"](),t.options.scaleEnabled&&n[(-1==t.queryCommandState("scale")?"dis":"en")+"ableScale"]()});var d=new r.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){try{this.hide(),t.ui._dialogs.linkDialog.open()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13787})}},_onImgEditButtonClick:function(e){try{this.hide(),t.ui._dialogs[e]&&t.ui._dialogs[e].open()}catch(n){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13792})}},_onImgSetFloat:function(e){this.hide(),t.execCommand("imagefloat",e)},_setIframeAlign:function(e){var t=d.anchorEl,n=t.cloneNode(!0);switch(e){case-2:n.setAttribute("align","");break;case-1:n.setAttribute("align","left");break;case 1:n.setAttribute("align","right")}t.parentNode.insertBefore(n,t),a.remove(t),d.anchorEl=n,d.showAnchor(d.anchorEl)},_updateIframe:function(){t._iframe=d.anchorEl,t.ui._dialogs.insertframeDialog.open(),d.hide()},_onRemoveButtonClick:function(e){try{t.execCommand(e),this.hide()}catch(n){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13825})}},queryAutoHide:function(e){return e&&e.ownerDocument==t.document&&("img"==e.tagName.toLowerCase()||a.findParentByTagName(e,"a",!0))?e!==d.anchorEl:r.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});d.render(),t.options.imagePopup&&(t.addListener("mouseover",function(e,n){n=n||window.event;var i=n.target||n.srcElement;if(t.ui._dialogs.insertframeDialog&&/iframe/gi.test(i.tagName)){var o=d.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>");o?(d.getDom("content").innerHTML=o,d.anchorEl=i,d.showAnchor(d.anchorEl)):d.hide()}}),t.addListener("selectionchange",function(e,n){if(n){var i="",o="",r=t.selection.getRange().getClosedNode(),a=t.ui._dialogs;if(r&&"IMG"==r.tagName){var s="insertimageDialog";if(-1!=r.className.indexOf("edui-faked-video")&&(s="insertvideoDialog"),-1!=r.className.indexOf("edui-faked-webapp")&&(s="webappDialog"),-1!=r.src.indexOf("http://api.map.baidu.com")&&(s="mapDialog"),-1!=r.className.indexOf("edui-faked-music")&&(s="musicDialog"),-1!=r.src.indexOf("http://maps.google.com/maps/api/staticmap")&&(s="gmapDialog"),r.getAttribute("anchorname")&&(s="anchorDialog",i=d.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"</span></nobr>")),r.getAttribute("word_img")&&(t.word_img=[r.getAttribute("word_img")],s="wordimageDialog"),!a[s])return;o="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+s+'\');" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>",!i&&(i=d.formatHtml(o))}if(t.ui._dialogs.linkDialog){var l,c=t.queryCommandValue("link");if(c&&(l=c.getAttribute("_href")||c.getAttribute("href",2))){var u=l;l.length>30&&(u=l.substring(0,20)+"..."),i&&(i+='<div style="height:5px;"></div>'),i+=d.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+l+'" title="'+l+'" >'+u+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"</span></nobr>"),d.showAnchor(c)}}i?(d.getDom("content").innerHTML=i,d.anchorEl=r||c,d.showAnchor(d.anchorEl)):d.hide()}}))}catch(c){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:c.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13928})}},_initToolbars:function(){try{for(var e=this.editor,t=this.toolbars||[],n=[],i=0;i<t.length;i++){for(var o=t[i],a=new r.editor.ui.Toolbar({theme:e.options.theme}),s=0;s<o.length;s++){var l=o[s],d=null;if("string"==typeof l){if(l=l.toLowerCase(),"|"==l&&(l="Separator"),r.editor.ui[l]&&(d=new r.editor.ui[l](e)),"fullscreen"==l){n&&n[0]?n[0].items.splice(0,0,d):d&&a.items.splice(0,0,d);continue}}else d=l;d&&d.id&&a.add(d)}n[i]=a}this.toolbars=n}catch(c){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:c.message,path:"common:widget/js/logic/editor/editor.js",method:"",ln:13971})}},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img"),this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var e=[],t=0;t<this.toolbars.length;t++)e.push(this.toolbars[t].renderHtml());return e.join("")},setFullScreen:function(e){var t=this.editor,n=t.container.parentNode.parentNode;if(this._fullscreen!=e){if(this._fullscreen=e,this.editor.fireEvent("beforefullscreenchange",e),r.editor.browser.gecko)var i=t.selection.getRange().createBookmark();if(e){for(;"BODY"!=n.tagName;){var o=r.editor.dom.domUtils.getComputedStyle(n,"position");s.push(o),n.style.position="static",n=n.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakEditorContaninerWidth=t.iframe.parentNode.offsetWidth,this._bakAutoHeight&&(t.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,t.iframe.parentNode.style.width="",this._updateFullScreen()}else{for(;"BODY"!=n.tagName;)n.style.position=s.shift(),n=n.parentNode;this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(t.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,window.scrollTo(0,this._bakScrollTop)}if(r.editor.browser.gecko&&"true"===t.body.contentEditable){var a=document.createElement("input");document.body.appendChild(a),t.body.contentEditable=!1,setTimeout(function(){a.focus(),setTimeout(function(){t.body.contentEditable=!0,t.selection.getRange().moveToBookmark(i).select(!0),r.editor.dom.domUtils.remove(a),e&&window.scroll(0,0)},0)},0)}"true"===t.body.contentEditable&&(this.editor.fireEvent("fullscreenchanged",e),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var e=n.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(1*this.getDom().style.zIndex+1e3),n.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0)-80),p.gecko&&window.onresize()}},_updateElementPath:function(){var e,t=this.getDom("elementpath");if(this.elementPathEnabled&&(e=this.editor.queryCommandValue("elementpath"))){for(var n,i=[],o=0;n=e[o];o++)i[o]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+o+'&quot;);">'+n+"</span>");t.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+i.join(" &gt; ")+"</div>"}else t.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="",e.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var e=this.getDom("elementpath");e.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},_scale:function(){function e(){h=a.getXY(s),g||(g=r.options.minFrameHeight+d.offsetHeight+c.offsetHeight),f.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+s.offsetWidth+"px;height:"+s.offsetHeight+"px;z-index:"+(r.options.zIndex+1),a.on(o,"mousemove",t),a.on(l,"mouseup",n),a.on(o,"mouseup",n)}function t(e){i();var t=e||window.event;y=t.pageX||o.documentElement.scrollLeft+t.clientX,b=t.pageY||o.documentElement.scrollTop+t.clientY,C=y-h.x,N=b-h.y,C>=v&&(m=!0,f.style.width=C+"px"),N>=g&&(m=!0,f.style.height=N+"px")}function n(){m&&(m=!1,r.ui._actualFrameWidth=f.offsetWidth-2,s.style.width=r.ui._actualFrameWidth+"px",r.setHeight(f.offsetHeight-c.offsetHeight-d.offsetHeight-2)),f&&(f.style.display="none"),i(),a.un(o,"mousemove",t),a.un(l,"mouseup",n),a.un(o,"mouseup",n)}function i(){p.ie?o.selection.clear():window.getSelection().removeAllRanges()}var o=document,r=this.editor,s=r.container,l=r.document,d=this.getDom("toolbarbox"),c=this.getDom("bottombar"),u=this.getDom("scale"),f=this.getDom("scalelayer"),m=!1,h=null,g=0,v=r.options.minFrameWidth,y=0,b=0,C=0,N=0,w=this;this.editor.addListener("fullscreenchanged",function(e,t){if(t)w.disableScale();else if(w.editor.options.scaleEnabled){w.enableScale();var n=w.editor.document.createElement("span");w.editor.body.appendChild(n),w.editor.body.style.height=Math.max(a.getXY(n).y,w.editor.iframe.offsetHeight-20)+"px",a.remove(n)}}),this.enableScale=function(){1!=r.queryCommandState("source")&&(u.style.display="",this.scaleEnabled=!0,a.on(u,"mousedown",e))},this.disableScale=function(){u.style.display="none",this.scaleEnabled=!1,a.un(u,"mousedown",e)}},isFullScreen:function(){return this._fullscreen},postRender:function(){i.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();var t,n=this,o=r.editor.dom.domUtils,a=function(){clearTimeout(t),t=setTimeout(function(){n._updateFullScreen()})};o.on(window,"resize",a),n.addListener("destroy",function(){o.un(window,"resize",a),clearTimeout(t)})},showToolbarMsg:function(e,t){if(this.getDom("toolbarmsg_label").innerHTML=e,this.getDom("toolbarmsg").style.display="",!t){var n=this.getDom("upload_dialog");n.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();e.style.zoom="1"==e.style.zoom?"100%":"1"}},t.inherits(e,r.editor.ui.UIBase);var l={};UE.ui.Editor=function(n){var i=new r.editor.Editor(n);i.options.editor=i,null!==i.options.themePath&&t.loadFile(document,{href:i.options.themePath+i.options.theme+"/_css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var o=i.render;return i.render=function(t){function n(){if(i.setOpt({labelMap:i.options.labelMap||i.getLang("labelMap")}),new e(i.options),t&&(t.constructor===String&&(t=document.getElementById(t)),t&&t.getAttribute("name")&&(i.options.textarea=t.getAttribute("name")),t&&/script|textarea/gi.test(t.tagName))){var n=document.createElement("div");t.parentNode.insertBefore(n,t);var r=t.value||t.innerHTML;i.options.initialContent=/^[\t\r\n ]*$/.test(r)?i.options.initialContent:r.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),t.className&&(n.className=t.className),t.style.cssText&&(n.style.cssText=t.style.cssText),/textarea/i.test(t.tagName)?(i.textarea=t,i.textarea.style.display="none"):(t.parentNode.removeChild(t),t.id&&(n.id=t.id)),t=n,t.innerHTML=""}a.addClass(t,"edui-"+i.options.theme),i.ui.render(t);var s=i.options;i.container=i.ui.getDom();for(var l,d=a.findParents(t,!0),c=[],u=0;l=d[u];u++)c[u]=l.style.display,l.style.display="block";s.minFrameWidth=s.initialFrameWidth?s.initialFrameWidth:s.initialFrameWidth=t.offsetWidth,s.initialFrameHeight?s.minFrameHeight=s.initialFrameHeight:s.initialFrameHeight=s.minFrameHeight=t.offsetHeight;for(var l,u=0;l=d[u];u++)l.style.display=c[u];t.style.height&&(t.style.height=""),i.container.style.width=s.initialFrameWidth+"px",i.container.style.zIndex=s.zIndex,o.call(i,i.ui.getDom("iframeholder"))}t.constructor===String&&(i.key=t,l[t]=i),i.langIsReady?n():i.addListener("langReady",n)},i},UE.getEditor=function(e,t){var n=l[e];return n||(n=l[e]=new UE.ui.Editor(t),n.render(e)),n},UE.delEditor=function(e){var t;(t=l[e])&&(t.key&&t.destroy(),delete l[e])}}(),UE.plugins.iknowFilter=function(){this.addOutputRule(function(e){e.traversal(function(e){switch(e.tagName){case"img":var t=e.getAttr("src"),n=e.getAttr("_src"),i=e.getAttr("data_ue_src");e.setAttr(),t&&e.setAttr("src",t),n&&e.setAttr("_src",n),i&&e.setAttr("src",i)}})})},n.exports=UE.ui.Editor,n.exports.config=l}()});
;define("common:widget/js/logic/editor/addon/addon.js",function(n,t,e){function o(){var t=p("<div/>").addClass("ik-authcode-outer").appendTo(c).hide(),e=n("common:widget/js/logic/authcode/authcode.js"),o=!1;r.instance.addListener("focus",function(){o||(r.config.optionList.modify=!0,r.authcode||(r.authcode=new e({container:t,from:u.authcode})),o=!0)})}function a(){var n=p('<a href="#"/>').addClass("btn-32-green grid-r new-editor-deliver-btn").html(u.submitBtn||"\u786e\u5b9a").appendTo(c);return("answer"==r.type||"modifyanswer"==r.type)&&n.attr("alog-action","qb-ans-sb"),n}function d(){var n=p('<input type="checkbox" name="md" />');return p("<label/>").addClass("unname").attr({"alog-action":"qb-unname"}).append(n).append(p("<span/>").html("\u533f\u540d")).appendTo(c),n}function i(){return p("<p/>").html(u.text).appendTo(c)}function s(n){n&&n.config&&n.style&&(r=n,u=n.style.addons,c=r.addonsContainer=p("<div/>").addClass("addons line").appendTo(r.container),u.authcode&&o(),u.submitBtn&&(r.submitBtn=a()),u.anonymouse&&n.style.isLogin&&(r.anonymouse=d()),u.text&&(r.addtext=i()))}var r,c,u,p=n("common:widget/lib/jquery/jquery.js");e.exports.init=s});
;define("common:widget/js/logic/editor/config/config.js",function(e,t,i){var a=(e("common:widget/lib/jquery/jquery.js"),e("common:widget/js/util/uri/uri.js")),l=['body{margin:0;padding:16px 18px;font:14px/20px arial,"\\5B8B\\4F53";cursor:text;font-family:"Microsoft YaHei",arial,courier new,courier,"b8bf53",monospace;}',"p{margin:0;padding:0;cursor:text;word-wrap:break-word;line-height:29px;}","p img{vertical-align:bottom;*vertical-align:-3px;}","img{border:0;}","iframe{width:430px;height:310px;border:1px solid #ccc;}","#initContent{color:#ccc;}","ol,ul{margin-top:0;margin-bottom:0;margin-left:0;padding-left:2em;}","ol{*margin-left:2px;}","body.view{padding:6px 8px;}","strong{font-weigth:bold;}","em{font-style:normal;font-style: italic;}","strong em, em strong{font-style: italic;}","blockquote{margin:0;border-left:5px solid #dae0e4;padding-left:20px;color:#888;}","h2{font-size:16px;}","::-webkit-scrollbar{display:none;}"],o=["\u767b\u5f55\u5c31\u80fd\u4f20\u56fe\u7247\uff0c\u56fe\u6587\u89e3\u7b54\u66f4\u6587\u827a","\u767b\u5f55\u5c31\u80fd\u7528\u7b26\u53f7\uff0c\u91cd\u8981\u5185\u5bb9\u597d\u5f3a\u8c03","\u767b\u5f55\u5c31\u80fd\u7528\u7f16\u53f7\uff0c\u6bb5\u843d\u5c42\u6b21\u66f4\u6e05\u6670","\u767b\u5f55\u5c31\u80fd\u81ea\u6392\u7248\uff0c\u51cc\u4e71\u5e03\u5c40\u53d8\u6574\u6d01","\u767b\u5f55\u5c31\u80fd\u63d2\u5730\u56fe\uff0c\u5730\u7406\u4f4d\u7f6e\u597d\u793a\u610f","\u642d\u914d\u56fe\u7247\u6765\u89e3\u7b54, \u77ac\u95f4\u51f8\u663e\u6587\u827a\u8303\u513f","\u4f7f\u7528\u7b26\u53f7\u6765\u5f3a\u8c03\uff0c\u91cd\u8981\u5185\u5bb9\u7acb\u4f53\u73b0","\u4f7f\u7528\u7f16\u53f7\u6807\u6bb5\u843d\uff0c\u5c42\u6b21\u7a81\u51fa\u6761\u7406\u6e05","\u667a\u80fd\u6392\u7248\u4e00\u952e\u6309\uff0c\u51cc\u4e71\u5e03\u5c40\u53d8\u6574\u6d01","\u63d2\u5165\u5730\u56fe\u597d\u793a\u610f\uff0c\u5730\u7406\u4f4d\u7f6e\u8f7b\u677e\u627e","\u60a8\u4eca\u65e5\u4e0a\u4f20\u7684\u56fe\u7247\u6570\u76ee\u5df2\u7ecf\u8d85\u8fc7\u9650\u5236\uff01","\u4e0a\u4f20\u7f51\u76d8\u5171\u5206\u4eab\uff0c\u4f20\u9012\u77e5\u8bc6\u52a9\u5927\u5bb6","\u767b\u5f55\u5c31\u80fd\u4f20\u9644\u4ef6\uff0c\u5206\u4eab\u77e5\u8bc6\u52a9\u5927\u5bb6"],r=window.location.pathname,n=window.UEDITOR_HOME_URL||r.substr(0,r.lastIndexOf("/")+1).replace("_examples/","").replace("website/",""),s="",p={ikEditorHoverTitle:o,imageUrl:s+"/submit/ajax/",imageFieldName:"image",imagePath:"",imageMaxSize:"5",waitImageUrl:"https://gss0.bdstatic.com/70cFsjip0QIZ8tyhnq/img/iknow/editor/uploading.gif",indexFlagFieldName:"position",flashUrl:a.zhidaoSwf,imgFlashWidth:48,imgFlashHeight:22,maxImagesCount:20,langPath:null,themePath:null,webuploaderSwf:a.webuploaderSwf,customObj:{width:650,height:867,cm:100672,encryptedBDUSS:F.context("user").encryptedBDUSS||null},heightIncrement:0,isLogin:!0,acceptImageType:"*.jpg;*.png;*.gif;*.bmp",className:"iknow-editor",autoSaveEnabled:!0,autoSaveFrequency:60,isnewtipshow:!1,toolbars:[["insertimage","|","insertunorderedlist","|","insertorderedlist","|","autotypeset","|","insertmap"]],buttonConfig:{insertimage:{title:"\u56fe\u7247",hoverTitle:"\u63d2\u5165\u56fe\u7247"},insertimageplus:{title:"\u56fe\u7247",hoverTitle:"\u63d2\u5165\u56fe\u7247"},insertunorderedlist:{title:"\u7b26\u53f7",hoverTitle:"\u7b26\u53f7\u5217\u8868"},insertorderedlist:{title:"\u7f16\u53f7",hoverTitle:"\u7f16\u53f7\u5217\u8868"},autotypeset:{title:"\u6392\u7248",hoverTitle:"\u6392\u7248"},insertmap:{title:"\u5730\u56fe",unTitle:"\u5730\u56fe",hoverTitle:"\u5730\u56fe",url:a.map},attachment:{list:{uploadfile:"\u672c\u5730\u4e0a\u4f20",wangpan:"\u7f51\u76d8\u6dfb\u52a0"},title:"\u9644\u4ef6",hoverTitle:"\u6dfb\u52a0\u9644\u4ef6"},insertcode:{title:"\u4ee3\u7801",hoverTitle:"\u63d2\u5165\u4ee3\u7801"},bold:{title:"\u52a0\u7c97",hoverTitle:"\u52a0\u7c97"},italic:{title:"\u659c\u4f53",hoverTitle:"\u659c\u4f53"},title:{title:"\u6807\u9898",hoverTitle:"\u6807\u9898"},insertvideo:{title:"\u89c6\u9891",hoverTitle:"\u4e0a\u4f20\u89c6\u9891"}},insertcode:{bash:"Bash/Shell",cpp:"C/C++",css:"Css",csharp:"C#",delphi:"Delphi",groovy:"Groovy",html:"Html",java:"Java",js:"Javascript",pl:"Perl",php:"Php",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"},initialStyle:l.join(""),iframeCssUrl:"",initialContent:"",autoClearinitialContent:!0,maxUndoCount:20,maxInputCount:20,pasteplain:!0,textarea:"editorValue",focus:!1,minFrameHeight:300,maxFrameHeight:600,initialFrameHeight:300,initialMaxFrameHeight:600,autoHeightEnabled:!0,enterTag:"p",wordCount:!0,maximumWords:1499,tabSize:4,tabNode:"&nbsp;",zIndex:0,readonly:!1,messages:{wordCountMsg:"\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165{#leave} \u4e2a\u5b57",wordOverFlowMsg:"\u8f93\u5165\u5185\u5bb9\u5df2\u7ecf\u8fbe\u5230\u957f\u5ea6\u9650\u5236\uff0c\u8bf7\u5220\u51cf"},autotypeset:{mergeEmptyline:!0,indent:!0,indentValue:"2em"},serialize:{blackList:{style:1,link:1,object:1,applet:1,input:1,meta:1,base:1,button:1,select:1,textarea:1,"#comment":1,map:1,area:1}},UEDITOR_HOME_URL:n,swfUploadFlashUrl:a.fileUploaderSwf,swfUploadUrl:"https://pcs.baidu.com/rest/2.0/pcs/file?method=upload&app_id=598913&response-status=200&ondup=newcopy",swfUploadDir:"/apps/\u767e\u5ea6\u77e5\u9053/",swfUploadPostName:"file",WP_KEY:"598913",wealthList:[{key:"0",value:"\u514d\u8d39"},{key:"1",value:"1 \u8d22\u5bcc\u503c"},{key:"2",value:"2 \u8d22\u5bcc\u503c"},{key:"3",value:"3 \u8d22\u5bcc\u503c"},{key:"4",value:"4 \u8d22\u5bcc\u503c"},{key:"5",value:"5 \u8d22\u5bcc\u503c"}],imgErrorNum:{0:"\u56fe\u7247\u63d0\u4ea4\u6210\u529f",1:'<p class="ik-neweditor-clew">\u56fe\u7247\u63d0\u4ea4\u5931\u8d25\uff01</p>',2:'<p class="ik-neweditor-clew">\u56fe\u7247\u4eca\u65e5\u4e0a\u4f20\u5f20\u6570\u8d85\u9650\uff01</p>',3:'<p class="ik-neweditor-clew">\u56fe\u7247\u6587\u4ef6\u8fc7\u5927\uff01</p>',4:' <p class="ik-neweditor-clew">\u56fe\u7247\u7c7b\u578b\u9519\u8bef\uff01</p><p class="ik-neweditor-clewmore">\u6ce8\uff1a\u5927\u5c0f\u4e0d\u8d85\u8fc75M\uff0c\u652f\u6301JPG/PNG/BMP/GIF\u7b49\u683c\u5f0f</p>',13:'<p class="ik-neweditor-clew">\u60a8\u6ca1\u6709\u7ed1\u5b9a\u624b\u673a\u53f7\uff01</p>',265:'<p class="ik-neweditor-clew">\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u60a8\u767b\u5f55\u6216\u6ce8\u518c\u540e\u63d0\u4ea4\u56de\u7b54\uff01</p>'},labelMap:{paragraph:"\u6807\u9898",blockquote:"\u5f15\u7528"}};i.exports=p});
;define("common:widget/js/logic/editor/fileUploader/fileUploader.js",function(require,exports,module){function FileProgress(e,s){this.swfupload=s,this.getIconName=function(e){var s={icon_file_image:"jpg,jpeg,gif,bmp,png,jpe,cur,svg,svgz,tif,tiff,ico",icon_file_visio:"vsd,vsdx",icon_file_pdf:"pdf",icon_file_word:"doc,docx,ods,ots,odt,rtf,dot,dotx,odm",icon_file_excel:"xls,xlsx,xlt,xltx,csv",icon_file_text:"txt,html,htm,xhtml,xml,js,css",icon_file_music:"wma,wav,mp3,aac,ra,ram,mp2,ogg,aif,mpega,amr,mid,midi",icon_file_video:"wmv,rmvb,mpeg4,mpeg2,flv,avi,3gp,mpga,qt,rm,wmz,wmd,wvx,wmx,wm,swf,mpg,mp4,mkv,mpeg,mov",icon_file_powerpoint:"ppt,pptx,pps,pot,ppsx,potx",icon_file_ipa:"ipa",icon_file_exe:"exe,msi",icon_file_zip:"zip,rar,7z,tar,gz",icon_file_apk:"apk",icon_file_default:"default",icon_file_torrent:"torrent"},t={};for(i in s){var r=s[i].split(",");for(j in r)t.hasOwnProperty(r[j]),void 0==t[r[j]]&&(t[r[j]]=i)}return t[e.toLowerCase()]?t[e.toLowerCase()]:t["default"]},this.getShortName=function(e,s){s||(s=27);for(var t=0,r=0;t<e.length&&(null!=e.charAt(t).match(/[^\x00-\xff]/g)?r+=2:r++,!(r>s));t++);return e.substr(0,t)+(t>=e.length?"":"...")},this.getFileSize=function(e){var s=["B","K","M","G","T"],t=Math.min(Math.max(Math.floor(Math.log(e)/Math.LN2/10),1),5);return Math.round(100*e/Math.pow(2,10*t))/100+s[t]},this.fileProgressWrapper=document.getElementById(s.customSettings.progressTarget).firstChild,this.fileIcon=T(".fileIcon",this.fileProgressWrapper)[0],this.progressName=T(".progressName",this.fileProgressWrapper)[0],this.progressSize=T(".progressSize",this.fileProgressWrapper)[0],this.progressRename=T(".progressRename",this.fileProgressWrapper)[0],this.progressRenameValue=T(".progressRenameValue",this.fileProgressWrapper)[0],this.progressMessage=T(".progressMessage",this.fileProgressWrapper)[0],this.progressBarWrapper=T(".progressBarWrapper",this.fileProgressWrapper)[0],this.progressBar=T(".progressBar",this.fileProgressWrapper)[0],this.progressBarText=T(".progressBarText",this.fileProgressWrapper)[0],this.progressCancel=T(".progressCancel",this.fileProgressWrapper)[0],this.progressWealthWrapper=T(".progressWealthWrapper",this.fileOperator)[0],this.fileOperator=T(".progressFileOperator",this.fileProgressWrapper)[0],this.fileOperatorRename=T("a.rename",this.fileOperator)[0],this.fileOperatorDelete=T("a.remove",this.fileOperator)[0],this.setFileInfo(e.name,e.size)}var T=require("common:widget/js/util/tangram/tangram.js"),Dialog=require("common:widget/js/ui/dialog/dialog.js"),SWFUpload=require("common:widget/lib/swfupload/swfupload.js");FileProgress.prototype.setFileInfo=function(e,s,t){var r;t||(this.progressName.innerHTML=this.getShortName(e,27),this.progressName.setAttribute("title",e)),this.swfupload.customSettings.currentFile&&(this.swfupload.customSettings.currentFile.name=e),null!=s&&(this.progressSize.innerHTML="("+this.getFileSize(s)+")"),r=e.match(/\.([^\.]+)$/),this.fileIcon.className=null!=r?"fileIcon "+this.getIconName(r[1]):"fileIcon "+this.getIconName("")},FileProgress.prototype.setStatus=function(e,s,t,r){var o,i="",a=this.swfupload;switch(this.progressMessage.innerHTML=s||"",e){case"ready":a.customSettings.setBindUploadStatus("ready"),i="1,1,1,0,0,0,0,1,1,1";break;case"uploading":void 0!=r&&(this.progressMessage.innerHTML=r,this.progressBar.style.width=r+"%",this.progressBarText.innerHTML=(r>=100?99:r)+"%"),this.progressBar.className="progressBar",this.fileProgressWrapper.className="progressWrapper",a.customSettings.setBindUploadStatus("uploading"),i="1,1,1,0,0,1,1,0,0,0";break;case"finish":this.progressBar.style.width="99%",this.progressBarText.innerHTML="99%",a.customSettings.setBindUploadStatus("finish"),i="1,1,1,0,0,1,1,0,0,0";break;case"complete":this.progressBar.style.width="",this.progressBarText.innerHTML="100%",this.progressBar.className="progressBar progressBarComplete",a.customSettings.setBindUploadStatus("complete"),i="1,1,1,0,0,1,0,1,1,1",a.customSettings.setEditorStatusBar("");break;case"error":this.progressBar.style.width="",this.fileProgressWrapper.className="progressWrapper progressWrapperError",void 0!=t?a.customSettings.setBindUploadStatus("error",t):a.customSettings.setBindUploadStatus("error",-1),i="1,1,1,0,1,0,0,0,0,1";break;case"setfilesuccess":this.progressBar.style.width="",this.progressBarText.innerHTML="100%",this.progressBar.className="progressBar",a.customSettings.setBindUploadStatus("complete"),i="1,1,1,0,0,1,0,1,1,1";break;case"setfileerror":this.fileProgressWrapper.className="progressWrapper progressWrapperError",this.progressMessage.innerHTML=s,a.customSettings.setBindUploadStatus("error",-1),i="0,0,0,0,1,0,0,0,0,1";break;case"renamestart":i="1,0,0,1,0,0,0,0,0,0";break;case"renamecomplete":a.customSettings.setBindUploadStatus("complete"),i="1,1,1,0,0,1,0,1,1,1";break;case"renameerror":this.fileProgressWrapper.className="progressWrapper progressWrapperError",a.customSettings.setBindUploadStatus("error",-1),i="1,0,0,1,1,0,0,0,0,0";break;default:i="1,1,1,0,0,0,0,0,0,0"}o=i.split(","),a.customSettings.isEditorFile&&(o[5]=0),this.fileIcon.style.display="1"==o[0]?"block":"none",this.progressName.style.display="1"==o[1]?"block":"none",this.progressSize.style.display="1"==o[2]?"block":"none",this.progressRename.style.display="1"==o[3]?"block":"none",this.progressMessage.style.display="1"==o[4]?"block":"none",this.progressBarWrapper.style.display="1"==o[5]?"block":"none",this.progressCancel.style.display="1"==o[6]?"block":"none",this.progressWealthWrapper.style.display="1"==o[7]?"block":"none",this.fileOperatorRename.style.display="1"==o[8]?"inline":"none",this.fileOperatorDelete.style.display="1"==o[9]?"inline":"none",this.fileProgressWrapper.style.display="block"},window.swfUploadPreLoad=function(){},window.swfUploadLoaded=function(){try{SWFUpload.SERVER_ERROR={31042:"\u60a8\u5c1a\u672a\u767b\u5f55",31061:"\u5df2\u5b58\u5728\u540c\u540d\u6587\u4ef6",31062:"\u6587\u4ef6\u540d\u79f0\u975e\u6cd5",31073:"\u91cd\u547d\u540d\u5931\u8d25",31218:"\u5bb9\u91cf\u8d85\u51fa\u9650\u989d"};var e=this;e.customSettings.cancelHandler=function(s){var t=e.progress;s.preventDefault(),e.cancelUpload(e.customSettings.currentFile.id),e.customSettings.successCount=0,e.customSettings.isUploading=!1,t.setStatus("ready"),T(t.fileProgressWrapper).hide()},e.customSettings.deleteHandler=function(s){var t=e.progress,r=e.customSettings.getUploadFile();if(s.preventDefault(),e.customSettings.successCount=0,e.customSettings.setUploadFile("fileInfo",null),t.setStatus("ready"),T(t.fileProgressWrapper).hide(),e.customSettings.isEditorFile)e.customSettings.setUploadFile("backFileInfo",!0,"delete");else{var o=e.customSettings.swfUploadDir;r&&r.path.substr(0,o.length)==o&&!e.customSettings.isInsertFromWangPan&&T.ajax({url:encodeURI("https://pcs.baidu.com/rest/2.0/pcs/file?method=delete&app_id=598913&response-status=200&op=permanent&fs_id="+r.fs_id),dataType:"jsonp",success:function(){}})}e.customSettings.setEditorStatusBar("")},e.customSettings.inputHandler=function(s){13==s.keyCode&&e.customSettings.doRenameHandler()},e.customSettings.renameHandler=function(s){var t=e.progress;s.preventDefault(),t.setStatus("renamestart"),t.progressRenameValue.value=t.progressName.title,function(e,s,t){if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),r.moveStart("character",s),r.moveEnd("character",t),r.select()}else e.setSelectionRange?e.setSelectionRange(s,t):e.selectionStart&&(e.selectionStart=s,e.selectionEnd=t)}(t.progressRenameValue,0,t.progressRenameValue.value.lastIndexOf(".")),t.progressRenameValue.focus()},e.customSettings.doRenameHandler=function(){var s=e.progress,t=T.string(s.progressRenameValue.value).trim();if(/\.((jpg)|(jpeg)|(gif)|(bmp)|(png)|(jpe)|(cur)|(tif)|(tiff)|(ico))$/i.test(t))s.setStatus("renameerror","\u4e0d\u5141\u8bb8\u6539\u6210\u56fe\u7247\u683c\u5f0f");else if(/[\\\/:\*\?"<>|]/.test(t))s.setStatus("renameerror",'\u6587\u4ef6\u540d\u4e0d\u80fd\u5305\u542b\u4e0b\u5217\u5b57\u7b26 \\ / : * ? " < > |');else{var r=s.progressName.title,o=e.customSettings.getUploadFile().path,i=o.substr(0,o.lastIndexOf("/")+1)+t;o!=i&&e.customSettings.isEditorFile?(e.customSettings.setUploadFile("backFileInfo",i,"rename"),s.setFileInfo(t),s.setStatus("renamecomplete")):""!=t&&t!=r.substr(r.lastIndexOf(".")+1)&&t!=r&&i!=o?T.ajax({url:encodeURI("https://pcs.baidu.com/rest/2.0/pcs/file?method=move&app_id=598913&response-status=200&from="+o+"&to="+i),dataType:"jsonp",success:function(r){r.error_code?31218==r.error_code||31112==r.error_code?s.setStatus("renameerror",'<span>\u7f51\u76d8\u5df2\u6ee1</span><a href="http://yun.baidu.com/disk/award" class="progressExtend" target="_blank">\u6269\u5bb9</a>'):s.setStatus("renameerror",SWFUpload.SERVER_ERROR[r.error_code]):(s.setStatus("renamecomplete"),s.setFileInfo(t),e.progress.setFileInfo(t),e.customSettings.setUploadFile("fileInfo",i,"path"))}}):s.setStatus("complete")}};var s=document.getElementById(e.customSettings.progressTarget).firstChild,t=T(".progressCancel",s)[0],r=T(".progressRenameValue",s)[0],o=T(".progressRenameBtn",s)[0],i=T(".progressFileOperator a",s)[0],a=T(".progressFileOperator a",s)[1];T(t).on("click",e.customSettings.cancelHandler),T(i).on("click",e.customSettings.renameHandler),T(r).on("keyup",e.customSettings.inputHandler),T(o).on("click",e.customSettings.doRenameHandler),T(a).on("click",e.customSettings.deleteHandler),e.customSettings.isEditorFile?e.customSettings.getUploadFile()?e.customSettings.setBindUploadStatus("complete"):e.customSettings.setBindUploadStatus("error",-1):e.customSettings.setBindUploadStatus("ready")}catch(n){}},window.swfUploadLoadFailed=function(){},window.swfUploadFileDialogStart=function(){},window.swfUploadFileDialogComplete=function(){var e=this;e.customSettings.hideAllPopup()},window.swfUploadFileQueued=function(e){try{var s=this;if(/\.((jpg)|(jpeg)|(gif)|(bmp)|(png)|(jpe)|(cur)|(tif)|(tiff)|(ico))$/i.test(e.type))Dialog.alert("\u8bf7\u4f7f\u7528\u63d2\u5165\u56fe\u7247\u529f\u80fd\uff0c\u53ef\u76f4\u63a5\u5728\u7ebf\u9884\u89c8");else if(s.customSettings.successCount>0||1==s.customSettings.isUploading)var t=Dialog.confirm('<div class="f-14"><img class="grid" src="https://gss0.bdstatic.com/70cFsjip0QIZ8tyhnq/img/iknow/feedback/icon-question.png"><p>\u60a8\u53ea\u80fd\u4e0a\u4f20\u4e00\u4e2a\u9644\u4ef6\uff0c\u4e0a\u4e00\u9644\u4ef6\u5c06\u88ab\u8986\u76d6\uff0c\u786e\u5b9a\u5417\uff1f</p><p class="f-12 f-gray pl-20">\uff08\u5982\u679c\u60f3\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\uff0c\u8bf7\u6253\u5305\uff09</p></div>',{width:400,height:165,title:"\u77e5\u9053\u63d0\u793a",onaccept:function(){try{t.hide();var r=s.customSettings.getUploadFile();if(s.progress=new FileProgress(e,s),s.customSettings.setUploadFile("fileInfo",null),s.customSettings.successCount=0,s.customSettings.isEditorFile)s.customSettings.setUploadFile("backFileInfo",!0,"delete");else{var o=s.customSettings.swfUploadDir;r&&r.path.substr(0,o.length)==o&&!s.customSettings.isInsertFromWangPan&&T.ajax({url:encodeURI("https://pcs.baidu.com/rest/2.0/pcs/file?method=delete&app_id=598913&response-status=200&op=permanent&fs_id="+r.fs_id),dataType:"jsonp",success:function(){}})}s.cancelUpload(s.customSettings.currentFile.id,!1),s.startUpload()}catch(i){}},oncancel:function(){try{t.hide(),s.cancelUpload(e.id,!1)}catch(r){}}});else s.progress=new FileProgress(e,s),s.startUpload()}catch(r){}},window.swfUploadQueueComplete=function(){},window.swfUploadFileQueueError=function(e,s){try{var t,r=this;switch(t=r.progress?r.progress:r.progress=new FileProgress(e,r),r.customSettings.setBindUploadStatus("error",-1),r.customSettings.isUploading=!1,s){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:t.setStatus("error","\u6587\u4ef6\u8d85\u8fc72G\u6216\u4e3a\u7a7a");break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:t.setStatus("error","\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u4e0d\u5141\u8bb8");break;default:null!==e&&t.setStatus("error","\u4e0a\u4f20\u5931\u8d25\u8bf7\u91cd\u8bd5\u6216\u5220\u9664")}}catch(o){}},window.swfUploadSendStart=function(e){try{var s=this,t=F.context("user").ECBD||null,r=s.progress;s.customSettings.isUploading=!1,s.customSettings.isEditorFile=!1,s.customSettings.isInsertFromWangPan=!1,s.customSettings.currentFile=e,t?(r.setStatus("uploading","",null,0),s.setUploadURL(encodeURI(s.customSettings.swfUploadUrl+"&path="+s.customSettings.swfUploadDir+e.name+"&ecbd="+encodeURIComponent(t)))):(r.setStatus("error","\u60a8\u5c1a\u672a\u767b\u5f55"),s.cancelUpload(e.id,!1))}catch(o){}return!0},window.swfUploadSendProgress=function(e,s,t){try{var r=this,o=r.progress,i=Math.ceil(s/t*100);r.customSettings.isUploading=!0,100!=i?o.setStatus("uploading","",null,i):o.setStatus("finish")}catch(a){}},window.swfUploadSendSuccess=function(file,serverData){try{var swfupload=this,progress=swfupload.progress,error_message,fileinfo=eval("("+serverData+")");if(swfupload.customSettings.isUploading=!1,31218==fileinfo.error_code||31112==fileinfo.error_code)progress.setStatus("error",'<span>\u7f51\u76d8\u5df2\u6ee1</span><a href="http://yun.baidu.com/disk/award" class="progressExtend" target="_blank">\u6269\u5bb9</a>',fileinfo.error_code);else if(fileinfo.error_code)error_message=SWFUpload.SERVER_ERROR[fileinfo.error_code],error_message||(error_message="\u4e0a\u4f20\u5931\u8d25"),progress.setStatus("error",error_message+",\u8bf7\u91cd\u8bd5\u6216\u8005\u5220\u9664",fileinfo.error_code);else{var serverFileName=fileinfo.path.substr(fileinfo.path.lastIndexOf("/")+1);serverFileName!=swfupload.customSettings.currentFile.name&&progress.setFileInfo(serverFileName,null,!0),progress.setStatus("complete"),swfupload.customSettings.successCount++,swfupload.customSettings.setUploadFile("fileInfo",fileinfo)}}catch(ex){var swfupload=this,progress=swfupload.progress;"SyntaxError"==ex.name&&progress.setStatus("error","\u4e0a\u4f20\u5931\u8d25\u8bf7\u91cd\u8bd5\u6216\u5220\u9664")}},window.swfUploadSendError=function(e,s){try{var t=this,r=t.progress;s!=SWFUpload.UPLOAD_ERROR.FILE_CANCELLED&&(t.customSettings.setBindUploadStatus("error",-1),r.setStatus("error","\u4e0a\u4f20\u5931\u8d25\u8bf7\u91cd\u8bd5\u6216\u5220\u9664"))}catch(o){}},window.swfUploadSendComplete=function(){},window.editorSetUploadFile=function(e,s,t){var r=t.swfupload;if(r&&r.customSettings.successCount>0,e&&!e.error){var o=e.fileInfo;o.path=decodeURIComponent(o.path);var i=o.path.substr(o.path.lastIndexOf("/")+1),a=o.size,n=o.path.match(/(\.[^\.]*)$/),l=n?n[1]:".";t._uploadFile.fileInfo=o,t._uploadFile.backFileInfo=o,r.customSettings.isEditorFile=!0,r.customSettings.isInsertFromWangPan=s,r.customSettings.successCount=1,r.customSettings.currentFile={id:"SWFUpload_0_EDIT",name:i||"",size:a||0,type:l||"",filestatus:-4,index:1},r.progress=new FileProgress(r.customSettings.currentFile,r),r.progress.setStatus("setfilesuccess"),r.progress.setFileInfo(i,a)}else t._uploadFile.fileInfo=null,t._uploadFile.backFileInfo=null,r.customSettings.isEditorFile=!0,r.customSettings.successCount=0,r.customSettings.currentFile={id:"SWFUpload_0_NULL",name:"",size:0,type:"",filestatus:-4,index:1,creationdate:0,modificationdate:0},r.progress=new FileProgress(r.customSettings.currentFile,r),r.progress.setStatus("setfileerror",'<span style="padding-left:5px;">\u5f88\u62b1\u6b49\uff0c\u60a8\u4e0a\u4f20\u7684\u9644\u4ef6\u5df2\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u6216\u5220\u9664\u3002</span>'),r.progress.setFileInfo("",0)},window.editorSubmitUploadFile=function(e,s){var t=s._uploadFile.fileInfo,r=s._uploadFile.backFileInfo,o=s.swfupload,i=o.customSettings.swfUploadDir;switch(e){case"submit":r&&r["delete"]?r.path.substr(0,i.length)!=i||o.customSettings.isInsertFromWangPan||T.ajax({url:encodeURI("https://pcs.baidu.com/rest/2.0/pcs/file?method=delete&app_id=598913&response-status=200&op=permanent&fs_id="+r.fs_id),dataType:"jsonp",success:function(){}}):r&&r.rename&&r.path!=r.rename&&T.ajax({url:encodeURI("https://pcs.baidu.com/rest/2.0/pcs/file?method=move&app_id=598913&response-status=200&from="+r.path+"&to="+r.rename),dataType:"jsonp",success:function(){}});break;case"cancel":(t&&!r||t&&r&&t.fs_id!=r.fs_id)&&(t.path.substr(0,i.length)!=i||o.customSettings.isInsertFromWangPan||T.ajax({url:encodeURI("https://pcs.baidu.com/rest/2.0/pcs/file?method=delete&app_id=598913&response-status=200&op=permanent&fs_id="+t.fs_id),dataType:"jsonp",success:function(){}})),s._uploadFile.fileInfo=r}}});
;define("common:widget/js/logic/editor/lang/lang.js",function(e,o,t){var r={};r["zh-cn"]={insertorderedlist:{num:"1,2,3...",num1:"1),2),3)...",num2:"(1),(2),(3)...",cn:"\u4e00,\u4e8c,\u4e09....",cn1:"\u4e00),\u4e8c),\u4e09)....",cn2:"(\u4e00),(\u4e8c),(\u4e09)....",decimal:"1,2,3...","lower-alpha":"a,b,c...","lower-roman":"i,ii,iii...","upper-alpha":"A,B,C...","upper-roman":"I,II,III..."},insertunorderedlist:{circle:"\u25cb \u5927\u5706\u5708",disc:"\u25cf \u5c0f\u9ed1\u70b9",square:"\u25a0 \u5c0f\u65b9\u5757 ",dash:"\u2014 \u7834\u6298\u53f7",dot:" \u3002 \u5c0f\u5706\u5708"},wordCountTip:"",wordCountMsg:"",wordOverFlowMsg:'<span class="f-red">\u5b57\u6570\u8d85\u51fa\u6700\u5927\u5141\u8bb8\u503c\uff0c\u8bf7\u5220\u51cf\uff01</span>',ok:"\u786e\u8ba4",cancel:"\u53d6\u6d88",closeDialog:"\u5173\u95ed\u5bf9\u8bdd\u6846",tableDrag:"\u8868\u683c\u62d6\u52a8\u5fc5\u987b\u5f15\u5165uiUtils.js\u6587\u4ef6\uff01",autofloatMsg:"\u5de5\u5177\u680f\u6d6e\u52a8\u4f9d\u8d56\u7f16\u8f91\u5668UI\uff0c\u60a8\u9996\u5148\u9700\u8981\u5f15\u5165UI\u6587\u4ef6!",confirmClear:"\u786e\u5b9a\u6e05\u7a7a\u5f53\u524d\u6587\u6863\u4e48\uff1f",anthorMsg:"\u94fe\u63a5",clearColor:"\u6e05\u7a7a\u989c\u8272",standardColor:"\u6807\u51c6\u989c\u8272",themeColor:"\u4e3b\u9898\u989c\u8272",insertcodetitle:"\u4ee3\u7801\u8bed\u8a00",property:"\u5c5e\u6027","default":"\u9ed8\u8ba4",modify:"\u4fee\u6539",justifyleft:"\u5de6\u5bf9\u9f50",justifyright:"\u53f3\u5bf9\u9f50",justifycenter:"\u5c45\u4e2d",justify:"\u9ed8\u8ba4",clear:"\u6e05\u9664",anchorMsg:"\u951a\u70b9","delete":"\u5220\u9664",clickToUpload:"\u70b9\u51fb\u4e0a\u4f20",unset:"\u5c1a\u672a\u8bbe\u7f6e\u8bed\u8a00\u6587\u4ef6",t_row:"\u884c",t_col:"\u5217",more:"\u66f4\u591a",pasteOpt:"\u7c98\u8d34\u9009\u9879",pasteSourceFormat:"\u4fdd\u7559\u6e90\u683c\u5f0f",tagFormat:"\u53ea\u4fdd\u7559\u6807\u7b7e",pasteTextFormat:"\u53ea\u4fdd\u7559\u6587\u672c",autoTypeSet:{mergeLine:"\u5408\u5e76\u7a7a\u884c",delLine:"\u6e05\u9664\u7a7a\u884c",removeFormat:"\u6e05\u9664\u683c\u5f0f",indent:"\u9996\u884c\u7f29\u8fdb",alignment:"\u5bf9\u9f50\u65b9\u5f0f",imageFloat:"\u56fe\u7247\u6d6e\u52a8",removeFontsize:"\u6e05\u9664\u5b57\u53f7",removeFontFamily:"\u6e05\u9664\u5b57\u4f53",removeHtml:"\u6e05\u9664\u5197\u4f59HTML\u4ee3\u7801",pasteFilter:"\u7c98\u8d34\u8fc7\u6ee4",run:"\u6267\u884c"}},t.exports=r});
;define("common:widget/js/logic/editor/prototype/prototype.js",function(e,t,i){{var n=e("common:widget/js/util/tangram/tangram.js"),o=e("common:widget/js/ui/dialog/dialog.js"),r=e("common:widget/js/util/event/event.js");e("common:widget/js/util/log/log.js")}i.exports={pageUnload:function(e){{var t=this;this.instance}if(t.config.optionList.modify&&t.hasCon()){var i="\u8bf7\u6ce8\u610f\uff1a\u60a8\u7684\u7f16\u8f91\u5185\u5bb9\u8fd8\u6ca1\u6709\u8fdb\u884c\u4fdd\u5b58!";return e.returnValue=i,i}},filterTag:function(e,t){var i=t||"<p><br /></p>",n=e.toLocaleLowerCase().lastIndexOf(i);return n>0&&e.length==n+i.length?e.substring(0,n):e},hasCon:function(){var e=this.instance;return e.getContentTxt().length>0&&e.getContentTxt()!=e.options.initialContent?!0:/<(?:img|iframe)\s+(?:[^>]+\s+)*src\s*=\s*("|')+[^\1]+\1+\s*\/*>/i.test(e.getContent())},hasImg:function(){var e=this.instance;return/<img[^>]+src\s*=\s*['\"]([^'\"]+)['\"][^>]*>/i.test(e.getContent())},checkEditor:function(){var e=this,t=this.instance,i=this.hasCon(),o=!1;if("function"==n.type(t.getUploadFile)&&"ready"!=t.getUploadFile().status){var r=t.getUploadFile();if("complete"!=r.status||!r.fileInfo||!r.fileInfo.fs_id){var s;return s=/(complete|error)/.test(r.status)?1:0,setTimeout(function(){n(".edui-editor-wordcount",t.container).eq(0).html("<span class='f-red' style='direction: none'>"+e.config.fileErrorNum[s]+"</span> "),n(".edui-editor-bottomContainer",t.container).show()},100),!1}o=!0}return i||o?t.hasWordOverflow()?(setTimeout(function(){n(".edui-editor-bottomContainer",t.container).show()},100),!1):!0:(t.focus(),setTimeout(function(){n(".edui-editor-wordcount",t.container).eq(0).html("<span class='f-red' style='direction: none'>"+e.config.optionList.errorClew[0]+"</span> "),n(".edui-editor-bottomContainer",t.container).show()},100),!1)},uploadFile:function(e){var t=this,i=this.instance;if("function"==n.type(i.getUploadFile)){var o=i.getUploadFile();"function"==n.type(i.uploadAction)&&i.uploadAction("submit"),t.hasCon()||(e=""),"complete"==o.status&&(e+='<file fsid="'+o.fileInfo.fs_id+'" wealth="'+o.fileInfo.wealth+'" />')}return e},formatEnter:function(e){for(var t="",i=e.replace(/<br\s*\/*>/gi,"\n").replace(/ /g,"&nbsp;").replace(/\r\n/g,"\n").split("\n"),o=0;o<i.length;o++)t+=""!=n.string(i[o]).trim()?"<p>"+n.string(i[o]).trim()+"</p>":"<p><br /></p>";return t},formatMapContent:function(e){var t=this.unHtml(e).replace("\r\n","\n").split("\n");return"<p>"+t.join("</p><p>")+"</p>"},unHtml:function(e){return e?e.replace(/[&<\">]/g,function(e){return{"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"}[e]}):""},filterMapClew:function(e,t){if(!e)return"";e=e.replace(/<a[^>]*>([\S\s]*?)<\s*\/\s*a\s*>/gi,function(e,t){return/<img[^>]*>/i.test(t)?t:e});var i=new RegExp("<iframe.+?></iframe>","ig"),n=i.exec(e);if(!n)return e;var o=n[0];this.config.optionList.pic=!0;var r="",s="";(n=o.match(/src="(.+?)"/i))&&(r=n[1]),(n=o.match(/map="(.+?)"/i))&&(s=n[1]),r=r?r.replace(/^.+?html\/map/gi,"http://map.baidu.com/iknow"):"http://map.baidu.com/"+s,1==t&&(r=r.replace("http://map.baidu.com/iknow","http://zhidao.baidu.com/html/map")),r=r.replace(/^http:/,"");var a='<iframe data-type="map" map="'+r+'" frameborder="0" src="'+r+'" class="ikqb-mapshow"></iframe>',c=e.replace(i,a);return c=this.filterTag(c)},filterHighlight:function(e){if(!e)return"";var t=/<pre(.*?)>([\s\S]+?)<\/pre>/g,i=e.match(t);return i?e.replace(t,function(e,t,i){var n=t&&t.match(/class="brush:\s*(.+?);.*?"/);return n&&n[1]?'<pre t="code" l="'+n[1]+'">'+i+"</pre>":i}):e},formatCode:function(e){if(!e)return"";var t=/<pre(.*?)>([\s\S]+?)<\/pre>/g,i=e.match(t);return i?e.replace(t,function(e,t,i){var n=t&&t.match(/t="code" l="\s*(.+?)"/);return n&&n[1]?'<pre class="brush:'+n[1]+';toolbar:false">'+i+"</pre>":i}):e},collapseEditor:function(e){var t=this,i=n(t.container);if(t.config.optionList.modify=!1,n.browser.firefox)var o=t.instance.container,r=n(".addons",i.get(0)),s=n(".edui-editor-iframeholder",o),e=190,a=setInterval(function(){e-=20,s.css("height",e+"px"),20>e&&(clearInterval(a),n(o).css("height","0"),r.hide(),i.css({visibility:"hidden",height:"0"}),t.fire("oncollapse"))},20);else{n.browser.ie&&n.browser.ie<7&&setTimeout(function(){i.find("iframe").first().hide()},100),i.css({overflow:"hidden",visibility:"visible",height:"auto"});var a=setInterval(function(){e-=20,i.css("height",e+"px"),20>e&&(clearInterval(a),i.css({overflow:"hidden",visibility:"hidden",height:"0"}),t.fire("oncollapse"))},20)}},expandEditor:function(e){var t=this,i=n(this.container);if(n.browser.firefox){{var o=t.instance.container;n(".addons",i.get(0)).show()}n(o).css("height","");var e=190,r=0,s=n(".edui-editor-iframeholder",o),a=setInterval(function(){r+=20,s.css("height",r+"px"),r>e&&(clearInterval(a),s.css("height","190px"),t.fire("onexpand"))},20);n(i).css("height","").css("visibility","visible")}else{i.css("display","").css({overflow:"hidden",visibility:"visible",height:"0"});var r=0,a=setInterval(function(){r+=20,i.css("height",r+"px"),r>e&&(clearInterval(a),i.css("height","").css({overflow:"visible"}),n.browser.ie&&n.browser.ie<7&&i.find("iframe").first().show(),t.fire("onexpand"))},20)}},setContent:function(e,t){var i=this;setTimeout(function(){""!=e&&("0"==t&&(e=i.formatEnter(e)),e=i.formatCode(i.filterMapClew(e,!0)),i.instance.setContent(e,!1,!0)),i.instance.focus()},500)},afterInit:function(){function e(e,t){o.alert(t,{title:e,width:350,height:160,autoRender:!0})}try{var t=this,i=this.instance,s=!1;i.addListener("uploadSuccess",function(t,n){"0"!=n.errorNo?e("\u63d2\u5165\u56fe\u7247",UE.ui.Editor.config.imgErrorNum[n.errorNo]):i.focus()}),i.addListener("networkError",function(){e("\u63d2\u5165\u56fe\u7247","\u672a\u77e5\u9519\u8bef")}),i.addListener("imageSizeError",function(){e("\u63d2\u5165\u56fe\u7247",'<p>\u56fe\u7247\u6587\u4ef6\u8fc7\u5927\uff01</p><p class="f-red">\u6ce8\uff1a\u5927\u5c0f\u4e0d\u8d85\u8fc75M\uff0c\u652f\u6301JPG/PNG/BMP/GIF\u7b49\u683c\u5f0f</p>')}),i.addListener("showmap",function(){o.iframe({content:i.options.buttonConfig.insertmap.url+"?editor="+t.guid,title:"\u63d2\u5165\u5730\u56fe",width:710,height:480,autoDispose:!0})}),i.addListener("showhighlightcode",function(){if(i.options.isLogin)var e=o.iframe({content:t.config.buttonConfig.highlightcode.url+"?editor="+t.guid,title:"\u63d2\u5165\u4ee3\u7801",width:550,height:440,autoDispose:!0,type:"confirm",onaccept:function(){var t=n(e.getElement("content")).find("iframe")[0].contentWindow,o=t.document.getElementById("code").value,r=t.document.getElementById("language").value;i.execCommand("highlightcode",o,r),e.hide()}})}),r.on("editor-"+t.guid+".setmap",function(e,i){var o=t.instance;if(r.fire("dialog.close"),"object"==!n.type(i))return void(e.returnValue=!1);if(i.url){i.url=i.url.replace(/^http:/,"");var s='<p><iframe data-type="map" map="'+i.url+'" frameborder="0" src="'+i.url+'" class="ikqb-mapshow"></iframe></p>';o.execCommand("insertHTML",s)}""!=i.info&&(i.info="<p>"+t.formatMapContent(decodeURIComponent(i.info))+"</p>",o.execCommand("insertHTML",i.info)),o.focus()}),r.on("editor.default",function(){t.config.optionList.modify=!1,s=!0}),i.addListener("focus",function(){n(this.container).parent().addClass("editor-focus"),s||(t.config.optionList.modify=!0),r.fire("editor.focus",t)}),i.addListener("blur",function(){n(this.container).parent().removeClass("editor-focus")});var a=0;i.addListener("beforefullscreenchange",function(e,t){t?(n(this.container).addClass("iknow-editor-fullscreen"),n(this.container).parent().addClass("editor-status-fullscreen"),n(this.container).parent().find(".new-editor-deliver-btn").css({right:(n(document).width()-910)/2}),n(this.container).find(".edui-editor-new-tips").hide(),n(this.container).find(".insert-video-wp").css({left:(n(document).width()-910)/2}),a=1):(n(this.container).removeClass("iknow-editor-fullscreen"),n(this.container).parent().removeClass("editor-status-fullscreen"),n(this.container).parent().find(".new-editor-deliver-btn").css({right:"auto"}),n(this.container).find(".edui-editor-new-tips").show(),n(this.container).find(".insert-video-wp").css({left:16}),a=0)}),n(this.container).on("click",".edui-editor-new-tips-close",function(){try{n(this).parent().hide()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message,path:"common:widget/js/logic/editor/prototype/prototype.js",method:"",ln:531})}}),n(window).on("resize",function(){a&&n(".new-editor-deliver-btn").css({right:(n(document).width()-910)/2})}),n.browser.isWebkit?window.addEventListener("beforeunload",function(e){return t.pageUnload(e)}):window.onbeforeunload=function(e){e=e||window.event,t.pageUnload(e)}}catch(c){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:c.message,path:"common:widget/js/logic/editor/prototype/prototype.js",method:"",ln:554})}}}});